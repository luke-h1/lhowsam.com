"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2677],{73819:function(e,t,n){let i,r;n.r(t),n.d(t,{BackLink:function(){return eU},ChildLink:function(){return eB},ComponentBuilder:function(){return si},ComponentViewBuilder:function(){return sa},ConfirmDeleteDialogContainer:function(){return e1},DEFAULT_INTENT_HANDLER:function(){return sv},DocumentBuilder:function(){return sh},DocumentInspectorHeader:function(){return ne},DocumentListBuilder:function(){return sS},DocumentListItemBuilder:function(){return sO},DocumentPane:function(){return rt},DocumentPaneProvider:function(){return re},DocumentTypeListBuilder:function(){return sU},FormViewBuilder:function(){return sc},GenericListBuilder:function(){return sI},GenericViewBuilder:function(){return ss},HELP_URL:function(){return r1},InitialValueTemplateItemBuilder:function(){return sg},LOADING_PANE:function(){return tZ},ListBuilder:function(){return sL},ListItemBuilder:function(){return sP},LoadingPane:function(){return tF},MenuItemBuilder:function(){return r4},MenuItemGroupBuilder:function(){return r6},Pane:function(){return e5},PaneContainer:function(){return rJ},PaneContent:function(){return e6},PaneHeader:function(){return tg},PaneHeaderActions:function(){return tP},PaneItem:function(){return tN},PaneLayout:function(){return tk},ParameterizedLink:function(){return eV},ReferenceChildLink:function(){return eq},SerializeError:function(){return r0},StructureToolProvider:function(){return or},_DEBUG:function(){return tX},component:function(){return su},createStructureBuilder:function(){return sF},defaultInitialValueTemplateItems:function(){return sy},defaultIntentChecker:function(){return sw},documentFromEditor:function(){return sf},documentFromEditorWithInitialValue:function(){return sx},form:function(){return sd},getOrderingMenuItem:function(){return r5},getOrderingMenuItemsForSchemaType:function(){return r7},getTypeNamesFromFilter:function(){return sz},isDocumentListItem:function(){return sN},maybeSerializeInitialValueTemplateItem:function(){return sb},maybeSerializeMenuItem:function(){return r3},maybeSerializeMenuItemGroup:function(){return r9},maybeSerializeView:function(){return so},menuItemsFromInitialValueTemplateItems:function(){return sj},pane:function(){return os},pane$1:function(){return oo},setActivePanes:function(){return sK},shallowIntentChecker:function(){return sk},structureLocaleNamespace:function(){return ez},structureTool:function(){return oi},useDocumentPane:function(){return tG},useDocumentTitle:function(){return t4},usePane:function(){return e9},usePaneLayout:function(){return eH},usePaneRouter:function(){return eF},useStructureTool:function(){return tJ}});var s=n(36883),o=n(30719),l=n(10830),a=n(46227),c=n(52197),d=n(28066),u=n(15972),p=n(77051),m=n(34463),h=n(29317),f=n(38629),x=n(58252),g=n(97932),y=n(68009),b=n(7527),j=n(10138),v=n(84630),w=n(62409),C=n(21535),_=n(63408),k=n(95478),I=n(44770),E=n(99484),T=n(18937),S=n(8575),z=n(81625),$=n(59187),M=n(97198),D=n(90978),R=n(44349),L=n(62092),P=n(1748),A=n(3890),O=n(29876),N=n(58996),U=n(12907),H=n(656),B=n(55018),V=n(74393),q=n(19550),F=n(77411),G=n(42426),W=n(84605),K=n(55264),X=n(99639),Y=n(27651),Z=n(3252),Q=n(34021),J=n(82825),ee=n(72764),et=n(69613),en=n(99668),ei=n(38134),er=n(44820),es=n(90727),eo=n(45177),el=n(83175),ea=n(91847),ec=n(52832),ed=n(94637),eu=n(16097),ep=n(67284),em=n(14817),eh=n(53355),ef=n(87258),ex=n(9874),eg=n(45715),ey=n(51341),eb=n(78644),ej=n(16805),ev=n(49194),ew=n(21403),eC=n(39644),e_=n(26923),ek=n(69857),eI=n(81568),eE=n(4587),eT=n(35461),eS=n(24807);let ez="structure",e$=(0,f.CVH)({locale:"en-US",namespace:ez,resources:()=>n.e(4480).then(n.bind(n,34480))});function eM(e){let{document:t}=e,n=(0,f.I_y)().get(t._type),{t:i}=(0,f.$G7)(ez),{error:r,value:s}=(0,f._2T)({schemaType:n,value:t});return n?r?(0,o.jsx)(o.Fragment,{children:i("doc-title.error.text",{errorMessage:r.message})}):(0,o.jsx)(o.Fragment,{children:s?.title||(0,o.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:i("doc-title.fallback.text")})}):(0,o.jsx)("code",{children:i("doc-title.unknown-schema-type.text",{schemaType:t._type})})}let eD=(0,w.zo)(l.xu)`
  margin-left: auto;
`,eR=w.zo.details`
  flex: none;

  &[open] ${eD} {
    transform: rotate(180deg);
  }
`,eL=w.zo.summary`
  list-style: none;

  &::-webkit-details-marker {
    display: none;
  }
`,eP=w.zo.table`
  width: 100%;
  text-align: left;
  padding: 0 ${({theme:e})=>(0,l.hO)(e.sanity.space[2])};
  border-collapse: collapse;

  th {
    padding: ${({theme:e})=>(0,l.hO)(e.sanity.space[1])};
  }

  td {
    padding: 0 ${({theme:e})=>(0,l.hO)(e.sanity.space[1])};
  }

  tr > *:last-child {
    text-align: right;
  }
`,eA=(0,w.zo)(l.kC)`
  min-height: 33px;
`,eO=e=>{let{t}=(0,f.$G7)(ez),n=e.totalCount-e.references.length;return n?(0,o.jsx)(l.xu,{padding:2,children:(0,o.jsxs)(l.gF,{space:2,children:[(0,o.jsx)(l.xv,{size:1,muted:!0,children:t("confirm-delete-dialog.other-reference-count.title",{count:n})}),(0,o.jsx)(s.u,{portal:!0,placement:"top",content:t("confirm-delete-dialog.other-reference-count.tooltip"),children:(0,o.jsx)(l.xv,{size:1,muted:!0,children:(0,o.jsx)(d.hQ6,{})})})]})}):null};function eN(e){let{icon:t,layout:n,presence:i,schemaType:r,value:c}=e,d=(0,f.Uy$)(c.title)&&(0,a.isValidElement)(c.title)||ew(c.title)||ev(c.title)?c.title:null,u=(0,a.useMemo)(()=>(0,f.eLL)(e.documentPreviewStore,r,c._id,d),[e.documentPreviewStore,r,d,c._id]),{draft:p,published:m,isLoading:h}=(0,ec.m)(u,{draft:null,isLoading:!0,published:null}),x=h?null:(0,o.jsx)(s.uE,{children:(0,o.jsxs)(l.kC,{align:"center",gap:3,children:[i&&i.length>0&&(0,o.jsx)(f.mEJ,{presence:i}),(0,o.jsx)(f.aAo,{draft:p,published:m})]})}),g=(0,o.jsx)(f._mO,{draft:p,published:m});return(0,o.jsx)(f.ogX,{...(0,f.L_b)({value:c,draft:p,published:m}),isPlaceholder:h,icon:t,layout:n,status:x,tooltip:g})}let eU=(0,a.forwardRef)(function(e,t){let{routerPanesState:n,groupIndex:i}=(0,a.useContext)(c.ud),r=(0,a.useMemo)(()=>n.slice(0,i),[i,n]),s=(0,a.useMemo)(()=>({panes:r}),[r]);return(0,o.jsx)(_.Px,{...e,ref:t,state:s})});function eH(){let e=(0,a.useContext)(c.yq);if(!e)throw Error("PaneLayout: missing context value");return e}let eB=(0,a.forwardRef)(function(e,t){let{childId:n,childPayload:i,childParameters:r,...s}=e,{routerPanesState:l,groupIndex:d}=(0,a.useContext)(c.ud);return(0,o.jsx)(_.Px,{...s,ref:t,state:{panes:[...l.slice(0,d+1),[{id:n,params:r,payload:i}]]}})}),eV=(0,a.forwardRef)(function(e,t){let{routerPanesState:n,groupIndex:i,siblingIndex:r}=(0,a.useContext)(c.ud),{params:s,payload:l,...d}=e,u=(0,f.BoV)(s),p=(0,f.BoV)(l),m=(0,a.useMemo)(()=>{let e=n[i],t=e[r],s={...t,params:u??t.params,payload:p??t.payload},o=[...e.slice(0,r),s,...e.slice(r+1)];return{panes:[...n.slice(0,i),o,...n.slice(i+1)]}},[n,i,u,p,r]);return(0,o.jsx)(_.Px,{ref:t,...d,state:m})}),eq=(0,a.forwardRef)(function({documentId:e,documentType:t,parentRefPath:n,children:i,template:r,...s},l){return(0,o.jsx)(eB,{...s,ref:l,childId:e,childPayload:r?.params,childParameters:{type:t,parentRefPath:(0,k.BB)(n),...r&&{template:r?.id}},children:i})});function eF(){return(0,a.useContext)(c.ud)}let eG=[];function eW(e){let{onClick:t,type:n,value:i}=e,r=(0,f.vsM)(i?._id),s=(0,f.Dqo)(r),l=(0,f.rq_)(),{ReferenceChildLink:c}=eF(),d=(0,a.useCallback)(function(e){return(0,o.jsx)(c,{documentId:i?._id,documentType:n?.name,parentRefPath:eG,...e})},[c,n?.name,i?._id]);return(0,o.jsx)(f.oUE,{__unstable_focusRing:!0,as:d,"data-as":"a",onClick:t,radius:2,children:(0,o.jsx)(eN,{documentPreviewStore:l,icon:n?.icon,layout:"compact",presence:s?.length>0?s:eG,schemaType:n,value:i})})}function eK({crossDatasetReferences:e,internalReferences:t,documentTitle:n,totalCount:i,action:r,datasetNames:c,hasUnknownDatasetNames:u,onReferenceLinkClick:p}){let m=(0,f.I_y)(),h=(0,l.pm)(),{t:x}=(0,f.$G7)(ez),g=(0,a.useCallback)(e=>{let t=m.get(e._type);return t?(0,o.jsx)(eW,{type:t,value:e,onClick:p}):(0,o.jsx)(l.xu,{padding:2,children:(0,o.jsx)(f.ogX,{icon:d.Tzq,title:x("confirm-delete-dialog.preview-item.preview-unavailable.title"),subtitle:x("confirm-delete-dialog.preview-item.preview-unavailable.subtitle",{documentId:e._id}),layout:"default"})})},[m,x,p]);if(t?.totalCount===0&&e?.totalCount===0)return(0,o.jsx)(l.xv,{as:"p",size:1,children:(0,o.jsx)(f.vNl,{t:x,i18nKey:"confirm-delete-dialog.confirmation.text",context:r,components:{DocumentTitle:()=>(0,o.jsx)("strong",{children:n})}})});let y=[...c,...u?["unavailable"]:[]],b=x("confirm-delete-dialog.cdr-summary.subtitle",{count:y.length,datasets:y.join(", "),context:u&&y.length?"unavailable":""});return(0,o.jsxs)(l.kC,{direction:"column",gap:4,children:[(0,o.jsx)(l.Zb,{padding:3,radius:2,tone:"caution",flex:"none",children:(0,o.jsxs)(l.kC,{children:[(0,o.jsx)(l.xv,{"aria-hidden":"true",size:1,children:(0,o.jsx)(d.foC,{})}),(0,o.jsx)(l.xu,{flex:1,marginLeft:3,children:(0,o.jsx)(l.xv,{size:1,children:(0,o.jsx)(f.vNl,{i18nKey:"confirm-delete-dialog.referring-document-count.text",components:{DocumentTitle:()=>n},t:x,values:{count:i}})})})]})}),(0,o.jsx)(l.xu,{flex:"none",children:(0,o.jsx)(l.xv,{size:1,children:(0,o.jsx)(f.vNl,{i18nKey:"confirm-delete-dialog.referring-documents-descriptor.text",t:x,context:r,components:{DocumentTitle:()=>n}})})}),(0,o.jsx)(l.Zb,{radius:2,shadow:1,flex:"auto",padding:2,children:(0,o.jsxs)(l.kC,{direction:"column",children:[t.totalCount>0&&(0,o.jsxs)(l.Kq,{as:"ul",marginBottom:2,space:2,"data-testid":"internal-references",children:[t?.references.map(e=>o.jsx(l.xu,{as:"li",children:g(e)},e._id)),t.totalCount>t.references.length&&(0,o.jsx)(l.xu,{as:"li",padding:3,children:(0,o.jsx)(eO,{...t})})]}),e.totalCount>0&&(0,o.jsxs)(eR,{"data-testid":"cross-dataset-references",style:{borderTop:t.totalCount>0?"1px solid var(--card-shadow-outline-color)":void 0},children:[(0,o.jsx)(eL,{children:(0,o.jsx)(l.Zb,{as:"a",marginTop:t.totalCount>0?2:0,radius:2,shadow:1,paddingY:1,children:(0,o.jsxs)(l.kC,{align:"center",gap:3,paddingX:3,paddingY:1,children:[(0,o.jsx)(l.xv,{size:1,children:(0,o.jsx)(d.TAM,{})}),(0,o.jsxs)(l.Kq,{space:2,children:[(0,o.jsx)(l.xv,{textOverflow:"ellipsis",size:1,children:x("confirm-delete-dialog.cdr-summary.title",{count:y.length,documentCount:x("confirm-delete-dialog.cdr-summary.document-count",{count:e.totalCount})})}),(0,o.jsx)(l.xv,{title:b,textOverflow:"ellipsis",size:1,muted:!0,children:b})]}),(0,o.jsx)(eD,{children:(0,o.jsx)(l.xv,{muted:!0,size:1,children:(0,o.jsx)(d.v4q,{})})})]})})}),(0,o.jsxs)(l.xu,{overflow:"auto",paddingTop:2,children:[(0,o.jsxs)(eP,{children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:(0,o.jsx)(l.xv,{muted:!0,size:1,style:{minWidth:"5rem"},weight:"medium",children:x("confirm-delete-dialog.cdr-table.project-id.label")})}),(0,o.jsx)("th",{children:(0,o.jsx)(l.xv,{muted:!0,size:1,weight:"medium",children:x("confirm-delete-dialog.cdr-table.dataset.label")})}),(0,o.jsx)("th",{children:(0,o.jsx)(l.xv,{muted:!0,size:1,weight:"medium",children:x("confirm-delete-dialog.cdr-table.document-id.label")})})]})}),(0,o.jsx)("tbody",{children:e.references.filter(e=>"projectId"in e).map(({projectId:e,datasetName:t,documentId:n},i)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:(0,o.jsx)(l.xv,{size:1,children:e})}),(0,o.jsx)("td",{children:(0,o.jsx)(l.xv,{size:1,children:t||"unavailable"})}),(0,o.jsx)("td",{children:(0,o.jsxs)(eA,{align:"center",gap:2,justify:"flex-end",children:[(0,o.jsx)(l.xv,{textOverflow:"ellipsis",size:1,children:n||"unavailable"}),n&&(0,o.jsx)(ej,{text:n,onCopy:()=>{h.push({title:x("confirm-delete-dialog.cdr-table.id-copied-toast.title"),status:"success"})},children:(0,o.jsx)(s.zx,{mode:"bleed",icon:d.TIy,tooltipProps:{content:x("confirm-delete-dialog.cdr-table.copy-id-button.tooltip")}})})]})})]},`${n}-${i}`))})]}),(0,o.jsx)(eO,{...e})]})]})]})}),(0,o.jsx)(l.xu,{flex:"none",children:(0,o.jsx)(l.xv,{size:1,children:(0,o.jsx)(f.vNl,{i18nKey:"confirm-delete-dialog.referential-integrity-disclaimer.text",t:x,context:r,components:{DocumentTitle:()=>n}})})})]})}let eX=()=>(i||(i=(0,I.R)(document,"visibilitychange").pipe((0,M.O)(null),(0,$.U)(()=>"visible"===document.visibilityState),(0,X.x)(),(0,Y.w)(e=>e?(0,E.H)(0,5e3):T.E),(0,Z.d)({refCount:!0,bufferSize:1}))),i),eY=(0,f.ek8)(([e,t])=>t.listenQuery({fetch:'{"references":*[references($documentId)][0...100]{_id,_type},"totalCount":count(*[references($documentId)])}',listen:"*[references($documentId)]"},{documentId:e},{tag:"use-referring-documents",transitions:["appear","disappear"],throttleTime:5e3})),eZ=(0,f.ek8)(([e,t])=>eX().pipe((0,Y.w)(()=>(function(e,t){let{versionedClient:n}=t;return eX().pipe((0,Y.w)(()=>(function(e,{versionedClient:t}){let n=(0,f.qyu)(e),i=(0,f.vsM)(e),r={uri:t.getDataUrl("doc",`${n},${i}`),json:!0,query:{excludeContent:"true"},tag:"use-referring-documents.document-existence"};return t.observable.request(r).pipe((0,$.U)(({omitted:e})=>{let t=e.filter(e=>"existence"===e.reason);if(2!==t.length)return 0===t.length||t.some(e=>e.id===n)?i:n}))})(e,t)),(0,Y.w)(e=>{if(!e)return(0,S.of)({totalCount:0,references:[]});let t=n.config().dataset;return n.observable.request({url:`/data/references/${t}/documents/${e}/to?excludeInternalReferences=true&excludePaths=true`,tag:"use-referring-documents.external"}).pipe((0,D.K)(e=>{if("object"==typeof e&&e&&"statusCode"in e&&"response"in e&&404===e.statusCode)return(0,S.of)({totalCount:0,references:[]});throw e}))}))})(e,{versionedClient:t})))),eQ=(0,w.zo)(l.xu)`
  box-sizing: border-box;
`,eJ=(0,w.zo)(l.kC).attrs({align:"center",direction:"column",justify:"center"})`
  height: 110px;
`;function e0({id:e,type:t,action:n="delete",onCancel:i,onConfirm:r}){let{t:l}=(0,f.$G7)(ez),c=`deletion-confirmation-${(0,a.useId)()}`,{internalReferences:d,crossDatasetReferences:u,isLoading:p,totalCount:m,projectIds:h,datasetNames:x,hasUnknownDatasetNames:g}=function(e){let t=(0,f.m85)(f.Dr7),n=(0,f.H__)(),i=(0,f.vsM)(e),[r,s]=eY((0,a.useMemo)(()=>[i,n],[n,i])),[o,l]=eZ((0,a.useMemo)(()=>[i,t],[i,t])),c=(0,a.useMemo)(()=>Array.from(new Set(o?.references.map(e=>e.projectId).filter(Boolean))).sort(),[o?.references]),d=(0,a.useMemo)(()=>Array.from(new Set(o?.references.map(e=>e?.datasetName||"").filter(e=>!!e&&""!==e))).sort(),[o?.references]),u=(0,a.useMemo)(()=>!!o?.references.some(e=>"string"!=typeof e.datasetName),[o?.references]);return{totalCount:(r?.totalCount||0)+(o?.totalCount||0),projectIds:c,datasetNames:d,hasUnknownDatasetNames:u,internalReferences:r,crossDatasetReferences:o,isLoading:s||l}}(e),y=(0,o.jsx)(eM,{document:(0,a.useMemo)(()=>({_id:e,_type:t}),[e,t])}),b=!p;return(0,o.jsx)(s.Vq,{width:1,id:c,header:l("confirm-delete-dialog.header.text",{context:n}),footer:{cancelButton:{onClick:i,text:l("confirm-delete-dialog.cancel-button.text")},confirmButton:b?{text:l(m>0?"confirm-delete-dialog.confirm-anyway-button.text":"confirm-delete-dialog.confirm-button.text",{context:n}),onClick:r}:void 0},onClose:i,onClickOutside:i,children:(0,o.jsx)(eQ,{children:u&&d&&!p?(0,o.jsx)(eK,{crossDatasetReferences:u,internalReferences:d,documentTitle:y,isLoading:p,totalCount:m,action:n,projectIds:h,datasetNames:x,hasUnknownDatasetNames:g,onReferenceLinkClick:i}):(0,o.jsx)(eJ,{"data-testid":"loading-container",children:(0,o.jsx)(f.Bwn,{showText:!0,title:l("confirm-delete-dialog.loading.text")})})})})}function e1(e){let{t}=(0,f.$G7)(ez),n=(0,a.useId)(),[i,r]=(0,a.useState)(null),c=(0,a.useCallback)(()=>r(null),[]);return i?(0,o.jsx)(s.Vq,{id:`dialog-error-${n}`,"data-testid":"confirm-delete-error-dialog",header:t("confirm-delete-dialog.error.title.text"),footer:{confirmButton:{text:t("confirm-delete-dialog.error.retry-button.text"),onClick:c,tone:"default"}},onClose:e.onCancel,children:(0,o.jsx)(l.xu,{padding:4,children:(0,o.jsx)(l.xv,{size:1,children:t("confirm-delete-dialog.error.message.text")})})}):(0,o.jsx)(s.SV,{onCatch:r,children:(0,o.jsx)(e0,{...e})})}function e2({children:e,ms:t=0}){let[n,i]=(0,a.useState)(t<=0);return(0,a.useEffect)(()=>{if(t<=0)return;let e=setTimeout(()=>i(!0),t);return()=>{clearTimeout(e)}},[t]),n&&e?"function"==typeof e?e():e:(0,o.jsx)(o.Fragment,{})}let e8=(0,w.zo)(l.mh)`
  position: relative;
  width: 1px;
  min-width: 1px;

  &:before {
    content: '';
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    width: 1px;
    background-color: var(--card-border-color);
  }

  &:not([data-disabled]) {
    cursor: ew-resize;
    width: 9px;
    min-width: 9px;
    margin: 0 -4px;

    &:before {
      left: 4px;
    }

    &:after {
      content: '';
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    &[data-dragging]:after,
    &:hover:after {
      opacity: 0.2;
    }
  }
`;function e3({disabled:e,element:t}){let{resize:n}=eH(),[i,r]=(0,a.useState)(!1),s=(0,a.useCallback)(e=>{if(!t)return;r(!0),e.preventDefault();let i=e.pageX;n("start",t,0);let s=e=>{e.preventDefault(),n("move",t,e.pageX-i)},o=e=>{e.preventDefault(),r(!1),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",o),n("end",t,0)};window.addEventListener("mousemove",s),window.addEventListener("mouseup",o)},[t,n]);return(0,o.jsx)(e8,{"data-disabled":e?"":void 0,"data-dragging":i?"":void 0,onMouseDown:s})}let e4=(0,w.zo)(l.Zb)`
  outline: none;

  // NOTE: This will render a border to the right side of each pane
  // without taking up physical space.
  box-shadow: 1px 0 0 var(--card-border-color);
`,e5=(0,a.forwardRef)(function(e,t){let{children:n,currentMinWidth:i,currentMaxWidth:r,flex:s=1,id:d,minWidth:u,maxWidth:p,selected:m=!1,...h}=e,[x,g]=(0,a.useState)(null),{collapse:y,collapsed:b,expand:j,expandedElement:v,mount:w,panes:C}=eH(),_=C.find(e=>e.element===x),k=_&&C.indexOf(_),I="number"==typeof k?C[k+1]:void 0,E=k===C.length-1,T=!b&&(_?.collapsed||!1),S=I?.collapsed||!1,z=(0,a.useRef)(null),$=_?.flex??s,M=_?.currentMinWidth??i,D=_?.currentMaxWidth??r;(0,a.useImperativeHandle)(t,()=>z.current);let R=(0,a.useCallback)(e=>{g(e),z.current=e},[]);(0,a.useEffect)(()=>{if(x)return w(x,{currentMinWidth:i,currentMaxWidth:r,flex:s,id:d,minWidth:u,maxWidth:p})},[i,r,s,d,u,p,w,x]);let L=(0,a.useCallback)(()=>{x&&y(x)},[y,x]),P=(0,a.useCallback)(()=>{x&&j(x)},[j,x]),A=(0,a.useMemo)(()=>({collapse:L,collapsed:!b&&T,expand:P,index:k,isLast:E,rootElement:x}),[T,L,P,E,b,k,x]),O=(0,a.useMemo)(()=>{if(!b)return T?51:0===M||E?u||204:M||u||204},[T,M,E,b,u]),N=(0,a.useMemo)(()=>T?51:b&&E?void 0:E?p?D??p:void 0:D??p,[T,D,E,b,p]),U=b&&!E,H=(0,a.useMemo)(()=>!E&&!b&&(0,o.jsx)(f.jr5,{zOffset:"paneResizer",children:(0,o.jsx)(e3,{disabled:T||S,element:x})}),[T,E,b,S,x]),B=(0,a.useMemo)(()=>({flex:$,minWidth:O,maxWidth:N===1/0?void 0:N}),[$,O,N]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f.jr5,{zOffset:"pane",children:(0,o.jsx)(c.tc.Provider,{value:A,children:(0,o.jsx)(f.K4Y,{isLastPane:E,children:(0,o.jsxs)(e4,{"data-testid":"pane","data-ui":"Pane",tone:"inherit",hidden:U,id:d,overflow:b?void 0:"hidden",...h,"data-pane-collapsed":T?"":void 0,"data-pane-index":k,"data-pane-selected":m?"":void 0,ref:R,style:B,children:[!1,(0,o.jsx)(l.NM,{element:x,children:!U&&(0,o.jsx)(l.kC,{direction:"column",height:"fill",children:n})})]})})})}),H]})}),e7=(0,w.zo)(l.Zb)`
  position: relative;
  outline: none;
`;function e9(){let e=(0,a.useContext)(c.tc);if(!e)throw Error("Pane: missing context value");return e}e7.displayName="PaneContent__root";let e6=(0,a.forwardRef)(function(e,t){let{as:n,children:i,overflow:r,padding:s,...l}=e,{collapsed:a}=e9(),{collapsed:c}=eH();return(0,o.jsx)(e7,{"data-testid":"pane-content",forwardedAs:n,...l,flex:1,hidden:a,overflow:c?void 0:r,padding:s,ref:t,tone:"inherit",children:i})}),te={constrainSize:!0,placement:"left-start",portal:!0};function tt(e){let{disabled:t,isAfterGroup:n,node:i}=e,r=(0,f.sr_)("i18n"in i?i:void 0);if("divider"===i.type)return(0,o.jsx)(l.R,{});let{title:a}=r(i);return"group"===i.type?0===i.children.length?null:i.expanded?(0,o.jsxs)(o.Fragment,{children:[n&&(0,o.jsx)(l.R,{}),i.children.map((e,n)=>(0,o.jsx)(tt,{disabled:t||!!i.disabled,isAfterGroup:i.children[n-1]?.type==="group",node:e},e.key))]}):(0,o.jsxs)(o.Fragment,{children:[n&&(0,o.jsx)(l.R,{}),(0,o.jsx)(s.kS,{disabled:t,icon:i.icon,popover:te,text:a,children:i.children.map((e,n)=>(0,o.jsx)(tt,{disabled:t||!!i.disabled,isAfterGroup:i.children[n-1]?.type==="group",node:e},e.key))})]}):(0,o.jsxs)(o.Fragment,{children:[n&&(0,o.jsx)(l.R,{}),(0,o.jsx)(tn,{disabled:t,node:i})]})}function tn(e){let{node:t}=e;return t.intent?(0,o.jsx)(tr,{...e,intent:t.intent}):(0,o.jsx)(ti,{...e})}function ti(e){let{disabled:t,node:n}=e,i="object"==typeof n.disabled&&(0,o.jsx)(l.xv,{size:1,children:n.disabled.reason}),{title:r}=(0,f.v0Z)(n);return(0,o.jsx)(f.xMr,{content:i,placement:"left",children:(0,o.jsx)(s.sN,{disabled:t||!!n.disabled,hotkeys:n.hotkey?.split("+"),icon:n.icon,iconRight:n.iconRight||n.selected&&d.KML,onClick:n.onAction,pressed:n.selected,text:r,tone:n.tone})})}function tr(e){let{disabled:t,intent:n,node:i}=e,r="object"==typeof i.disabled&&(0,o.jsx)(l.xv,{size:1,children:i.disabled.reason}),c=(0,_.PM)({intent:n.type,params:n.params}),u=(0,a.useCallback)(e=>{c.onClick(e),i.onAction()},[c,i]),{title:p}=(0,f.v0Z)(i);return(0,o.jsx)(f.xMr,{content:r,placement:"left",children:(0,o.jsx)(s.sN,{as:"a",disabled:t||!!i.disabled,hotkeys:i.hotkey?.split("+"),href:c.href,icon:i.icon,iconRight:i.selected?d.KML:void 0,onClick:u,pressed:i.selected,text:p,tone:i.tone})})}let ts={constrainSize:!0,placement:"bottom",portal:!0};function to(e,t){return e.some(e=>"item"===e.type&&e.tone===t||"group"===e.type&&to(e.children,t))}function tl(e){let{nodes:t,actionsNodes:n}=e,i=(0,a.useId)(),r=to(t,"critical"),c=to(t,"caution");return(0,o.jsx)(s.j2,{button:(0,o.jsx)(f.lXN,{tone:r?"critical":c?"caution":void 0,"data-testid":"pane-context-menu-button"}),id:i,menu:(0,o.jsxs)(l.v2,{children:[n&&(0,o.jsxs)(o.Fragment,{children:[n,(0,o.jsx)(l.R,{})]}),t.map((e,n)=>{let i=t[n-1]?.type==="group";return(0,o.jsx)(tt,{isAfterGroup:i,node:e},e.key)})]}),popover:ts})}let ta=(0,w.zo)(l.mh)`
  position: sticky;
  bottom: 0;

  &:before {
    content: '';
    display: block;
    position: absolute;
    left: 0;
    right: 0;
    top: -1px;
    border-bottom: 1px solid var(--card-border-color);
  }
`,tc=(0,w.zo)(l.Zb)`
  padding-bottom: env(safe-area-inset-bottom);
`,td=(0,a.forwardRef)(function(e,t){let{children:n,padding:i}=e,{collapsed:r}=e9();return(0,o.jsx)(f.jr5,{zOffset:"paneFooter",children:(0,o.jsx)(ta,{"data-testid":"pane-footer",hidden:r,ref:t,children:(0,o.jsx)(tc,{tone:"inherit",children:(0,o.jsx)(l.xu,{padding:i,children:n})})})})}),tu=(0,w.zo)(l.mh)(({$border:e})=>(0,w.iv)`
    line-height: 0;
    position: sticky;
    top: 0;

    &:not([data-collapsed]):after {
      content: '';
      display: block;
      position: absolute;
      left: 0;
      right: 0;
      bottom: -1px;
      border-bottom: 1px solid ${e?"var(--card-border-color)":"transparent"};
      opacity: 1;
    }
  `),tp=(0,w.zo)(l.kC)`
  transform-origin: calc(51px / 2);

  [data-collapsed] > div > & {
    transform: rotate(90deg);
  }
`,tm=(0,w.zo)(l.Zb)(({theme:e})=>{let{fg:t,bg:n}=e.sanity.color.card.enabled;return(0,w.iv)`
    background-color: ${n};

    [data-ui='Text'] {
      color: ${t};
    }
  `}),th=(0,w.zo)(l.Qr)`
  width: 66%;
  max-width: 175px;
`,tf=(0,w.zo)(l.xv)`
  cursor: default;
  outline: none;
`,tx=(0,w.zo)(l.xu)(({theme:e})=>{let{color:t,space:n}=e.sanity;return(0,w.iv)`
    overflow: hidden;
    overflow: clip;
    position: relative;

    & > div {
      white-space: nowrap;
      overflow: auto;
      /* Hide scrollbars */
      scrollbar-width: none;
      &::-webkit-scrollbar {
        width: 0;
        height: 0;
      }
    }

    /* right padding */
    & > div:after {
      content: '';
      display: inline-block;
      top: 0;
      right: 0;
      bottom: 0;
      width: ${n[3]}px;
      height: 1px;
    }

    /* Gradient that makes it look like tabs disappear into nothing (looks nicer) */
    &:after {
      content: '';
      display: block;
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(to right, ${(0,l.m4)(t.base.bg,0)}, var(--card-bg-color));
      width: ${n[3]}px;
      pointer-events: none;
    }
  `}),tg=(0,a.forwardRef)(function(e,t){let{actions:n,backButton:i,border:r,contentAfter:s,loading:c,subActions:d,tabs:u,tabIndex:p,title:m}=e,{collapse:h,collapsed:x,expand:g,rootElement:y}=e9(),b=(0,l.XL)(y||null),j=(0,a.useMemo)(()=>({width:x?b?.height||window.innerHeight:void 0}),[x,b]),v=(0,a.useCallback)(()=>{x||h()},[h,x]),w=(0,a.useCallback)(()=>{x&&g()},[x,g]);return(0,o.jsx)(l.li,{zOffset:100,children:(0,o.jsx)(tu,{$border:r,"data-collapsed":x?"":void 0,"data-testid":"pane-header",ref:t,children:(0,o.jsx)(f.jr5,{zOffset:"paneHeader",children:(0,o.jsxs)(l.Zb,{"data-collapsed":x?"":void 0,tone:"inherit",children:[(0,o.jsxs)(tp,{gap:1,onClick:w,padding:3,paddingBottom:x?3:2,sizing:"border",style:j,children:[i&&(0,o.jsx)(l.xu,{flex:"none",children:i}),(0,o.jsxs)(tm,{__unstable_focusRing:!0,flex:1,forwardedAs:"button",onClick:v,paddingLeft:i?1:2,padding:2,tabIndex:p,children:[c&&(0,o.jsx)(th,{animated:!0,radius:1,size:1}),!c&&(0,o.jsx)(tf,{size:1,textOverflow:"ellipsis",weight:"semibold",children:m})]}),n&&(0,o.jsx)(l.kC,{align:"center",hidden:x,children:(0,o.jsx)(f.jr5,{zOffset:"paneHeader",children:n})})]}),!!(!x&&(u||d))&&(0,o.jsxs)(l.kC,{align:"center",hidden:x,overflow:"auto",paddingBottom:3,paddingX:3,children:[(0,o.jsx)(tx,{flex:1,marginRight:d?3:0,children:u}),d&&d]}),!x&&s&&s]})})})})});function ty(e){return e.disabled?{disabledReason:"object"==typeof e.disabled?e.disabled.reason:void 0,ariaLabel:"object"==typeof e.disabled&&"string"==typeof e.disabled?.reason?e.disabled.reason:"This is disabled",isDisabled:!!e.disabled}:{disabledReason:void 0,ariaLabel:void 0,isDisabled:!1}}function tb(e){let{node:t}=e;return"item"===t.type?(0,o.jsx)(tj,{node:t}):"group"===t.type?(0,o.jsx)(tw,{node:t}):(console.warn('unknown menu node (expected `type: "item" | "group"`):',t),null)}function tj(e){let{node:t}=e,{title:n}=(0,f.v0Z)(t),{t:i}=(0,f.$G7)();if(t.intent)return(0,o.jsx)(tv,{...e,intent:t.intent});let{disabledReason:r,ariaLabel:s,isDisabled:l}=ty(t);return(0,o.jsx)(f.YG6,{disabled:l,icon:t.icon,onClick:t.onAction,selected:t.selected,tone:t.tone,"aria-label":s||n||i("status-button.aria-label"),tooltipProps:{hotkeys:!l&&t.hotkey?t.hotkey.split("+"):void 0,content:l?r:n}})}function tv(e){let{intent:t,node:n}=e,i=(0,_.PM)({intent:t.type,params:t.params}),{t:r}=(0,f.$G7)(),s=(0,a.useCallback)(e=>{i.onClick(e),n.onAction()},[i,n]),{disabledReason:l,ariaLabel:c,isDisabled:d}=ty(n);return(0,o.jsx)(f.YG6,{forwardedAs:"a",disabled:d,href:i.href,icon:n.icon,onClick:s,selected:n.selected,tone:n.tone,"aria-label":c||n.title||r("status-button.aria-label"),tooltipProps:{hotkeys:!d&&n.hotkey?n.hotkey.split("+"):void 0,content:d?l:n.title,placement:"bottom",portal:!0}})}function tw(e){let{node:t}=e,{title:n}=(0,f.v0Z)(t);return(0,o.jsx)(s.j2,{button:(0,o.jsx)(s.zx,{disabled:!!t.disabled,icon:t.icon??d.Tzq,label:n,mode:"bleed",tooltipProps:{content:t.title,portal:!0}}),id:(0,a.useId)(),menu:(0,o.jsx)(l.v2,{children:t.children.map((e,n)=>(0,o.jsx)(tt,{disabled:!!t.disabled,isAfterGroup:t.children[n-1]?.type==="group",node:e},e.key))})})}let tC=(0,w.zo)(l.Zb)`
  transition: opacity 200ms;
  position: relative;
  z-index: 1;
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
  opacity: 0;

  &:not([hidden]) {
    display: flex;
  }

  &:not([data-collapsed]) {
    overflow: auto;
  }

  &[data-mounted] {
    opacity: 1;
  }

  &[data-resizing] {
    pointer-events: none;
  }
`,t_=[];function tk(e){let{children:t,minWidth:n,onCollapse:i,onExpand:r,...s}=e,d=(0,a.useMemo)(()=>(function(){let e=[],t=[],n=new WeakMap,i=new Set,r={},s=null,o=0,l=null,a=new Map,c=!1;function d(e){i.delete(e),l=e,u()}return{collapse:function(e){i.add(e),l===e&&(l=null),u()},expand:d,mount:function(e,i){return n.set(e,{...i,original:i}),t.push(e),s&&function(e,t){let n=new WeakMap;for(let i of t)n.set(i,function(e,t){let n=[],i=t;for(;i!==e;){let t=i.parentElement;if(!t)break;let r=Array.from(t.childNodes).indexOf(i);if(n.unshift(r),t===e)break;i=t}return n}(e,i));t.sort((e,t)=>{let i=n.get(e)||t_,r=n.get(t)||t_,s=Math.max(i.length,r.length);for(let e=0;e<s;e+=1){let t=i[e]||-1,n=r[e]||-1;if(t!==n)return t-n}return 0})}(s,t),d(e),()=>{let i=t.indexOf(e);i>-1&&t.splice(i,1),n.delete(e),u()}},resize:function(e,i,s){let o=t.indexOf(i),l=n.get(i);if(!l)return;let d=t[o+1],p=n.get(d);if(p){if("start"===e&&(c=!0,r.left={element:i,flex:l.flex||1,width:i.offsetWidth},r.right={element:d,flex:p.flex||1,width:d.offsetWidth},u()),"move"===e&&r.left&&r.right){a=new Map;let{leftW:e,rightW:t,leftFlex:n,rightFlex:o}=function(e,t,n,i){let r={flex:e.left.flex+e.right.flex,width:e.left.width+e.right.width},s=t.minWidth??204,o=n.minWidth??204,l=Math.min(t.maxWidth||1/0,r.width-o),a=Math.min(n.maxWidth||1/0,r.width-s),c=s-e.left.width,d=e.right.width-a;c<d&&(c=d);let u=e.right.width-o,p=l-e.left.width;u>p&&(u=p);let m=Math.min(Math.max(i,c),u),h=e.left.width+m,f=e.right.width-m;return{leftFlex:h/r.width*r.flex,leftW:h,rightFlex:f/r.width*r.flex,rightW:f}}(r,l,p,s);a.set(i,{flex:n,width:e}),a.set(d,{flex:o,width:t}),u()}if("end"===e){c=!1;let e=a.get(i),t=a.get(d);n.set(i,{...l,currentMinWidth:0,currentMaxWidth:l.maxWidth??1/0,flex:e?.flex??l.flex}),n.set(d,{...p,currentMinWidth:0,currentMaxWidth:l.maxWidth??1/0,flex:t?.flex??p.flex}),a=new Map,delete r.left,delete r.right,u()}}},setRootElement:function(e){s=e},setRootWidth:function(e){o=e,u()},subscribe:function(t){return e.push(t),()=>{let n=e.push(t);n>-1&&e.splice(n,1)}}};function u(){if(!o)return;let r=[];for(let e of t)e!==l&&r.unshift(e);l&&r.unshift(l);let s=new WeakMap,d=r.length,u=r[0],p=o-(d-1)*51;for(let e of r){let t=n.get(e);if(!t)continue;let r=t.currentMinWidth||t.minWidth||204,o=e===u,l=i.has(e),c=r>p,d=!o&&(l||c),m=a.get(e);s.set(e,{element:e,collapsed:d,currentMinWidth:m?.width??t.currentMinWidth,currentMaxWidth:m?.width??t.currentMaxWidth,flex:m?.flex??t.flex??1}),d?p-=51:p-=r-51}let m=[];for(let e of t){let t=s.get(e);t&&m.push(t)}for(let n of e)n({expandedElement:l||t[t.length-1]||null,panes:m,resizing:c})}})(),[]),[u,p]=(0,a.useState)(null),m=l.XL(u)?.width||0,h=void 0!==m&&n?m<n:void 0,[f,x]=(0,a.useState)({expandedElement:null,panes:[],resizing:!1});(0,a.useEffect)(()=>d.setRootElement(u),[d,u]),(0,a.useEffect)(()=>d.setRootWidth(m),[d,m]),(0,a.useEffect)(()=>d.subscribe(x),[d]),(0,a.useEffect)(()=>{void 0!==h&&(h&&i&&i(),!h&&r&&r())},[h,i,r]);let g=(0,a.useMemo)(()=>({collapse:d.collapse,collapsed:h,expand:d.expand,expandedElement:f.expandedElement,mount:d.mount,panes:f.panes,resize:d.resize,resizing:f.resizing}),[h,d,f.expandedElement,f.panes,f.resizing]);return(0,o.jsx)(c.yq.Provider,{value:g,children:(0,o.jsx)(tC,{"data-ui":"PaneLayout",...s,"data-collapsed":h?"":void 0,"data-resizing":f.resizing?"":void 0,"data-mounted":m?"":void 0,ref:p,children:t})})}function tI(e){return("item"===e.type||"group"===e.type)&&e.renderAsButton}let tE=e_(tI);function tT(e){let{fieldActions:t=[],menuItems:n,menuItemGroups:i}=e,r=[],s=0;for(let e=0;e<t.length;e+=1){let n=t[e];r.push(function e(t,n){return"divider"===t.type?{type:"divider",key:n}:"group"===t.type?{type:"group",key:n,children:t.children.map((t,i)=>e(t,`${n}-${i}-${t.type}`)),disabled:t.disabled,expanded:t.expanded??!0,icon:t.icon,title:t.title,i18n:t.i18n,renderAsButton:t.renderAsButton??!1}:{type:"item",key:n,intent:t.intent,disabled:t.disabled,icon:t.icon,iconRight:t.iconRight,onAction:t.onAction,renderAsButton:t.renderAsButton??!1,selected:t.selected,title:t.title,i18n:t.i18n,tone:t.tone}}(n,`${e}-${n.type}`))}s+=r.length;let o=[];for(let e of i)o.find(t=>t.key===e.id)||o.push({type:"group",key:e.id,children:[],expanded:!0,renderAsButton:!1,title:e.title,i18n:e.i18n});let l=[];for(let t=0;t<n.length;t+=1){let i=n[t],r=i.group&&o.find(e=>e.key===i.group);i.group&&!r&&(r={type:"group",key:i.group,expanded:!0,icon:i.icon,title:i.group,children:[],renderAsButton:!1},o.push(r)),r?r.children.push({type:"item",key:`${s+t}-item`,hotkey:i.shortcut,icon:i.icon,intent:i.intent,onAction:()=>e.actionHandler(i),renderAsButton:i.showAsAction??!1,selected:i.selected,title:i.title,i18n:i.i18n,tone:i.tone}):l.push({type:"item",key:`${s+t}-item`,hotkey:i.shortcut,icon:i.icon,intent:i.intent,onAction:()=>e.actionHandler(i),renderAsButton:i.showAsAction??!1,selected:i.selected,title:i.title,i18n:i.i18n,tone:i.tone})}return[...l,...o,...r]}let tS=(0,a.forwardRef)(function(e,t){let{intent:n,...i}=e,r=(0,a.useMemo)(()=>(0,a.forwardRef)(function(e,t){return(0,o.jsx)(_.nR,{...e,intent:n.type,params:n.params,ref:t})}),[n]);return e.disabled?(0,o.jsx)(s.zx,{...i,as:"a",role:"link","aria-disabled":"true"}):(0,o.jsx)(s.zx,{...i,as:r,"data-as":"a",ref:t})});function tz({reveal:e,context:t,loading:n,children:i}){let r=(0,f.xJ)(),{t:l}=(0,f.$G7)(ez);return e?(0,o.jsx)(s.u,{content:n?l("insufficient-permissions-message-tooltip.loading-text"):(0,o.jsx)(f.FMn,{context:t,currentUser:r}),portal:!0,children:(0,o.jsx)("div",{children:i})}):(0,o.jsx)(o.Fragment,{children:i})}let t$={constrainSize:!0,placement:"bottom",portal:!0},tM=(e,t,n)=>{let i=t.find(e=>e.id===n.templateId)?.schemaType;if(!i)return null;let r={template:n.templateId,type:i,id:n.initialDocumentId};return{type:"create",params:n.parameters?[r,n.parameters]:r}};function tD({templateItems:e}){let t=(0,f.I_y)(),n=(0,f.zEW)(),{t:i}=(0,f.$G7)(ez),r=(0,f.sr_)([...e,...n]),[c,u]=(0,f.UMU)({templateItems:e}),p=(0,a.useMemo)(()=>!u&&c?.every(e=>!e.granted),[u,c]),m=(0,a.useMemo)(()=>c?c.reduce((e,t)=>(e[t.id]=t,e),{}):{},[c]);if(p)return(0,o.jsx)(tz,{context:"create-document-type",reveal:!0,loading:u,children:(0,o.jsx)(s.zx,{"aria-label":i("pane-header.disabled-created-button.aria-label"),icon:d.dtP,"data-testid":"action-intent-button",disabled:!0,mode:"bleed",tooltipProps:null})});if(1===e.length){let s=e[0],l=!m[s.id]?.granted,a=tM(t,n,s);return a?(0,o.jsx)(tz,{reveal:l,loading:u,context:"create-document-type",children:(0,o.jsx)(tS,{"aria-label":r(s).title,icon:s.icon||d.dtP,intent:a,mode:"bleed",disabled:l,"data-testid":"action-intent-button",tooltipProps:l?null:{content:i("pane-header.create-new-button.tooltip")}})}):null}return(0,o.jsx)(s.j2,{button:(0,o.jsx)(s.zx,{icon:d.dtP,mode:"bleed","data-testid":"multi-action-intent-button",tooltipProps:{content:i("pane-header.create-new-button.tooltip")}}),id:"create-menu",menu:(0,o.jsx)(l.v2,{children:e.map((e,l)=>{let c=!m[e.id]?.granted,d=tM(t,n,e),p=n.find(t=>t.id===e.templateId);if(!p||!d)return null;let h=(0,a.forwardRef)((e,t)=>c?(0,o.jsx)("button",{type:"button",disabled:!0,...e,ref:t}):(0,o.jsx)(_.nR,{...e,intent:d.type,params:d.params,ref:t}));h.displayName="Link";let{title:f}=r({...e,title:e.title||r(p).title});return(0,o.jsx)(tz,{context:"create-document-type",reveal:c,loading:u,children:(0,o.jsx)(s.sN,{as:h,"data-as":c?"button":"a",text:f,"aria-label":c?i("pane-header.disabled-created-button.aria-label"):f,disabled:c,"data-testid":`action-intent-button-${l}`})},e.id)})}),popover:t$})}function tR(e){return null!=e}let tL=e=>{let t=e=>"object"==typeof e&&e?Array.isArray(e)?e.map(t):Object.entries(e).sort(([e],[t])=>e.localeCompare(t,"en")):e;return JSON.stringify(t(JSON.parse(JSON.stringify(e))))},tP=(0,a.memo)(function(e){let{initialValueTemplateItems:t=f.LZ8,menuItems:n=f.LZ8,menuItemGroups:i=f.LZ8,actionHandlers:r=f.NuZ}=e,s=(0,f.zEW)(),c=(0,a.useCallback)(e=>{if("string"==typeof e.action&&!(e.action in r))return console.warn("No handler for action:",e.action),!1;let t="function"==typeof e.action?e.action:"string"==typeof e.action?r[e.action]:null;return!!t&&(t(e.params),!0)},[r]),d=(0,a.useMemo)(()=>tT({actionHandler:c,menuItemGroups:i,menuItems:n.filter(e=>e.intent?.type!=="create")}),[c,i,n]),u=(0,a.useMemo)(()=>d.filter(tI),[d]),p=(0,a.useMemo)(()=>d.filter(tE),[d]),m=(0,a.useMemo)(()=>n.map((e,t)=>{if(e.intent?.type!=="create")return null;let{params:n}=e.intent;if(!n)return null;let i=Array.isArray(n)?n[0]:n,r=Array.isArray(n)?n[1]:void 0,o=i.template||i.type;if(!o)return null;let l=s.find(e=>e.id===o);return l?{item:e,template:l,templateParams:r,menuItemIndex:t,initialDocumentId:i.id}:null}).filter(tR).map(({initialDocumentId:e,item:t,template:n,menuItemIndex:i,templateParams:r})=>({id:`menuItem${i}`,initialDocumentId:e,templateId:n.id,type:"initialValueTemplateItem",title:t.title||n.title,i18n:t.i18n||n.i18n,icon:t.icon,description:n.description,parameters:r,schemaType:n.schemaType})),[n,s]),h=(0,a.useMemo)(()=>eC([...m,...t],e=>tL([e.initialDocumentId,e.templateId,e.parameters])),[m,t]);return(0,o.jsxs)(l.kC,{gap:1,children:[h.length>0&&(0,o.jsx)(tD,{templateItems:h}),u.map(e=>(0,o.jsx)(tb,{node:e},e.key)),p.length>0&&(0,o.jsx)(tl,{nodes:p})]})});function tA(e){let{t}=(0,f.$G7)(ez),{layout:n,value:i}=e;return(0,o.jsx)(f.ogX,{title:(0,o.jsx)("em",{children:(0,o.jsx)(f.vNl,{t,i18nKey:"pane-item.missing-schema-type.title",components:{Code:"code"},values:{documentType:i._type}})}),subtitle:(0,o.jsx)(f.vNl,{t,i18nKey:"pane-item.missing-schema-type.subtitle",components:{Code:"code"},values:{documentId:i._id}}),media:()=>(0,o.jsx)(d.foC,{}),layout:n})}function tO(e,t,n){return!1!==e&&(e||t&&t.icon||n||!1)}function tN(e){let{icon:t,id:n,layout:i="default",pressed:r,schemaType:s,selected:c,title:u,value:p,margin:m,marginBottom:h,marginTop:g}=e,y=(0,f.I_y)(),b=(0,f.rq_)(),{ChildLink:j}=eF(),v=(0,f.Dqo)(n),w=!!(s&&s.name&&y.get(s.name)),[C,_]=(0,a.useState)(!1),k=(0,a.useMemo)(()=>p&&(0,x.Si)(p)?s&&w?(0,o.jsx)(eN,{documentPreviewStore:b,icon:tO(t,s,d.$lS),layout:i,schemaType:s,value:p,presence:v}):(0,o.jsx)(tA,{value:p}):(0,o.jsx)(f.ogX,{status:(0,o.jsx)(l.xu,{style:{opacity:.5},children:(0,o.jsx)(l.xv,{muted:!0,size:1,children:(0,o.jsx)(d.XCv,{})})}),icon:tO(t,s,d.ROc),layout:"compact",title:u}),[b,w,t,i,s,u,p,v]),I=(0,a.useMemo)(()=>function(e){return(0,o.jsx)(j,{...e,childId:n})},[j,n]),E=(0,a.useCallback)(e=>{if(e.metaKey){_(!1);return}_(!0)},[]);return(0,a.useEffect)(()=>_(!1),[c]),(0,o.jsx)(f.oUE,{"data-testid":`pane-item-${u}`,__unstable_focusRing:!0,as:I,"data-as":"a",margin:m,marginBottom:h,marginTop:g,onClick:E,pressed:r,radius:2,selected:c||C,sizing:"border",tabIndex:-1,tone:"inherit",children:k})}let tU=(0,a.memo)(e=>{let{actions:t,children:n,actionProps:i,onActionComplete:r,group:s}=e;return(0,o.jsx)(f.duV,{onReset:r,hooks:t,args:i,group:s,children:n})});tU.displayName="Memo(RenderActionCollectionState)";let tH=(0,a.memo)(e=>{let{badges:t,children:n,badgeProps:i}=e;return(0,o.jsx)(f.duV,{hooks:t,args:i,children:n})});function tB(e){let{children:t,currentMinWidth:n,flex:i,minWidth:r,paneKey:s,title:a="Error",tone:c="critical"}=e;return(0,o.jsxs)(e5,{currentMinWidth:n,flex:i,id:s,minWidth:r,tone:c,children:[(0,o.jsx)(tg,{title:a}),(0,o.jsx)(e6,{overflow:"auto",children:(0,o.jsx)(l.xu,{paddingX:4,paddingY:5,children:t})})]})}function tV(e){let t=[{ms:300,messageKey:"panes.resolving.default-message"},{ms:5e3,messageKey:"panes.resolving.slow-resolve-message"}];if(f.r8Q){let n=["Check console for errors?","Is your observable/promise resolving?",e.length>0?`Structure path: ${e.join(" ➝ ")}`:""];t.push({ms:1e4,message:n.join(`
`)})}let n=(0,S.of)(null);return(0,z.T)(...t.map(e=>n.pipe((0,Q.h)("messageKey"in e?{messageKey:e.messageKey}:{message:e.message}),(0,J.g)(e.ms))))}tH.displayName="Memo(RenderBadgeCollectionState)";let tq=(0,w.zo)(l.kC)`
  opacity: 0;
  transition: opacity 200ms;

  &[data-mounted] {
    opacity: 1;
  }
`,tF=(0,a.memo)(e=>{let{delay:t=300,flex:n,message:i=tV,minWidth:r,paneKey:s,path:c,selected:d,title:u,tone:p}=e,{t:m}=(0,f.$G7)(ez),h=(0,a.useMemo)(()=>"function"==typeof i?i(c?c.split(";"):[]):i,[i,c]),[x,g]=(0,a.useState)(()=>"string"==typeof h?h:m("panes.resolving.default-message"));(0,a.useEffect)(()=>{if("object"!=typeof h||"function"!=typeof h.subscribe)return;let e=h.subscribe(e=>{g("messageKey"in e?m(e.messageKey):e.message)});return()=>e.unsubscribe()},[h,m]);let[y,b]=(0,a.useState)(null),[j,v]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(y)return(0,l.RE)(()=>v(!0))},[y]),(0,o.jsx)(e5,{flex:n,id:s,minWidth:r,selected:d,tone:p,children:(0,o.jsx)(e6,{children:(0,o.jsx)(tq,{align:"center","data-mounted":j?"":void 0,direction:"column",height:"fill",justify:"center",ref:b,children:(0,o.jsx)(f.Bwn,{showText:!0,title:u||x})})})})});function tG(){let e=(0,a.useContext)(c.cO);if(!e)throw Error("DocumentPane: missing context value");return e}function tW(e){let{children:t,documentId:n,documentType:i}=e;return(0,o.jsx)(f.EM1,{documentId:n,documentType:i,children:(0,o.jsx)(tK,{documentId:n,documentType:i,children:t})})}function tK(e){let{children:t,documentId:n,documentType:i}=e,{enabled:r}=(0,f.g7N)(),{connectionState:s,onPathOpen:l,inspector:c,openInspector:d}=tG(),{params:u,setParams:p,createPathWithParams:m}=eF(),h=u?.comment,x=(0,a.useRef)(u);(0,a.useLayoutEffect)(()=>{x.current=u},[u]);let g=(0,a.useCallback)(e=>{let t=m({...x.current,comment:e,inspect:f.q$K});return`${window.location.origin}${t}`},[m]),y=(0,a.useCallback)(()=>{p({...x.current,comment:void 0})},[p]),b=(0,a.useCallback)(()=>{c?.name!==f.q$K&&d(f.q$K)},[c?.name,d]);return r?(0,o.jsx)(f.Cr6,{documentId:n,documentType:i,getCommentLink:g,isCommentsOpen:c?.name===f.q$K,isConnecting:"connecting"===s,onClearSelectedComment:y,onCommentsOpen:b,onPathOpen:l,selectedCommentId:h,sortOrder:"desc",type:"field",children:t}):(0,o.jsx)(o.Fragment,{children:t})}tF.displayName="Memo(LoadingPane)";let tX=!1,tY={},tZ=Symbol("LOADING_PANE"),tQ="documentPanelPortalElement";function tJ(){let e=(0,a.useContext)(c.r1);if(!e)throw Error("StructureTool: missing context value");return e}let t0={},t1="inspect:",t2=[{id:"inspectors"},{id:"links"}],t8="sanity/structure/history";function t3(e){let{documentId:t,documentType:n,inspectors:i,onMenuItems:r}=e,s=i.length,l=(0,a.useRef)(s),[c,d]=(0,a.useState)(()=>Array.from(Array(s))),u=(0,a.useRef)(c);(0,a.useEffect)(()=>{if(l.current!==s){let e=Array.from(Array(s));for(let t=0;t<s;t++)e[t]=u.current[t];l.current=s,d(()=>(u.current=e,e))}},[s]);let p=(0,a.useCallback)((e,t)=>{d(n=>{let i=[...n];return i[e]=t,u.current=i,i})},[]);(0,a.useEffect)(()=>{r(c.filter(Boolean))},[c,r]);let m=(0,a.useMemo)(()=>i.map((e,i)=>e.useMenuItem?[function({documentId:e,documentType:t,index:n,setMenuItem:i,useMenuItem:r}){return(0,a.memo)(function(){let s=r({documentId:e,documentType:t}),o=(0,f.BoV)(s);return(0,a.useEffect)(()=>{i(n,o)},[o]),null})}({documentId:t,documentType:n,index:i,setMenuItem:p,useMenuItem:e.useMenuItem}),e.name]:[()=>null,""]),[t,n,i,p]);return(0,o.jsx)(o.Fragment,{children:m.map(([e,t])=>t&&(0,o.jsx)(e,{},t))})}function t4(){let{connectionState:e,schemaType:t,title:n,editState:i}=tG(),r=i?.draft||i?.published,s=!!r,{error:o,value:l}=(0,f._2T)({enabled:s,schemaType:t,value:r});return"connecting"!==e||s?n?{error:void 0,title:n}:r?o?{error:`Error: ${o.message}`,title:void 0}:{error:void 0,title:l?.title}:{error:void 0,title:`New ${t?.title||t?.name}`}:{error:void 0,title:void 0}}let t5=["patch","commit"],t7=(0,a.memo)(function(){let{push:e}=(0,l.pm)(),{documentId:t,documentType:n,value:i}=tG(),r=t4(),s=r.error,c=(0,f.E6V)(t,n),d=(0,a.useRef)(c),u=eF(),{t:p}=(0,f.$G7)(ez),m=(0,a.useMemo)(()=>r.title||s||t5.includes(c?.op)||"string"!=typeof i.title||c?.type!=="success"?r.title:i.title,[r.title,s,c,i.title])||p("panes.document-operation-results.operation-undefined-title"),h=m.length>25?`${m.slice(0,25)}...`:m;return(0,a.useEffect)(()=>{let t;if(c&&c!==d.current)return"error"===c.type&&e({closable:!0,duration:3e4,status:"error",title:p("panes.document-operation-results.operation-error",{context:c.op}),description:(0,o.jsxs)("details",{children:[(0,o.jsx)("summary",{children:p("panes.document-operation-results.error.summary.title")}),c.error.message]})}),"success"!==c.type||t5.includes(c.op)||e({closable:!0,status:"success",title:(0,o.jsx)(f.vNl,{context:c.op,i18nKey:"panes.document-operation-results.operation-success",t:p,values:{op:c.op,title:h},components:{Strong:"strong"}})}),"success"===c.type&&"delete"===c.op&&(t=setTimeout(()=>u.closeCurrentAndAfter(),0)),d.current=c,()=>clearTimeout(t)},[c,u,e,p,h]),null}),t9=e=>!0===e.liveEdit,t6=(0,w.zo)(l.Zb)({position:"relative",zIndex:1,lineHeight:0});function ne(e){let{as:t,children:n,closeButtonLabel:i,onClose:r,title:a,...c}=e,{t:u}=(0,f.$G7)(ez);return(0,o.jsxs)(t6,{...c,as:t,children:[(0,o.jsxs)(l.kC,{padding:2,children:[(0,o.jsx)(l.xu,{flex:1,padding:3,children:(0,o.jsx)(l.xv,{as:"h1",size:1,weight:"medium",children:a})}),(0,o.jsx)(l.xu,{flex:"none",padding:1,children:(0,o.jsx)(s.zx,{"aria-label":i,icon:d.Two,mode:"bleed",onClick:r,tooltipProps:{content:u("document-inspector.close-button.tooltip")}})})]}),n]})}let nt=w.zo.div`
  position: absolute;
  top: 0;
  left: -4px;
  bottom: 0;
  width: 9px;
  z-index: 201;
  cursor: ew-resize;

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  /* Hover effect */
  & > span:nth-child(2) {
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    width: 9px;
    bottom: 0;
    background-color: var(--card-border-color);
    opacity: 0;
    transition: opacity 150ms;
  }

  @media (hover: hover) {
    &:hover > span:nth-child(2) {
      opacity: 0.2;
    }
  }
`;function nn(e){let{onResize:t,onResizeStart:n}=e,i=(0,a.useRef)(0),r=(0,a.useCallback)(e=>{e.preventDefault(),i.current=e.pageX,n();let r=e=>{e.preventDefault(),t(e.pageX-i.current)},s=()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)},[t,n]);return(0,o.jsxs)(nt,{onMouseDown:r,children:[(0,o.jsx)("span",{}),(0,o.jsx)("span",{})]})}let ni=(0,w.zo)(l.xu)`
  position: relative;
  flex: 1;
  padding-left: 1px;
`;function nr(e){let{as:t,children:n,minWidth:i,maxWidth:r,...s}=e,[l,c]=(0,a.useState)(null),d=(0,a.useRef)(),[u,p]=(0,a.useState)(),m=(0,a.useCallback)(()=>{d.current=l?.offsetWidth},[l]),h=(0,a.useCallback)(e=>{let t=d.current;t&&p(Math.min(Math.max(t-e,i),r))},[i,r]),f=(0,a.useMemo)(()=>u?{flex:"none",width:u}:{minWidth:i,maxWidth:r},[i,r,u]);return(0,o.jsxs)(ni,{as:t,...s,ref:c,style:f,children:[n,(0,o.jsx)(nn,{onResize:h,onResizeStart:m})]})}function ns(e){let{documentId:t,documentType:n,flex:i}=e,{collapsed:r}=e9(),{closeInspector:s,inspector:c}=tG(),{features:d}=tJ(),u=(0,a.useCallback)(()=>{c&&s(c.name)},[s,c]);if(r||!c)return null;let p=(0,a.createElement)(c.component,{onClose:u,documentId:t,documentType:n});return d.resizablePanes?(0,o.jsx)(nr,{as:"aside","data-ui":"DocumentInspectorPanel",flex:i,maxWidth:540,minWidth:320,children:p}):(0,o.jsx)(l.xu,{as:"aside","data-ui":"DocumentInspectorPanel",flex:i,children:p})}function no(e,t,n){let i=(0,f.tJW)(),r=["studio.structure-tool",e,t].filter(Boolean).join("."),s=(0,a.useMemo)(()=>i.getKey(r).pipe((0,$.U)(e=>null===e?n:e)),[n,i,r]),o=(0,ec.m)(s,n),l=(0,a.useCallback)(e=>{e!==o&&i.setKey(r,e)},[i,r,o]);return(0,a.useMemo)(()=>[o,l],[l,o])}let nl={id:"parsed",title:"document-inspector.view-mode.parsed"},na={id:"raw",title:"document-inspector.view-mode.raw-json"},nc=[nl,na],nd=new el({maxSize:1e3});function nu(e){let{path:t}=e,n=nd.get(t);void 0!==n&&nd.set(t,!n)}function np(e){let t=window.getSelection();if(t){let n=document.createRange();t.removeAllRanges(),n.selectNodeContents(e),t.addRange(n)}}function nm(e){np(e.currentTarget)}function nh(e){65===e.keyCode&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),np(e.currentTarget))}let nf=w.zo.div(({theme:e})=>{let{color:t,fonts:n,space:i}=e.sanity;return(0,w.iv)`
    & .json-inspector,
    & .json-inspector .json-inspector__selection {
      font-family: ${n.code.family};
      font-size: ${n.code.sizes[1].fontSize}px;
      line-height: ${n.code.sizes[1].lineHeight}px;
      color: var(--card-code-fg-color);
    }

    & .json-inspector .json-inspector__leaf {
      padding-left: ${(0,l.hO)(i[4])};
    }

    & .json-inspector .json-inspector__leaf.json-inspector__leaf_root {
      padding-top: ${(0,l.hO)(i[3])};
      padding-left: 0;
    }

    & .json-inspector > .json-inspector__leaf_root > .json-inspector__line > .json-inspector__key {
      display: none;
    }

    & .json-inspector .json-inspector__line {
      display: block;
      position: relative;
      cursor: default;
    }

    & .json-inspector .json-inspector__line::after {
      content: '';
      position: absolute;
      top: 0;
      left: -200px;
      right: -50px;
      bottom: 0;
      z-index: -1;
      pointer-events: none;
    }

    & .json-inspector .json-inspector__line:hover::after {
      background: var(--card-code-bg-color);
    }

    & .json-inspector .json-inspector__leaf_composite > .json-inspector__line {
      cursor: pointer;
    }

    & .json-inspector .json-inspector__leaf_composite > .json-inspector__line::before {
      content: '▸ ';
      margin-left: calc(0 - ${(0,l.hO)(i[4])} + 3px);
      font-size: ${n.code.sizes[1].fontSize}px;
      line-height: ${n.code.sizes[1].lineHeight}px;
    }

    &
      .json-inspector
      .json-inspector__leaf_expanded.json-inspector__leaf_composite
      > .json-inspector__line::before {
      content: '▾ ';
      font-size: ${n.code.sizes[1].fontSize}px;
      line-height: ${n.code.sizes[1].lineHeight}px;
    }

    & .json-inspector .json-inspector__radio,
    & .json-inspector .json-inspector__flatpath {
      display: none;
    }

    & .json-inspector .json-inspector__value {
      margin-left: ${(0,l.hO)(i[4]/2)};
    }

    &
      .json-inspector
      > .json-inspector__leaf_root
      > .json-inspector__line
      > .json-inspector__key
      + .json-inspector__value {
      margin: 0;
    }

    & .json-inspector .json-inspector__key {
      color: ${t.syntax.property};
    }

    & .json-inspector .json-inspector__value_helper,
    & .json-inspector .json-inspector__value_null {
      color: ${t.syntax.constant};
    }

    & .json-inspector .json-inspector__not-found {
      padding-top: ${(0,l.hO)(i[3])};
    }

    & .json-inspector .json-inspector__value_string {
      color: ${t.syntax.string};
    }

    & .json-inspector .json-inspector__value_boolean {
      color: ${t.syntax.boolean};
    }

    & .json-inspector .json-inspector__value_number {
      color: ${t.syntax.number};
    }

    & .json-inspector .json-inspector__show-original {
      display: inline-block;
      padding: 0 6px;
      cursor: pointer;
    }

    & .json-inspector .json-inspector__show-original:hover {
      color: inherit;
    }

    & .json-inspector .json-inspector__show-original::before {
      content: '↔';
    }

    & .json-inspector .json-inspector__show-original:hover::after {
      content: ' expand';
    }
  `});function nx(e){let{onChange:t,query:n}=e,i=(0,a.useCallback)(e=>t(e.target.value),[t]),{t:r}=(0,f.$G7)(ez);return(0,o.jsx)(l.oi,{icon:d.W1M,onChange:i,placeholder:r("document-inspector.search.placeholder"),radius:2,value:n||""})}function ng(e){let{value:t}=e,{onInspectClose:n,paneKey:i}=tG(),r=`${i}_inspect_`,[c,d]=no("inspect-view-mode",null,"parsed"),u=nc.find(e=>e.id===c),p=(0,a.useCallback)(()=>{d(nl.id)},[d]),m=(0,a.useCallback)(()=>{d(na.id)},[d]),{t:h}=(0,f.$G7)(ez);return(0,o.jsx)(s.Vq,{bodyHeight:"fill",id:`${r}dialog`,header:(0,f.Uy$)(t)&&(0,f.HD0)(t._id)&&(0,f.HD0)(t._type)?(0,o.jsx)(f.vNl,{t:h,i18nKey:"document-inspector.dialog.title",components:{DocumentTitle:()=>(0,o.jsx)("em",{children:(0,o.jsx)(eM,{document:t})})}}):(0,o.jsx)("em",{children:h("document-inspector.dialog.title-no-value")}),onClose:n,onClickOutside:n,padding:!1,width:2,children:(0,o.jsxs)(l.kC,{direction:"column",height:"fill",children:[(0,o.jsx)(l.Zb,{padding:3,paddingTop:0,shadow:1,style:{position:"sticky",bottom:0,zIndex:3},children:(0,o.jsxs)(l.td,{space:1,children:[(0,o.jsx)(s.OK,{"aria-controls":`${r}tabpanel`,id:`${r}tab-${nl.id}`,label:h(nl.title),onClick:p,selected:u===nl}),(0,o.jsx)(s.OK,{"aria-controls":`${r}tabpanel`,id:`${r}tab-${na.id}`,label:h(na.title),onClick:m,selected:u===na})]})}),(0,o.jsxs)(l.x4,{"aria-labelledby":`${r}tab-${c}`,flex:1,id:`${r}tabpanel`,overflow:"auto",padding:4,style:{outline:"none"},children:[u===nl&&(0,o.jsx)(nf,{children:(0,o.jsx)(eo,{data:t,isExpanded:function e(t,n){let i=nd.get(t);return void 0===i?(nd.set(t,Array.isArray(n)||(0,f.Uy$)(n)),e(t,n)):i},onClick:nu,search:nx,filterOptions:{ignoreCase:!0}})}),u===na&&(0,o.jsx)(l.EK,{language:"json",tabIndex:0,onKeyDown:nh,onDoubleClick:nm,onFocus:nm,size:1,children:JSON.stringify(t,null,2)})]})]})})}function ny(e){let{action:t,content:n,icon:i,tone:r="transparent",...a}=e;return(0,o.jsx)(l.Zb,{borderBottom:!0,paddingX:4,paddingY:2,tone:r,...a,children:(0,o.jsxs)(l.kC,{align:"center",gap:3,children:[i&&(0,o.jsx)(l.xv,{size:0,children:(0,o.jsx)(i,{})}),(0,o.jsx)(l.kC,{align:"center",flex:1,gap:2,paddingY:3,children:n}),t&&(0,o.jsx)(s.zx,{...t,mode:t.mode||"ghost",tone:t.tone||"default"})]})})}function nb({revisionId:e}){let{documentId:t,documentType:n}=tG(),{restore:i}=(0,f.d9t)(t,n),{navigateIntent:r}=(0,_.tv)(),s=(0,a.useCallback)(()=>{e&&(i.execute(e),r("edit",{id:t,type:n}))},[t,n,r,i,e]),{t:c}=(0,f.$G7)(ez);return(0,o.jsx)(ny,{action:e?{onClick:s,text:c("banners.deleted-document-banner.restore-button.text")}:void 0,content:(0,o.jsx)(l.xv,{size:1,weight:"medium",children:c("banners.deleted-document-banner.text")}),"data-testid":"deleted-document-banner",icon:d.CPA})}function nj(){let{schemaType:e}=tG(),{t}=(0,f.$G7)(ez);return(0,x.Ax)(e)?(0,o.jsx)(ny,{content:(0,o.jsxs)(l.xv,{size:1,weight:"medium",children:[(0,o.jsx)(f.vNl,{t,i18nKey:"banners.deprecated-document-type-banner.text"})," ",e.deprecated.reason]}),"data-testid":"deprecated-document-type-banner",icon:d.uIy}):null}let nv=(0,ed.dS)({name:"Ask To Edit Dialog Opened",version:1,description:'User clicked the "Ask to edit" button in the document permissions banner'}),nw=(0,ed.dS)({name:"Ask To Edit Request Sent",version:1,description:"User sent a role change request from the dialog"}),nC=(0,w.zo)(l.xu)`
  box-sizing: border-box;
`;function n_({onClose:e,onRequestSubmitted:t}){let{t:n}=(0,f.$G7)(ez),i=(0,ea.f1)(),r=`request-permissions-${(0,a.useId)()}`,c=(0,f.vpR)(),d=(0,f.m85)({apiVersion:"2024-09-26"}),u=(0,l.pm)(),p=(0,f.Cnp)(),[m,h]=(0,a.useState)(!1),[x,g]=(0,a.useState)(""),[y,b]=(0,a.useState)(),[j,v]=(0,a.useState)(!1),[w,C]=(0,a.useState)(!1),_=(0,a.useMemo)(()=>{let e="administrator";return c&&d?d.observable.request({url:`/projects/${c}/roles`}).pipe((0,$.U)(t=>t.filter(e=>e?.appliesToUsers).find(e=>"editor"===e.name)?"editor":e),(0,M.O)(e),(0,D.K)(()=>(0,S.of)(e))):(0,S.of)(e)},[c,d]),k=(0,ec.m)(_),I=()=>{h(!0),d.request({url:`/access/project/${c}/requests`,method:"post",body:{note:x,requestUrl:window?.location.href,requestedRole:k,type:"role"}}).then(e=>{e&&(t&&t(),i.log(nw),u.push({title:"Edit access requested"}))}).catch(e=>{let t=e?.response?.statusCode,n=e?.response?.body?.message;429===t&&(v(!0),b(n)),409===t?(C(!0),b(n)):u.push({title:"There was a problem submitting your request.",status:"error"})}).finally(()=>{h(!1)})};return(0,o.jsx)(l.Tu,{position:"fixed",zOffset:p.fullscreen,children:(0,o.jsx)(s.Vq,{width:1,id:r,header:n("request-permission-dialog.header.text"),footer:{cancelButton:{onClick:e,text:n("confirm-dialog.cancel-button.fallback-text")},confirmButton:{onClick:I,loading:m,disabled:j||w,text:n("request-permission-dialog.confirm-button.text"),tone:"primary",type:"submit"}},onClose:e,onClickOutside:e,children:(0,o.jsx)(nC,{children:(0,o.jsxs)(l.Kq,{space:4,children:[(0,o.jsx)(l.xv,{children:n("request-permission-dialog.description.text")}),j||w?(0,o.jsx)(l.Zb,{tone:"caution",padding:3,radius:2,shadow:1,children:(0,o.jsxs)(l.xv,{size:1,children:[j&&(0,o.jsx)(o.Fragment,{children:y??n("request-permission-dialog.warning.limit-reached.text")}),w&&(0,o.jsx)(o.Fragment,{children:y??n("request-permission-dialog.warning.denied.text")})]})}):(0,o.jsxs)(l.Kq,{space:3,paddingBottom:0,children:[(0,o.jsx)(l.oi,{placeholder:n("request-permission-dialog.note-input.placeholder.text"),disabled:m,onKeyDown:e=>{"Enter"===e.key&&I()},maxLength:150,value:x,onChange:e=>{g(e.currentTarget.value)}}),(0,o.jsx)(l.xv,{align:"right",muted:!0,size:1,children:`${x.length}/150`})]})]})})})})}(0,w.zo)(l.kC).attrs({align:"center",direction:"column",justify:"center"})`
  height: 110px;
`;let nk={loading:!0,error:!1,status:void 0},nI={loading:!1,error:!1,status:"none"},nE={loading:!1,error:!1,status:"declined"},nT={loading:!1,error:!1,status:"pending"},nS={loading:!1,error:!1,status:"expired"},nz=()=>{let e=(0,f.m85)({apiVersion:"2024-07-01"}),t=(0,f.vpR)(),n=(0,a.useMemo)(()=>e&&t?e.observable.request({url:"/access/requests/me",tag:"use-role-requests-status"}).pipe((0,$.U)(e=>{if(!e||0===e.length)return nI;let n=e.filter(e=>e.resourceId===t&&"role"===e.type),i=n.find(e=>"declined"===e.status);return i&&(0,eu.Z)((0,ep.Z)(new Date(i.createdAt),2),new Date)?nE:n.find(e=>"pending"===e.status&&(0,eu.Z)((0,ep.Z)(new Date(e.createdAt),2),new Date))?nT:n.find(e=>"pending"===e.status&&(0,em.Z)((0,ep.Z)(new Date(e.createdAt),2),new Date))?nS:nI}),(0,D.K)(e=>(console.error("Failed to fetch access requests",e),(0,S.of)({loading:!1,error:!0,status:void 0}))),(0,M.O)(nk)):(0,S.of)(nI),[e,t]),{loading:i,error:r,status:s}=(0,ec.m)(n,nk);return{data:s,loading:i,error:r}};function n$({requiredPermission:e}){let t=(0,f.xJ)(),{data:n,loading:i,error:r}=nz(),[s,c]=(0,a.useState)(!1),u=(0,a.useMemo)(()=>"pending"===n||"declined"===n||s,[n,s]),p=t?.roles||[],m=1===p.length&&"viewer"===p[0].name,[h,x]=(0,a.useState)(!1),g=(0,f.WEl)({style:"short"}),{t:y}=(0,f.$G7)(ez),b=(0,ea.f1)(),j=p.map(e=>e.title),v=g.formatToParts(j).map(e=>"element"===e.type?(0,o.jsx)("code",{children:e.value},e.value):e.value);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ny,{content:(0,o.jsx)(l.xv,{size:1,weight:"medium",children:(0,o.jsx)(f.vNl,{t:y,i18nKey:"banners.permission-check-banner.missing-permission",components:{Roles:()=>(0,o.jsx)(o.Fragment,{children:v})},values:{count:v.length,roles:j},context:e})}),action:m&&n&&!r&&!i?{onClick:u?void 0:()=>{x(!0),b.log(nv)},text:y(u?"banners.permission-check-banner.request-permission-button.sent":"banners.permission-check-banner.request-permission-button.text"),tone:u?"default":"primary",disabled:u,mode:u?"bleed":void 0}:void 0,"data-testid":"permission-check-banner",icon:d.CPA}),h&&(0,o.jsx)(n_,{onClose:()=>x(!1),onRequestSubmitted:()=>{c(!0),x(!1)}})]})}let nM=(0,a.memo)(()=>{let e=(0,f.rq_)(),{params:t,groupIndex:n,routerPanesState:i,replaceCurrent:r,BackLink:s}=eF(),c=i[n]?.[0].id,u=i[n-1]?.[0],p=u?.id,m=!!u?.params?.rev,h=(0,a.useMemo)(()=>t?.parentRefPath&&(0,k.mL)(t.parentRefPath)||null,[t?.parentRefPath]),{t:x}=(0,f.$G7)(ez),g=(0,a.useMemo)(()=>{let t=h?.[0];if(!p||!t||!h)return(0,S.of)({loading:!1});let n=(0,f.vsM)(p),i=(0,k.mL)(t),r=i.findIndex(e=>"object"==typeof e&&"_key"in e);return(0,R.z)((0,S.of)({loading:!0}),e.unstable_observePathsDocumentPair(n,-1===r?i:i.slice(0,r)).pipe((0,ee.b)(750),(0,$.U)(({draft:e,published:t})=>({loading:!1,result:{availability:{draft:e.availability,published:t.availability},refValue:k.U2(e.snapshot||t.snapshot,h)?._ref}}))))},[e,p,h]),y=(0,ec.m)(g,{loading:!0}),b=(0,a.useCallback)(()=>{y.loading||y.result?.refValue&&r({id:y.result.refValue,params:t})},[y.loading,y.result,r,t]);return p&&h&&!m&&!y.loading&&(y.result?.availability.draft.available||y.result?.availability.published.available)&&y.result?.refValue!==c?(0,o.jsx)(ny,{action:y.result?.refValue?{onClick:b,icon:d.bnu,text:x("banners.reference-changed-banner.reason-changed.reload-button.text")}:{as:s,icon:d.Two,text:x("banners.reference-changed-banner.reason-removed.close-button.text")},"data-testid":"reference-changed-banner",content:(0,o.jsx)(l.xv,{size:1,weight:"medium",children:x(y.result?.refValue?"banners.reference-changed-banner.reason-changed.text":"banners.reference-changed-banner.reason-removed.text")}),icon:d.foC,tone:"caution"}):null});nM.displayName="Memo(ReferenceChangedBanner)";let nD=(0,ed.dS)({name:"Resolved LiveEdit Draft",version:1,description:"User resolved a draft of a live edit document to continue editing"});function nR({displayed:e,documentId:t,schemaType:n}){let{t:i}=(0,f.$G7)(ez),[r,c]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1),m=(0,ea.f1)(),{publish:h,discardChanges:x}=(0,f.d9t)(t,e?._type||""),g=(0,a.useCallback)(()=>{h.execute(),c(!0),m.log(nD,{liveEditResolveType:"publish"})},[h,m]),y=(0,a.useCallback)(()=>{x.execute(),p(!0),m.log(nD,{liveEditResolveType:"discard"})},[x,m]);return(0,a.useEffect)(()=>()=>{c(!1),p(!1)}),e&&e._id&&!(0,f.Cb2)(e._id)?null:(0,o.jsx)(ny,{content:(0,o.jsxs)(l.kC,{align:"center",justify:"space-between",gap:1,children:[(0,o.jsx)(l.xv,{size:1,weight:"medium",children:(0,o.jsx)(f.vNl,{t:i,i18nKey:"banners.live-edit-draft-banner.text",values:{schemaType:n.title}})}),(0,o.jsx)(s.zx,{onClick:g,text:i("action.publish.live-edit.label"),tooltipProps:{content:i("banners.live-edit-draft-banner.publish.tooltip")},loading:r}),(0,o.jsx)(s.zx,{onClick:y,text:i("banners.live-edit-draft-banner.discard.tooltip"),tooltipProps:{content:i("banners.live-edit-draft-banner.discard.tooltip")},loading:u})]}),"data-testid":"live-edit-type-banner",icon:d.uIy})}let nL=(0,w.zo)(l.Kq)`
  ${({theme:e})=>(0,w.iv)`
      @supports not (container-type: inline-size) {
        display: none !important;
      }

      container-type: inline-size;

      [data-heading] {
        font-size: ${e.sanity.fonts.heading.sizes[4].fontSize}px;
        line-height: ${e.sanity.fonts.heading.sizes[4].lineHeight}px;
        overflow-wrap: break-word;
        text-wrap: pretty;
      }

      @container (max-width: 560px) {
        [data-heading] {
          font-size: ${e.sanity.fonts.heading.sizes[3].fontSize}px;
          line-height: ${e.sanity.fonts.heading.sizes[3].lineHeight}px;
        }
      }

      @container (max-width: 420px) {
        [data-heading] {
          font-size: ${e.sanity.fonts.heading.sizes[2].fontSize}px;
          line-height: ${e.sanity.fonts.heading.sizes[2].lineHeight}px;
        }
      }
    `}
`,nP=({documentId:e,schemaType:t,title:n})=>{let i=e===t.name,{t:r}=(0,es.$G)(ez);return!1===t.__experimental_formPreviewTitle?null:(0,o.jsxs)(nL,{marginBottom:6,space:4,children:[!i&&(0,o.jsx)(l.xv,{muted:!0,size:1,children:t.title??t.name}),(0,o.jsx)(l.X6,{as:"h2","data-heading":!0,muted:!n,"data-testid":"document-panel-document-title",children:n??r("document-view.form-view.form-title-fallback")})]})},nA=e=>e.preventDefault(),nO=(0,a.forwardRef)(function(e,t){let{hidden:n,margins:i}=e,{collapsedFieldSets:r,collapsedPaths:s,displayed:c,editState:d,documentId:u,documentType:p,fieldActions:m,onChange:h,validation:x,ready:g,formState:y,onFocus:b,connectionState:j,onBlur:v,onSetCollapsedPath:w,onPathOpen:C,onSetCollapsedFieldSet:_,onSetActiveFieldGroup:k,openPath:I}=tG(),E=(0,f.H__)(),T=(0,f.Dqo)(u),{title:S}=t4(),z=(0,a.useMemo)(()=>(0,f.fm0)(),[]),$=d?.transactionSyncLock?.enabled,{t:M}=(0,f.$G7)(ez);(function(e){let t=(0,l.pm)();(0,a.useEffect)(()=>(e.enabled&&t.push({...e,duration:20736e5}),()=>{e.enabled&&t.push({...e,duration:.01})}),[e,t])})((0,a.useMemo)(()=>({id:"sync-lock",status:"warning",enabled:$,title:M("document-view.form-view.sync-lock-toast.title"),description:M("document-view.form-view.sync-lock-toast.description"),closable:!0}),[$,M])),(0,a.useEffect)(()=>{let e=E.pair.documentEvents(u,p).pipe((0,W.b)(e=>{"mutation"===e.type&&z.publish(function(e){let t=e.mutations.map(e=>e.patch).filter(Boolean);return{type:"mutation",snapshot:e.document,patches:(0,f.Sis)(e.origin,t)}}(e)),"rebase"===e.type&&z.publish(function(e){let t=e.remoteMutations.map(e=>e.patch).filter(Boolean),n=e.localMutations.map(e=>e.patch).filter(Boolean);return{type:"rebase",snapshot:e.document,patches:(0,f.Sis)("remote",t).concat((0,f.Sis)("local",n))}}(e))})).subscribe();return()=>{e.unsubscribe()}},[u,E,p,z]);let D=!!c?._rev;(0,a.useEffect)(()=>{D&&z.publish({type:"mutation",patches:[],snapshot:c})},[D]);let[R,L]=(0,a.useState)(null),[P,A]=(0,a.useState)(!1);(0,a.useEffect)(()=>{!P&&g&&!y?.focusPath.length&&R&&(A(!0),(0,l.fo)(R))},[P,R,y?.focusPath.length,g]);let O=(0,a.useCallback)(e=>{L(e),"function"==typeof t?t(e):t&&(t.current=e)},[t]);return(0,o.jsx)(l.W2,{hidden:n,paddingX:4,paddingTop:5,paddingBottom:9,sizing:"border",width:1,children:(0,o.jsx)(f.$rW,{margins:i,children:(0,o.jsx)(l.xu,{as:"form",onSubmit:nA,ref:O,children:"connecting"!==j||d?.draft||d?.published?null===y||n?(0,o.jsx)(l.xu,{padding:2,children:(0,o.jsx)(l.xv,{children:M("document-view.form-view.form-hidden")})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(nP,{documentId:u,schemaType:y.schemaType,title:S}),(0,o.jsx)(f.quP,{__internal_fieldActions:m,__internal_patchChannel:z,changed:y.changed,collapsedFieldSets:r,collapsedPaths:s,focused:y.focused,focusPath:y.focusPath,groups:y.groups,id:"root",members:y.members,onChange:h,onFieldGroupSelect:k,onPathBlur:v,onPathFocus:b,onPathOpen:C,onSetFieldSetCollapsed:_,onSetPathCollapsed:w,openPath:I,presence:T,readOnly:"reconnecting"===j||y.readOnly||!d?.ready,schemaType:y.schemaType,validation:x,value:y.value})]}):(0,o.jsx)(e2,{ms:300,children:(0,o.jsxs)(l.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:[(0,o.jsx)(l.$j,{muted:!0}),(0,o.jsx)(l.xu,{marginTop:3,children:(0,o.jsx)(l.xv,{align:"center",muted:!0,size:1,children:M("document-view.form-view.loading")})})]})})})})})}),nN=(0,w.zo)(l.xu)({position:"relative"}),nU=(0,w.zo)(f.l$t)(({$disabled:e})=>e?{height:"100%"}:(0,w.iv)`
    height: 100%;
    overflow: auto;
    position: relative;
    scroll-behavior: smooth;
    outline: none;
  `),nH=function(e){let{footerHeight:t,headerHeight:n,isInspectOpen:i,rootElement:r,setDocumentPanelPortalElement:s}=e,{activeViewId:c,displayed:d,documentId:u,editState:p,inspector:m,value:h,views:x,ready:g,schemaType:y,permissions:b,isPermissionsLoading:j,isDeleting:v,isDeleted:w,timelineStore:C}=tG(),{collapsed:_}=eH(),{collapsed:k}=e9(),I=(0,l.vI)(),{features:E}=tJ(),T=(0,a.useRef)(null),[S,z]=(0,a.useState)(null),$=(0,a.useRef)(null),M=h._createdAt?"update":"create",D=(0,a.useMemo)(()=>x.find(e=>e.id===c)||x[0]||{type:"form"},[c,x]),R=E.splitPanes&&T.current||I.element,L=(0,a.useMemo)(()=>_?[n||0,0,t?t+2:2,0]:[0,0,2,0],[_,t,n]),P="form"!==D.type,A=(0,a.useMemo)(()=>"component"===D.type&&D.component&&(0,a.createElement)(D.component,{document:{draft:p?.draft||null,displayed:d||h,historical:d,published:p?.published||null},documentId:u,options:D.options,schemaType:y}),[D,d,u,p?.draft,p?.published,y,h]),O=(0,f.P08)(C,e=>e.lastNonDeletedRevId),N=t9(y);(0,a.useEffect)(()=>{S?.scrollTo&&S.scrollTo(0,0)},[u,S]),(0,a.useEffect)(()=>{R&&s(R)},[R,s]);let U=(0,a.useMemo)(()=>i?(0,o.jsx)(ng,{value:d||h}):null,[i,d,h]),H=!!(!k&&m);return(0,o.jsx)(e6,{children:(0,o.jsxs)(l.kC,{height:"fill",children:[(E.resizablePanes||!H)&&(0,o.jsx)(nN,{flex:2,overflow:"hidden",children:(0,o.jsx)(l.Xp,{element:R,__unstable_elements:{documentScrollElement:S},children:(0,o.jsx)(l.NM,{element:S,children:(0,o.jsxs)(f.Ahg,{scrollElement:S,containerElement:$,children:["form"===D.type&&N&&g&&(0,o.jsx)(nR,{displayed:d,documentId:u,schemaType:y}),"form"===D.type&&!j&&g&&(0,o.jsxs)(o.Fragment,{children:[!b?.granted&&(0,o.jsx)(n$,{requiredPermission:M}),!v&&w&&(0,o.jsx)(nb,{revisionId:O}),(0,o.jsx)(nM,{}),(0,o.jsx)(nj,{})]}),(0,o.jsxs)(nU,{$disabled:_||!1,"data-testid":"document-panel-scroller",ref:z,children:[(0,o.jsx)(nO,{hidden:P,margins:L,ref:$}),A]}),U,(0,o.jsx)("div",{"data-testid":"document-panel-portal",ref:T})]})})})}),H&&(0,o.jsx)(l.NM,{element:r,children:(0,o.jsx)(ns,{documentId:u,documentType:y.name,flex:1})})]})})},nB=["left","bottom"],nV={small:0,medium:1,large:2,full:"auto"};function nq(e){let{dialog:t,referenceElement:n}=e;return(0,o.jsx)(l.J2,{content:(0,o.jsx)(nF,{dialog:t}),fallbackPlacements:nB,open:!0,placement:"top",portal:!0,preventOverflow:!0,referenceElement:n})}function nF(e){let{dialog:t}=e,{cancelButtonIcon:n,cancelButtonText:i,confirmButtonIcon:r,confirmButtonText:s,message:c,onCancel:d,onConfirm:u,tone:p}=t,{t:m}=(0,f.$G7)(ez),{isTopLayer:h}=(0,l.sJ)(),x=(0,a.useRef)(null),g=(0,a.useCallback)(e=>{"Escape"===e.key&&h&&d()},[h,d]);return(0,l.qh)(g),(0,l.Of)(h&&d,()=>[x.current]),(0,o.jsxs)(l.kC,{direction:"column",ref:x,style:{minWidth:304,maxWidth:400},children:[(0,o.jsx)(l.xu,{flex:1,overflow:"auto",padding:4,children:(0,o.jsx)(l.xv,{children:c})}),(0,o.jsx)(l.xu,{paddingX:4,paddingY:3,style:{borderTop:"1px solid var(--card-border-color)"},children:(0,o.jsxs)(l.rj,{columns:2,gap:2,children:[(0,o.jsx)(l.zx,{"data-testid":"confirm-dialog-cancel-button",icon:n,onClick:d,mode:"ghost",text:i||m("confirm-dialog.cancel-button.fallback-text")}),(0,o.jsx)(l.zx,{"data-testid":"confirm-dialog-confirm-button",icon:r,onClick:u,text:s||m("confirm-dialog.confirm-button.fallback-text"),tone:p})]})})]})}function nG(e){let{dialog:t}=e,n=(0,a.useId)(),i=t.footer&&(0,o.jsx)(l.xu,{paddingX:4,paddingY:3,children:t.footer});return(0,o.jsx)(f.jr5,{zOffset:"fullscreen",children:(0,o.jsx)(l.Vq,{animate:!0,__unstable_hideCloseButton:!1===t.showCloseButton,footer:i,header:t.header,id:n,onClose:t.onClose,onClickOutside:t.onClose,width:void 0===t.width?1:nV[t.width],children:(0,o.jsx)(l.xu,{padding:4,children:t.content})})})}function nW(e){let{dialog:t,referenceElement:n}=e;return(0,o.jsx)(l.J2,{content:(0,o.jsx)(nK,{dialog:t}),fallbackPlacements:nB,open:!0,placement:"top",portal:!0,preventOverflow:!0,referenceElement:n})}function nK(e){let{dialog:t}=e,{content:n,onClose:i}=t,{isTopLayer:r}=(0,l.sJ)(),s=(0,a.useRef)(null),c=(0,a.useCallback)(e=>{"Escape"===e.key&&r&&i()},[r,i]);return(0,l.qh)(c),(0,l.Of)(r&&i,()=>[s.current]),(0,o.jsx)("div",{ref:s,children:n})}function nX(e){let{children:t}=e,{element:n,elements:i}=(0,l.vI)(),r=i?.[tQ]||n;return(0,o.jsx)(l.Xp,{element:r,children:t})}function nY(e){let{dialog:t,referenceElement:n=null}=e,i=(0,a.useId)();return"confirm"===t.type?(0,o.jsx)(nq,{dialog:t,referenceElement:n}):"popover"===t.type?(0,o.jsx)(nW,{dialog:t,referenceElement:n}):"dialog"!==t.type&&t.type?"custom"===t.type?(0,o.jsx)(nX,{children:t?.component}):(console.warn(`Unsupported modal type ${t.type}`),(0,o.jsx)(s.Vq,{id:i,onClose:t.onClose,onClickOutside:t.onClose,width:1,children:t.content||(0,o.jsxs)(l.xv,{size:1,children:["Unexpected modal type (",(0,o.jsx)("code",{children:t.type}),")"]})})):(0,o.jsx)(nX,{children:(0,o.jsx)(nG,{dialog:t})})}let nZ=(0,a.memo)(function({actionStates:e,children:t,referenceElement:n}){let[i,r]=(0,a.useState)(-1),s=(0,a.useMemo)(()=>e[i],[i,e]),l=(0,a.useCallback)(e=>{r(e)},[]),c=(0,a.useMemo)(()=>t({handleAction:l}),[t,l]);return(0,o.jsxs)(o.Fragment,{children:[s&&s.dialog&&(0,o.jsx)(f.jr5,{zOffset:"paneFooter",children:(0,o.jsx)(nY,{dialog:s.dialog,referenceElement:n})}),c]})});function nQ(e){let{actionStates:t,disabled:n}=e,i=(0,a.useId)(),[r,c]=(0,a.useState)(null),d=(0,a.useMemo)(()=>({placement:"top-end",portal:!0,preventOverflow:!0}),[]),{t:u}=(0,f.$G7)(ez),p=(0,a.useCallback)(({handleAction:e})=>(0,o.jsx)(s.j2,{id:`${i}-action-menu`,button:(0,o.jsx)(f.lXN,{"aria-label":u("buttons.action-menu-button.aria-label"),disabled:n,"data-testid":"action-menu-button",size:"large",tooltipProps:{content:u("buttons.action-menu-button.tooltip")}}),menu:(0,o.jsx)(l.v2,{padding:1,children:t.map((t,i)=>(0,o.jsx)(nJ,{actionState:t,disabled:n,index:i,onAction:e},i))}),popover:d,ref:c}),[t,n,i,d,u]);return(0,o.jsx)(nZ,{actionStates:t,referenceElement:r,children:p})}function nJ(e){let{actionState:t,disabled:n,index:i,onAction:r}=e,{onHandle:l}=t,c=(0,a.useCallback)(()=>{r(i),l&&l()},[i,r,l]),d=(0,a.useMemo)(()=>t.shortcut?String(t.shortcut).split("+").map(e=>e.slice(0,1).toUpperCase()+e.slice(1)):void 0,[t.shortcut]);return(0,o.jsx)(s.sN,{"data-testid":`action-${t.label.replace(" ","")}`,disabled:n||!!t.disabled,hotkeys:d,icon:t.icon,onClick:c,text:t.label,tone:t.tone,...t.disabled&&{tooltipProps:{content:t.title}}})}let n0={NOTHING_TO_DELETE:"action.delete.disabled.nothing-to-delete",NOT_READY:"action.delete.disabled.not-ready"},n1=({id:e,type:t,draft:n,onComplete:i})=>{let{setIsDeleting:r}=tG(),{delete:s}=(0,f.d9t)(e,t),[l,c]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1),{t:m}=(0,f.$G7)(ez),h=(0,a.useCallback)(()=>{p(!1),i()},[i]),x=(0,a.useCallback)(()=>{c(!0),p(!1),r(!0),s.execute(),i()},[s,i,r]),g=(0,a.useCallback)(()=>{p(!0)},[]),[y,b]=(0,f.hHf)({id:e,type:t,permission:"delete"}),j=(0,f.xJ)();return(0,a.useMemo)(()=>b||y?.granted?{tone:"critical",icon:d.XHJ,disabled:l||!!s.disabled||b,title:s.disabled&&m(n0[s.disabled])||"",label:m(l?"action.delete.running.label":"action.delete.label"),shortcut:"Ctrl+Alt+D",onHandle:g,dialog:u&&{type:"custom",component:(0,o.jsx)(e1,{action:"delete",id:n?._id||e,type:t,onCancel:h,onConfirm:x})}}:{tone:"critical",icon:d.XHJ,disabled:!0,label:m("action.delete.label"),title:(0,o.jsx)(f.FMn,{context:"delete-document",currentUser:j})},[j,s.disabled,n?._id,g,h,x,e,u,l,b,y?.granted,m,t])};n1.action="delete",n1.displayName="DeleteAction";let n2={NO_CHANGES:"action.discard-changes.disabled.no-change",NOT_PUBLISHED:"action.discard-changes.disabled.not-published",NOT_READY:"action.discard-changes.disabled.not-ready"},n8=({id:e,type:t,published:n,liveEdit:i,onComplete:r})=>{let{discardChanges:s}=(0,f.d9t)(e,t),[l,c]=(0,a.useState)(!1),[u,p]=(0,f.hHf)({id:e,type:t,permission:"discardDraft"}),m=(0,f.xJ)(),{t:h}=(0,f.$G7)(ez),x=(0,a.useCallback)(()=>{s.execute(),r()},[s,r]),g=(0,a.useCallback)(()=>{c(!0)},[]),y=(0,a.useMemo)(()=>l&&{type:"confirm",tone:"critical",onCancel:r,onConfirm:x,message:h("action.discard-changes.confirm-dialog.confirm-discard-changes")},[x,l,r,h]);return(0,a.useMemo)(()=>!n||i?null:p||u?.granted?{tone:"critical",icon:d.X5P,disabled:!!s.disabled||p,title:s.disabled&&n2[s.disabled]||"",label:h("action.discard-changes.label"),onHandle:g,dialog:y}:{tone:"critical",icon:d.X5P,disabled:!0,label:h("action.discard-changes.label"),title:(0,o.jsx)(f.FMn,{context:"discard-changes",currentUser:m})},[m,y,s.disabled,g,p,i,u?.granted,n,h])};n8.action="discardChanges",n8.displayName="DiscardChangesAction";let n3={NOTHING_TO_DUPLICATE:"action.duplicate.disabled.nothing-to-duplicate",NOT_READY:"action.duplicate.disabled.not-ready"},n4=({id:e,type:t,onComplete:n})=>{let i=(0,f.H__)(),{duplicate:r}=(0,f.d9t)(e,t),{navigateIntent:s}=(0,_.tv)(),[l,c]=(0,a.useState)(!1),[u,p]=(0,f.hHf)({id:e,type:t,permission:"duplicate"}),{t:m}=(0,f.$G7)(ez),h=(0,f.xJ)(),x=(0,a.useCallback)(async()=>{let o=(0,v.Z)();c(!0);let l=(0,L.z)(i.pair.operationEvents(e,t).pipe((0,P.h)(e=>"duplicate"===e.op&&"success"===e.type)));r.execute(o),await l,s("edit",{id:o,type:t}),n()},[i.pair,r,e,s,n,t]);return(0,a.useMemo)(()=>p||u?.granted?{icon:d.TIy,disabled:l||!!r.disabled||p,label:m(l?"action.duplicate.running.label":"action.duplicate.label"),title:r.disabled?m(n3[r.disabled]):"",onHandle:x}:{icon:d.TIy,disabled:!0,label:m("action.duplicate.label"),title:(0,o.jsx)(f.FMn,{context:"duplicate-document",currentUser:h})},[h,r.disabled,x,l,p,u?.granted,m])};n4.action="duplicate",n4.displayName="DuplicateAction";let n5=({id:e,type:t,revision:n,onComplete:i})=>{let{restore:r}=(0,f.d9t)(e,t),s=(0,f.E6V)(e,t),{navigateIntent:o}=(0,_.tv)(),l=(0,a.useRef)(s),[c,u]=(0,a.useState)(!1),{t:p}=(0,f.$G7)(ez),m=(0,a.useCallback)(()=>{r.execute(n),i()},[r,n,i]);(0,a.useEffect)(()=>{s&&s!==l.current&&("success"===s.type&&"restore"===s.op&&o("edit",{id:e,type:t}),l.current=s)},[s,e,o,t]);let h=(0,a.useCallback)(()=>{u(!0)},[]),x=(0,a.useMemo)(()=>c?{type:"confirm",tone:"critical",onCancel:i,onConfirm:m,message:p("action.restore.confirm.message")}:null,[m,c,i,p]),g="@initial"===n,y=void 0===n;return(0,a.useMemo)(()=>y?null:{label:p("action.restore.label"),color:"primary",onHandle:h,title:p(g?"action.restore.disabled.cannot-restore-initial":"action.restore.tooltip"),icon:d.vaD,dialog:x,disabled:g},[x,h,g,y,p])};n5.action="restore",n5.displayName="HistoryRestoreAction";let n7=(0,ed.dS)({name:"Document Published",version:1,description:'User clicked the "Publish" button in the document pane'}),n9={LIVE_EDIT_ENABLED:"action.publish.live-edit.publish-disabled",ALREADY_PUBLISHED:"action.publish.already-published.no-time-ago.tooltip",NO_CHANGES:"action.publish.no-changes.tooltip",NOT_READY:"action.publish.disabled.not-ready"};function n6({publishedAt:e}){let{t}=(0,f.$G7)(ez),n=(0,f.ofl)(e,{useTemporalPhrase:!0});return(0,o.jsx)("span",{children:t("action.publish.already-published.tooltip",{timeSincePublished:n})})}let ie=e=>{var t,n;let{id:i,type:r,liveEdit:s,draft:l,published:c}=e,[u,p]=(0,a.useState)(null),{publish:m}=(0,f.d9t)(i,r),h=(0,f.a3k)(i,r),g=(0,f.nuD)(i,r),{changesOpen:y,onHistoryOpen:b,documentId:j,documentType:v}=tG(),w=(0,f.iav)(j,v),{t:C}=(0,f.$G7)(ez),_=(w?.draft||w?.published||{})._rev,k=h.validation.some(x.YN),[I,E]=(0,a.useState)(!1),T=g.isSyncing,S=h.isValidating,[z,$]=(0,f.hHf)({id:i,type:r,permission:"publish"}),M=(0,f.xJ)(),D=m.disabled?(t=m.disabled,n=(c||{})._updatedAt,("ALREADY_PUBLISHED"===t&&n?(0,o.jsx)(n6,{publishedAt:n}):C(n9[t]))||""):k?C("action.publish.validation-issues.tooltip"):"",R=!!l,L=(0,a.useCallback)(()=>{m.execute(),p("publishing")},[m]);(0,a.useEffect)(()=>{let e=!1===h.isValidating&&h.revision!==_;I&&!T&&e&&(k||L(),E(!1))},[T,L,k,I,h.revision,_,S,h.isValidating]),(0,a.useEffect)(()=>{let e="publishing"===u&&!R;e&&y&&b();let t=e?"published":null,n=setTimeout(()=>{p(t)},e?200:4e3);return()=>clearTimeout(n)},[y,u,R,b]);let P=(0,ea.f1)(),A=(0,a.useCallback)(()=>{P.log(n7,{publishedImmediately:!l?._createdAt,previouslyPublished:!!c}),g.isSyncing||h.isValidating||h.revision!==_?E(!0):L()},[P,l?._createdAt,c,g.isSyncing,h.isValidating,h.revision,_,L]);return(0,a.useMemo)(()=>{if(s)return{tone:"default",icon:d.EI4,label:C("action.publish.live-edit.label"),title:C("action.publish.live-edit.tooltip"),disabled:!0};if(!$&&!z?.granted)return{tone:"default",icon:d.EI4,label:"Publish",title:(0,o.jsx)(f.FMn,{context:"publish-document",currentUser:M}),disabled:!0};let e=!!(I||w?.transactionSyncLock?.enabled||"publishing"===u||"published"===u||k||m.disabled);return{disabled:e||$,tone:"default",label:C("published"===u?"action.publish.published.label":I||"publishing"===u?"action.publish.running.label":"action.publish.draft.label"),icon:d.EI4,title:I?C("action.publish.waiting"):"published"===u||"publishing"===u?null:D,shortcut:e||I?null:"Ctrl+Alt+P",onHandle:A}},[M,w?.transactionSyncLock?.enabled,A,k,$,s,z?.granted,m.disabled,I,u,C,D])};ie.action="publish",ie.displayName="PublishAction";let it={NOT_PUBLISHED:"action.unpublish.disabled.not-published",NOT_READY:"action.unpublish.disabled.not-ready",LIVE_EDIT_ENABLED:"action.unpublish.disabled.live-edit-enabled"},ii=({id:e,type:t,draft:n,onComplete:i,liveEdit:r})=>{let{unpublish:s}=(0,f.d9t)(e,t),[l,c]=(0,a.useState)(!1),[u,p]=(0,f.hHf)({id:e,type:t,permission:"unpublish"}),m=(0,f.xJ)(),{t:h}=(0,f.$G7)(ez),x=(0,a.useCallback)(()=>{c(!1),i()},[i]),g=(0,a.useCallback)(()=>{c(!1),s.execute(),i()},[i,s]),y=(0,a.useMemo)(()=>l?{type:"dialog",onClose:i,content:(0,o.jsx)(e1,{id:n?._id||e,type:t,action:"unpublish",onCancel:x,onConfirm:g})}:null,[n,e,x,g,l,i,t]);return(0,a.useMemo)(()=>r?null:p||u?.granted?{tone:"critical",icon:d.xEY,disabled:!!s.disabled||p,label:h("action.unpublish.label"),title:s.disabled?h(it[s.disabled]):"",onHandle:()=>c(!0),dialog:y}:{tone:"critical",icon:d.xEY,label:"Unpublish",title:(0,o.jsx)(f.FMn,{context:"unpublish-document",currentUser:m}),disabled:!0},[m,y,p,r,u?.granted,h,s.disabled])};ii.action="unpublish",ii.displayName="UnpublishAction";let ir=(0,a.memo)(function(e){let{disabled:t,showMenu:n,states:i}=e,{__internal_tasks:r}=tG(),[c,...d]=i,[u,p]=(0,a.useState)(null),m=(0,a.useMemo)(()=>c&&(c.title||c.shortcut)?(0,o.jsxs)(l.kC,{style:{maxWidth:300},align:"center",gap:3,children:[c.title&&(0,o.jsx)(l.xv,{size:1,children:c.title}),c.shortcut&&(0,o.jsx)(s.p8,{"data-testid":"document-status-bar-hotkeys",fontSize:1,style:{marginTop:-4,marginBottom:-4},keys:String(c.shortcut).split("+").map(e=>e.slice(0,1).toUpperCase()+e.slice(1).toLowerCase())})]}):null,[c]);return(0,o.jsxs)(l.kC,{align:"center",gap:1,children:[r&&r.footerAction,c&&(0,o.jsx)(l.li,{zOffset:200,children:(0,o.jsx)(s.u,{disabled:!m,content:m,placement:"top",children:(0,o.jsx)(l.Kq,{children:(0,o.jsx)(s.zx,{"data-testid":`action-${c.label}`,disabled:t||!!c.disabled,icon:c.icon,onClick:c.onHandle,ref:p,size:"large",text:c.label,tone:c.tone||"primary"})})})}),n&&d.length>0&&(0,o.jsx)(nQ,{actionStates:d,disabled:t}),c&&c.dialog&&(0,o.jsx)(nY,{dialog:c.dialog,referenceElement:u})]})}),is=(0,a.memo)(function(){let{actions:e,connectionState:t,documentId:n,editState:i}=tG(),r=(0,a.useMemo)(()=>(e??[]).filter(e=>!il(e)),[e]),s=(0,a.useCallback)(({states:e})=>(0,o.jsx)(ir,{disabled:"connected"!==t,showMenu:r.length>1,states:e},n),[r.length,t,n]);return 0!==r.length&&i?(0,o.jsx)(tU,{actions:r,actionProps:i,group:"default",children:s}):null}),io=(0,a.memo)(function(){let{actions:e,connectionState:t,editState:n,timelineStore:i}=tG(),r=f.P08(i,e=>e.revTime)?.id||"",s=(n?.draft||n?.published||{})._rev===r,l=(0,a.useMemo)(()=>({...n||{},revision:r}),[n,r]),c=(0,a.useMemo)(()=>(e??[]).filter(il).slice(-1),[e]),d=(0,a.useCallback)(({states:e})=>(0,o.jsx)(ir,{disabled:"connected"!==t||!!s,showMenu:!1,states:e}),[t,s]);return(0,o.jsx)(tU,{actions:c,actionProps:l,group:"default",children:d})});function il(e){return e.action===n5.action}let ia={create:d.agZ,delete:d.XHJ,discardDraft:d.Two,initial:d.agZ,editDraft:d.dY8,editLive:d.dY8,publish:d.EI4,unpublish:d.xEY},ic=(0,w.zo)(l.Kq)`
  max-width: 200px;
`,id=(0,w.zo)(l.kC)`
  max-height: calc(100vh - 198px);
  min-width: 244px;
`,iu=(0,w.zo)(l.xu)(({$visible:e})=>(0,w.iv)`
    opacity: 0;
    pointer-events: none;

    ${e&&(0,w.iv)`
      opacity: 1;
      pointer-events: auto;
    `}
  `),ip={initial:"timeline.operation.created-initial",create:"timeline.operation.created",publish:"timeline.operation.published",editLive:"timeline.operation.edited-live",editDraft:"timeline.operation.edited-draft",unpublish:"timeline.operation.unpublished",discardDraft:"timeline.operation.draft-discarded",delete:"timeline.operation.deleted"},im=(0,w.zo)(l.kC)(({theme:e})=>{let t=e.sanity.color.base.skeleton?.from;return(0,w.iv)`
    --timeline-hairline-width: 1px;
    position: relative;
    z-index: 2;
    margin: 0;
    padding: 0;

    &::before {
      position: absolute;
      content: '';
      height: 100%;
      width: var(--timeline-hairline-width);
      background: ${t};
      top: 0;
      left: calc((100% - var(--timeline-hairline-width)) / 2);
      z-index: 1;
    }
  `}),ih=(0,w.zo)(l.zx)(({$selected:e,$disabled:t})=>(0,w.iv)`
    position: relative;
    width: 100%;

    /* Line styling */
    &[data-first] ${im}::before {
      height: 50%;
      top: unset;
      bottom: 0;
    }

    &[data-last] ${im}::before {
      height: 50%;
    }

    ${e&&(0,w.iv)`
      ${im}::before {
        background: transparent;
      }
    `}

    ${t&&(0,w.iv)`
      cursor: not-allowed;
    `}
  `),ix=(0,w.zo)(l.xu)`
  background: var(--card-bg-color);
  border-radius: 50px;
  position: relative;
  z-index: 2;
`,ig=(0,w.zo)(l.xu)`
  min-width: 1rem;
  margin-left: ${({theme:e})=>`-${(0,l.hO)(e.sanity.space[1])}`};
`;function iy({maxLength:e,userIds:t}){return(0,o.jsx)(l.Jh,{maxLength:e,children:t.map(e=>(0,o.jsx)(f.YtX,{user:e,withTooltip:!0},e))})}let ib={initial:"primary",create:"primary",publish:"positive",editLive:"caution",editDraft:"caution",unpublish:"critical",discardDraft:"critical",delete:"critical",withinSelection:"primary"};function ij({chunk:e,isFirst:t,isLast:n,isLatest:i,isSelected:r,onSelect:s,timestamp:c,type:d}){let{t:u}=(0,f.$G7)("studio"),p=ia[d],m=Array.from(e.authors),h="delete"!==d,x=(0,f.P9l)({dateStyle:"medium",timeStyle:"short"}),g=(0,a.useMemo)(()=>{let e=new Date(c);return x.format(e)},[c,x]),y=(0,a.useCallback)(t=>{t.preventDefault(),t.stopPropagation(),h&&s(e)},[s,e,h]);return(0,o.jsx)(ih,{$selected:r,$disabled:!h,"data-testid":"timeline-item-button","data-chunk-id":e.id,"data-first":!!t||void 0,"data-last":!!n||void 0,"data-ui":"timelineItem",mode:r?"default":"bleed",onClick:y,padding:0,radius:2,tone:r?"primary":ib[e.type],children:(0,o.jsx)(l.xu,{paddingX:2,children:(0,o.jsxs)(l.kC,{align:"stretch",children:[(0,o.jsx)(im,{align:"center",children:(0,o.jsx)(ix,{padding:2,children:(0,o.jsx)(l.xv,{size:2,children:p&&(0,a.createElement)(p)})})}),(0,o.jsxs)(l.Kq,{space:2,margin:2,children:[i&&(0,o.jsx)(l.kC,{children:(0,o.jsx)(l.Zb,{padding:1,radius:2,shadow:1,tone:r?"primary":ib[e.type],children:(0,o.jsx)(l.xv,{muted:!0,size:0,weight:"medium",children:u("timeline.latest")})})}),(0,o.jsx)(l.xu,{children:(0,o.jsx)(l.xv,{size:1,weight:"medium",children:u(ip[d])||(0,o.jsx)("code",{children:d})})}),(0,o.jsx)(ig,{paddingX:1,children:(0,o.jsx)(l.xv,{as:"time",size:0,muted:!0,dateTime:c,children:g})})]}),(0,o.jsx)(l.kC,{flex:1,justify:"flex-end",align:"center",children:(0,o.jsx)(iy,{maxLength:3,userIds:m})})]})})})}let iv=({chunks:e,disabledBeforeFirstChunk:t,hasMoreChunks:n,lastChunk:i,onLoadMore:r,onSelect:s,firstChunk:c})=>{let[d,u]=(0,a.useState)(!1),{t:p}=(0,f.$G7)("studio"),m=(0,a.useMemo)(()=>e.filter(e=>!t||!c||e.index<c.index),[e,t,c]),h=(0,a.useMemo)(()=>i?.id?m.findIndex(e=>e.id===i.id):-1,[i?.id,m]),x=(0,a.useCallback)((e,{activeIndex:i})=>{let r=0===i,a=m&&i===m.length-1||!1;return(0,o.jsxs)(l.xu,{paddingBottom:a?1:0,paddingTop:r?1:0,paddingX:1,children:[(0,o.jsx)(ij,{chunk:e,isFirst:r,isLast:a,isLatest:0===i&&!t,isSelected:i===h,onSelect:s,timestamp:e.endTimestamp,type:e.type}),i===m.length-1&&n&&(0,o.jsx)(f.Bwn,{})]})},[t,m,n,s,h]);return(0,a.useEffect)(()=>u(!0),[]),(0,o.jsxs)(iu,{$visible:!h||d,"data-ui":"timeline",children:[0===m.length&&(0,o.jsxs)(ic,{padding:3,space:3,children:[(0,o.jsx)(l.xv,{size:1,weight:"medium",children:p("timeline.error.no-document-history-title")}),(0,o.jsx)(l.xv,{muted:!0,size:1,children:p("timeline.error.no-document-history-description")})]}),m.length>0&&(0,o.jsx)(id,{direction:"column",children:(0,o.jsx)(f.e8h,{activeItemDataAttr:"data-hovered",ariaLabel:p("timeline.list.aria-label"),autoFocus:"list",initialIndex:h,initialScrollAlign:"center",itemHeight:40,items:m,onEndReached:r,onEndReachedIndexOffset:20,overscan:5,renderItem:x,wrapAround:!1})})]})};function iw(){let{t:e}=(0,f.$G7)("studio");return(0,o.jsxs)(l.kC,{align:"flex-start",gap:3,padding:4,children:[(0,o.jsx)(f.LPT,{tone:"critical",children:(0,o.jsx)(d.uIy,{})}),(0,o.jsxs)(l.Kq,{space:4,children:[(0,o.jsx)(f.LPT,{size:1,tone:"critical",weight:"medium",children:e("timeline.error.load-document-changes-title")}),(0,o.jsx)(f.LPT,{size:1,tone:"critical",children:e("timeline.error.load-document-changes-description")})]})]})}iv.displayName="Timeline";let iC=(0,w.zo)(s.J2)`
  overflow: hidden;
  overflow: clip;
`;function i_({chunk:e,mode:t,placement:n}){let{setTimelineRange:i,setTimelineMode:r,timelineError:c,ready:u,timelineStore:p}=tG(),[m,h]=(0,a.useState)(!1),[x,g]=(0,a.useState)(null),y=(0,a.useRef)(null),b=(0,l.pm)(),j=(0,f.P08)(p,e=>e.chunks),v=(0,f.P08)(p,e=>e.isLoading),w=(0,f.P08)(p,e=>e.hasMoreChunks),C=(0,f.P08)(p,e=>e.realRevChunk),_=(0,f.P08)(p,e=>e.sinceTime),{t:k}=(0,f.$G7)("studio"),I=(0,a.useCallback)(()=>{r(t),h(!0)},[t,r]),E=(0,a.useCallback)(()=>{r("closed"),h(!1)},[r]),T=(0,a.useCallback)(e=>{m&&("Escape"===e.key||"Tab"===e.key)&&(E(),x?.focus())},[x,E,m]);(0,l.qh)(T),(0,l.Of)(m&&E,()=>[x,y.current]);let S=(0,a.useCallback)(e=>{try{let[t,n]=p.findRangeForRev(e);r("closed"),i(t,n)}catch(e){b.push({closable:!0,description:e.message,status:"error",title:k("timeline.error.unable-to-load-revision")})}},[r,i,k,p,b]),z=(0,a.useCallback)(e=>{try{let[t,n]=p.findRangeForSince(e);r("closed"),i(t,n)}catch(e){b.push({closable:!0,description:e.message,status:"error",title:k("timeline.error.unable-to-load-revision")})}},[r,i,k,p,b]),$=(0,a.useCallback)(()=>{v||p.loadMore()},[v,p]),M=c?(0,o.jsx)(iw,{}):(0,o.jsxs)(o.Fragment,{children:["rev"===t&&(0,o.jsx)(iv,{chunks:j,firstChunk:C,hasMoreChunks:w,lastChunk:C,onLoadMore:$,onSelect:S}),"since"===t&&(0,o.jsx)(iv,{chunks:j,disabledBeforeFirstChunk:!0,firstChunk:C,hasMoreChunks:w,lastChunk:_,onLoadMore:$,onSelect:z})]}),D={timestamp:{dateStyle:"medium",timeStyle:"short"}},R=e?k(ip[e.type],{context:"timestamp",timestamp:new Date(e?.endTimestamp),formatParams:D}):k("timeline.latest-revision"),L=e?k("timeline.since",{timestamp:new Date(e?.endTimestamp),formatParams:D}):k("timeline.since-version-missing");return(0,o.jsx)(iC,{"data-testid":"timeline-menu",constrainSize:!0,content:m&&M,"data-ui":"versionMenu",open:m,placement:n,portal:!0,ref:y,children:(0,o.jsx)(s.zx,{"data-testid":m?"timeline-menu-close-button":"timeline-menu-open-button",disabled:!u,mode:"bleed",iconRight:d.v4q,onClick:m?E:I,ref:g,selected:m,style:{maxWidth:"100%"},text:u?"rev"===t?R:L:k("timeline.loading-history")})})}function ik(){let{activeViewId:e,paneKey:t,views:n}=tG(),i=`${t}tabpanel`;return(0,o.jsx)(l.td,{space:1,children:n.map((n,r)=>(0,o.jsx)(iI,{icon:n.icon,id:`${t}tab-${n.id}`,isActive:e===n.id,label:n.title,tabPanelId:i,viewId:0===r?null:n.id??null},n.id))})}function iI(e){let{icon:t,id:n,isActive:i,label:r,tabPanelId:l,viewId:c,...d}=e,{ready:u,editState:p}=tG(),{setView:m}=eF(),h=(0,a.useCallback)(()=>m(c),[m,c]);return(0,o.jsx)(s.OK,{...d,"aria-controls":l,disabled:!u&&!p?.draft&&!p?.published,icon:t,id:n,label:r,onClick:h,selected:i})}function iE(){let{connectionState:e,schemaType:t,title:n,editState:i}=tG(),r=i?.draft||i?.published,s=!!r,{error:l,value:a}=(0,f._2T)({enabled:s,schemaType:t,value:r}),{t:c}=(0,f.$G7)(ez);return"connecting"!==e||s?n?(0,o.jsx)(o.Fragment,{children:n}):r?l?(0,o.jsx)(o.Fragment,{children:c("panes.document-header-title.error.text",{error:l.message})}):(0,o.jsx)(o.Fragment,{children:a?.title||(0,o.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:c("panes.document-header-title.untitled.text")})}):(0,o.jsx)(o.Fragment,{children:c("panes.document-header-title.new.text",{schemaType:t?.title||t?.name})}):(0,o.jsx)(o.Fragment,{})}let iT=(0,a.memo)((0,a.forwardRef)(function(e,t){let{menuItems:n}=e,{actions:i,editState:r,onMenuAction:c,onPaneClose:u,onPaneSplit:p,menuItemGroups:m,schemaType:h,timelineStore:x,connectionState:g,views:y,unstable_languageFilter:b}=tG(),{features:j}=tJ(),{index:v,BackLink:w,hasGroupSiblings:C}=eF(),{actions:_}=(0,f.qGk)(),[k,I]=(0,a.useState)(null),E=(0,a.useMemo)(()=>(i??[]).filter(e=>!il(e)),[i]),T=(0,a.useMemo)(()=>tT({actionHandler:c,fieldActions:_,menuItems:n,menuItemGroups:m}),[c,_,m,n]),S=(0,a.useMemo)(()=>T.filter(tI),[T]),z=(0,a.useMemo)(()=>T.filter(tE),[T]),$=y.length>1,M=(0,f.P08)(x,e=>e.revTime),{collapsed:D,isLast:R}=e9(),L=j.splitViews&&p&&y.length>1,P=L&&C,A=j.backButton&&v>0,O=!P&&!A&&!!w,{t:N}=(0,f.$G7)(ez),U=(0,a.useCallback)(({states:e})=>(0,o.jsx)(iS,{contextMenuNodes:z,setReferenceElement:I,referenceElement:k,states:e}),[z,k]);return(0,o.jsx)(s.uE,{children:(0,o.jsx)(tg,{border:!0,ref:t,loading:"connecting"===g&&!r?.draft&&!r?.published,title:(0,o.jsx)(iE,{}),tabs:$&&(0,o.jsx)(ik,{}),tabIndex:R&&!D?-1:0,backButton:A&&(0,o.jsx)(s.zx,{as:w,"data-as":"a",icon:d.Y4O,mode:"bleed",tooltipProps:{content:N("pane-header.back-button.text")}}),subActions:(0,o.jsx)(i_,{chunk:M,mode:"rev",placement:"bottom-end"}),actions:(0,o.jsxs)(l.kC,{align:"center",gap:1,children:[b.length>0&&(0,o.jsx)(o.Fragment,{children:b.map((e,t)=>(0,a.createElement)(e,{key:`language-filter-${t}`,schemaType:h}))}),S.map(e=>(0,o.jsx)(tb,{node:e},e.key)),r&&(0,o.jsx)(tU,{actions:E,actionProps:r,group:"paneActions",children:U}),L&&(0,o.jsx)(s.zx,{"aria-label":N("buttons.split-pane-button.aria-label"),icon:d.iro,mode:"bleed",onClick:p,tooltipProps:{content:N("buttons.split-pane-button.tooltip")}},"split-pane-button"),P&&(0,o.jsx)(s.zx,{icon:d.Two,mode:"bleed",onClick:u,tooltipProps:{content:N("buttons.split-pane-close-button.title")}},"close-view-button"),O&&(0,o.jsx)(s.zx,{icon:d.Two,mode:"bleed",tooltipProps:{content:N("buttons.split-pane-close-group-button.title")},as:w},"close-view-button")]})})})})),iS=(0,a.memo)(function(e){let{setReferenceElement:t,referenceElement:n,contextMenuNodes:i}=e,r=(0,a.useDeferredValue)(e.states);return(0,o.jsx)(iz,{setReferenceElement:t,referenceElement:n,contextMenuNodes:i,states:r})}),iz=(0,a.memo)(function(e){let{states:t,setReferenceElement:n,contextMenuNodes:i,referenceElement:r}=e,s=(0,a.useCallback)(({handleAction:e})=>(0,o.jsx)("div",{ref:n,children:(0,o.jsx)(tl,{nodes:i,actionsNodes:t.length>0?t.map((t,n)=>(0,o.jsx)(nJ,{actionState:t,disabled:!!t.disabled,index:n,onAction:e},t.label)):void 0},"context-menu")}),[i,n,t]);return(0,o.jsx)(nZ,{actionStates:t,referenceElement:r,children:s})});function i$({size:e}){return(0,o.jsx)(s.zx,{"aria-hidden":!0,disabled:!0,size:e,style:{pointerEvents:"none",visibility:"hidden",width:0},text:"-"})}let iM={primary:"primary",success:"positive",warning:"caution",danger:"critical"},iD=(0,a.memo)(function({states:e}){return 0===e.length?null:(0,o.jsx)(l.gF,{space:1,children:e.map((e,t)=>(0,o.jsx)(s.u,{content:e.title,disabled:!e.title,placement:"top",portal:!0,children:(0,o.jsx)(l.Ct,{fontSize:1,mode:"outline",paddingX:2,paddingY:1,radius:4,tone:e.color?iM[e.color]:void 0,style:{whiteSpace:"nowrap"},children:e.label})},`${e.label}-${t}`))})}),iR=(0,a.memo)(function(e){let t=(0,a.useDeferredValue)(e.states);return(0,o.jsx)(iD,{states:t})});function iL(){let{badges:e,editState:t}=tG(),n=(0,a.useCallback)(({states:e})=>(0,o.jsx)(iR,{states:e}),[]);return t&&e?(0,o.jsx)(tH,{badges:e,badgeProps:t,children:n}):null}let iP=(0,w.zo)(eh.E.path)`
  transform-origin: center;
`,iA=e=>(0,o.jsx)(eh.E.circle,{fill:"none",r:"8",cx:"12.5",cy:"12.5",strokeWidth:"1.2",...e}),iO=e=>(0,o.jsx)(iP,{fill:"none",d:"M14 17.5619L11.5 20.5L14.5 23.0619M11 7.43811L13.5 4.50001L10.5 1.93811",...e}),iN=e=>(0,o.jsx)(eh.E.path,{d:"M9.5 12.1316L11.7414 14.5L16 10",...e}),iU=(0,w.F4)`
  0% {
    transform: rotate(0);
  }
  100% {
    transform: rotate(360deg);
  }
`,iH=w.zo.g`
  transform-origin: center;

  &[data-rotate] {
    animation: ${iU} 1s ease-in-out infinite;
  }
`,iB={syncing:{scale:1,transition:{duration:0}},saved:{scale:[1,.8,1.2,.9,1.1,.95,1.05,.99,1],transition:{duration:.5,delay:.2}},changes:{transition:{duration:0}}},iV={syncing:{strokeDasharray:"0, 0, 23, 3, 23, 3",strokeDashoffset:10,opacity:1,transition:{duration:0}},saved:{strokeDasharray:"0, 0, 23, 0, 23, 0",strokeDashoffset:10,opacity:1,transition:{duration:.2}},changes:{strokeDasharray:"0, 60, 23, 0, 23, 0",strokeDashoffset:0,opacity:0,transition:{duration:.5}}},iq={syncing:{opacity:1,transition:{duration:0}},saved:{opacity:0,transition:{duration:.2}},changes:{opacity:0}},iF={syncing:{pathLength:0,transition:{duration:0}},saved:{pathLength:1,transition:{delay:.4,duration:.3}},changes:{pathLength:0,transition:{duration:.2}}};function iG(e){let{status:t}=e;return t?(0,o.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",stroke:"currentColor",strokeWidth:"1.2","data-sanity-icon":"animated-status-icon",children:(0,o.jsxs)(eh.E.g,{variants:iB,initial:t,animate:t,children:[(0,o.jsxs)(iH,{"data-rotate":"changes"===t?void 0:"",children:[(0,o.jsx)(iO,{variants:iq,initial:t,animate:t}),(0,o.jsx)(iA,{variants:iV,initial:t,animate:t})]}),(0,o.jsx)(iN,{variants:iF,initial:t,animate:t})]})}):null}let iW={saved:{i18nKey:"status-bar.document-status-pulse.status.saved.text",tone:"positive"},syncing:{i18nKey:"status-bar.document-status-pulse.status.syncing.text",tone:"default"}},iK=e=>{let{status:t}=e,{t:n}=(0,f.$G7)(ez);if("saved"!==t&&"syncing"!==t)return null;let i=iW[t];return(0,o.jsxs)(l.kC,{align:"center",gap:2,"data-testid":"pane-footer-document-status-pulse",children:[(0,o.jsx)(f.LPT,{size:1,tone:i.tone,children:(0,o.jsx)(iG,{status:t})}),(0,o.jsx)(l.xv,{muted:!0,size:1,children:n(i.i18nKey)})]})};function iX({singleLine:e}){let{documentId:t,documentType:n,editState:i,value:r}=tG(),[c,d]=(0,a.useState)(null),u=(0,f.nuD)(t,n),p=r?._updatedAt;return(0,a.useEffect)(()=>{if("syncing"===c&&!u.isSyncing){let e=setTimeout(()=>d("saved"),1e3);return()=>clearTimeout(e)}if("saved"===c){let e=setTimeout(()=>d(null),3e3);return()=>clearTimeout(e)}},[c,p,u.isSyncing]),(0,a.useLayoutEffect)(()=>{d(null)},[t]),(0,a.useLayoutEffect)(()=>{u.isSyncing&&d("syncing")},[u.isSyncing,p]),c?(0,o.jsx)(iK,{status:c||void 0}):(0,o.jsx)(s.u,{content:(0,o.jsx)(f._mO,{absoluteDate:!0,draft:i?.draft,published:i?.published}),placement:"top",children:(0,o.jsxs)(l.kC,{align:"center",gap:3,children:[(0,o.jsx)(f.aAo,{draft:i?.draft,published:i?.published}),(0,o.jsx)(f._mO,{draft:i?.draft,published:i?.published,singleLine:e})]})})}function iY(e){let{actionsBoxRef:t,createLinkMetadata:n}=e,{editState:i,timelineStore:r,onChange:s}=tG(),{title:c}=t4(),d=f.opE().components?.documentLinkedActions,u=(0,f.P08)(r,e=>e.onOlderRevision),[p,m]=(0,a.useState)(null),[h,x]=(0,a.useState)(null);!function({element:e,onResize:t}){(0,a.useLayoutEffect)(()=>(e&&f.x$w.observe(e,t),()=>{e&&f.x$w.unobserve(e)}),[e,t])}({element:h,onResize:(0,a.useCallback)(e=>{m(e.contentRect.width<480)},[])});let g=i?.ready&&"boolean"==typeof p,y=null;return y=n&&(0,f.EM_)(n)&&d?(0,o.jsx)(d,{metadata:n,panelPortalElementId:tQ,onDocumentChange:s,documentTitle:c}):u?(0,o.jsx)(io,{}):(0,o.jsx)(is,{}),(0,o.jsx)(l.kC,{direction:"column",ref:x,sizing:"border",children:g&&(0,o.jsxs)(l.kC,{align:"stretch",gap:1,justify:"space-between",paddingY:2,paddingLeft:4,paddingRight:3,children:[(0,o.jsxs)(l.kC,{align:"center",flex:1,gap:p?2:3,wrap:"wrap",paddingRight:3,children:[(0,o.jsxs)(l.kC,{align:"center",children:[(0,o.jsx)(iX,{singleLine:!p}),(0,o.jsx)(i$,{size:"large"})]}),(0,o.jsx)(iL,{})]}),(0,o.jsxs)(l.kC,{align:"flex-start",justify:"flex-end",ref:t,style:{flexShrink:0,marginLeft:"auto"},children:[(0,o.jsx)(i$,{size:"large"}),y]})]})})}let iZ=(0,a.memo)(function(e){let{actionsBoxElement:t,activeIndex:n,as:i="div",children:r,id:s,onActionStart:l,onKeyDown:c,rootRef:d,states:u,...p}=e,m=u[n],h=(0,a.useCallback)(e=>{let t=u.filter(t=>t.shortcut&&(0,er.P6)(t.shortcut,e)),n=t[0];if(t.length>1&&console.warn(`Keyboard shortcut conflict: More than one document action matches the shortcut "${n.shortcut}"`),n&&!n.disabled&&n.onHandle){e.preventDefault(),n.onHandle(),l(u.indexOf(n));return}c&&c(e)},[l,c,u]);return(0,a.createElement)(i,{id:s,onKeyDown:h,tabIndex:-1,...p,ref:d},[r,m&&m.dialog&&(0,o.jsx)(f.jr5,{zOffset:"paneFooter",children:(0,o.jsx)(nY,{dialog:m.dialog,referenceElement:t})})])}),iQ=(0,a.memo)(e=>{let{actionsBoxElement:t,as:n="div",children:i,...r}=e,{actions:s,editState:l}=tG(),[c,d]=(0,a.useState)(-1),u=(0,a.useCallback)(e=>{d(e)},[]),p=(0,a.useMemo)(()=>l&&{...l,onComplete:()=>{},revision:void 0},[l]),m=(0,a.useCallback)(({states:e})=>(0,o.jsx)(iZ,{...r,activeIndex:c,actionsBoxElement:t,as:n,onActionStart:u,states:e,children:i}),[t,c,n,i,u,r]);return p&&s?(0,o.jsx)(tU,{actionProps:p,actions:s,children:m}):null});iQ.displayName="Memo(DocumentActionShortcuts)";let iJ=e=>(0,f.Uy$)(e)&&"string"==typeof e._id&&"string"==typeof e._type;function i0(e){let{resolveProductionUrl:t}=(0,f.Lky)().document,n=(0,a.useMemo)(()=>new A.X(void 0),[]);(0,a.useEffect)(()=>{n.next(e)},[n,e]);let i=(0,a.useMemo)(()=>n.asObservable().pipe((0,X.x)(),(0,ee.b)(500),(0,Y.w)(e=>iJ(e)?(0,O.D)(t({document:e})):(0,S.of)(void 0)),(0,X.x)(),(0,D.K)(e=>{let t=(0,f.Uy$)(e)&&"string"==typeof e.message?e.message:"Unknown error";throw Error(`An error was thrown while trying to get your preview url: ${t}`)})),[t,n]);return(0,ec.m)(i)}function i1(e){let{documentType:t,value:n,currentMinWidth:i,paneKey:r,minWidth:s}=e,{t:a}=(0,f.$G7)();return(0,o.jsx)(tB,{currentMinWidth:i,flex:2.5,minWidth:s,paneKey:r,title:(0,o.jsx)(f.vNl,{t:a,i18nKey:"panes.document-pane.document-unknown-type.title",values:{documentType:t}}),tone:"caution",children:(0,o.jsxs)(l.Kq,{space:4,children:[t&&(0,o.jsx)(l.xv,{as:"p",children:(0,o.jsx)(f.vNl,{t:a,i18nKey:"panes.document-pane.document-unknown-type.text",values:{documentType:t}})}),!t&&(0,o.jsx)(l.xv,{as:"p",children:a("panes.document-pane.document-unknown-type.without-schema.text")}),f.r8Q&&n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.xv,{as:"p",children:"Here is the JSON representation of the document:"}),(0,o.jsx)(l.Zb,{padding:3,overflow:"auto",radius:2,shadow:1,tone:"inherit",children:(0,o.jsx)(l.EK,{language:"json",size:[1,1,2],children:JSON.stringify(n,null,2)})})]})]})})}let i2=[],i8=["fixed","fixed","absolute"],i3=(0,w.zo)(f.jbM)`
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
  min-width: 0;
`;function i4(){let{changesOpen:e,documentId:t,documentType:n,fieldActions:i,focusPath:r,inspectOpen:c,inspector:u,inspectors:p,onFocus:m,onHistoryOpen:h,onMenuAction:x,onPathOpen:g,paneKey:y,schemaType:b,value:j}=tG(),{features:v}=tJ(),{t:w}=(0,es.$G)(ez),{collapsed:C}=eH(),_=(0,f.Cnp)(),k=i0(j),I=(0,f.xaJ)(j),E=f.opE().components?.documentLinkedBannerContent,[T,S]=(0,a.useState)(null),[z,$]=(0,a.useState)(null),[M,D]=(0,a.useState)(null),[R,L]=(0,a.useState)(null),[P,A]=(0,a.useState)(null);(0,f.LxO)({element:T,focusPath:r,value:j});let[O,N]=(0,a.useState)([]),[U,H]=(0,a.useState)([]),B=(0,l.XL)(z),V=(0,l.XL)(M),q=B?.height,F=V?.height,G=600+(u?320:0),W=320+(u?320:0),K=(0,a.useMemo)(()=>p?.find(e=>e.name===u?.name),[p,u?.name]),X=!!j,Y=(0,a.useMemo)(()=>(function(e){let t=function({currentInspector:e,hasValue:t,inspectors:n,inspectorMenuItems:i}){return n.map((n,r)=>{let s=i[r];return!s||s.hidden?null:{action:`${t1}${n.name}`,group:s.showAsAction?void 0:"inspectors",icon:s.icon,isDisabled:!t,selected:e?.name===n.name,shortcut:s.hotkeys?.join("+"),showAsAction:s.showAsAction,title:s.title,tone:s.tone}}).filter(Boolean)}(e),n=[function({previewUrl:e,t}){return e?{action:"production-preview",group:"links",title:t("production-preview.menu-item.title"),icon:d.YE8,shortcut:"Ctrl+Alt+O"}:null}(e)].filter(Boolean);return[{action:"copy-document-url",showAsAction:!0,title:e.t("action.copy-document-url.label"),icon:d.xPt},...t,function({hasValue:e,t}){return{action:"inspect",group:"inspectors",title:t("document-inspector.menu-item.title"),icon:d.Pr8,isDisabled:!e,shortcut:"Ctrl+Alt+I"}}(e),...n]})({currentInspector:K,features:v,hasValue:X,inspectorMenuItems:O,inspectors:p,previewUrl:k,t:w}),[K,v,X,O,p,k,w]),Z=(0,a.useCallback)(e=>{for(let t of Y)if(t.shortcut&&(0,er.P6)(t.shortcut,e)){e.preventDefault(),e.stopPropagation(),x(t);return}},[x,Y]),Q=(0,a.useCallback)(e=>{g(e),m(e)},[g,m]);return b?(0,o.jsxs)(f.iWf,{value:j,children:[p.length>0&&(0,o.jsx)(t3,{documentId:t,documentType:n,inspectors:p,onMenuItems:N}),i.length>0&&b&&(0,o.jsx)(f.QMc,{actions:i,documentId:t,documentType:n,onActions:H,path:i2,schemaType:b}),(0,o.jsx)(f.kNp,{actions:U,path:i2,children:(0,o.jsxs)(iQ,{actionsBoxElement:R,as:e5,currentMinWidth:G,"data-testid":"document-pane",flex:2.5,id:y,minWidth:W,onKeyUp:Z,rootRef:S,children:[(0,o.jsx)(iT,{ref:D,menuItems:Y}),I&&(0,f.EM_)(I)&&E&&(0,o.jsx)(i5,{children:(0,o.jsx)(ny,{tone:"transparent","data-test-id":"sanity-create-read-only-banner",content:(0,o.jsx)(E,{metadata:I})})}),(0,o.jsx)(l.Tu,{position:i8,zOffset:_.paneDialog,children:(0,o.jsx)(l.kC,{direction:"column",flex:1,height:C?void 0:"fill",children:(0,o.jsx)(i3,{"data-testid":"change-connector-root",isReviewChangesOpen:e,onOpenReviewChanges:h,onSetFocus:Q,children:(0,o.jsx)(nH,{footerHeight:q||null,headerHeight:F||null,isInspectOpen:c,rootElement:T,setDocumentPanelPortalElement:A})})})}),(0,o.jsx)(l.Xp,{__unstable_elements:{[tQ]:P},children:(0,o.jsx)(l.Tu,{position:i8,zOffset:_.portal,children:(0,o.jsx)(td,{ref:$,children:(0,o.jsx)(s.uE,{children:(0,o.jsx)(iY,{actionsBoxRef:L,createLinkMetadata:I})})})})}),(0,o.jsx)(t7,{})]})})]}):(0,o.jsx)(i1,{currentMinWidth:G,documentType:n,minWidth:W,paneKey:y,value:j})}function i5(e){let{collapsed:t}=e9();return t?null:e.children}function i7(e){return e.document?.components?.unstable_layout}let i9=(0,ed.dS)({name:"DocumentURLCopied",version:1,description:"User copied document URL to clipboard"}),i6=(0,ed.dS)({name:"New Draft Created",version:1,description:"User created a new draft"}),re=(0,a.memo)(e=>{let{children:t,index:n,pane:i,paneKey:r,onFocusPath:s}=e,d=(0,f.I_y)(),u=(0,f.zEW)(),{setDocumentMeta:p}=(0,f.ooN)(),{__internal_tasks:m,document:{actions:h,badges:x,unstable_fieldActions:g,unstable_languageFilter:y,inspectors:b}}=(0,f.Lky)(),j=(0,f.ap5)(),v=eF(),w=v.setParams,{features:_}=tJ(),{push:I}=(0,l.pm)(),{options:E,menuItemGroups:T=t2,title:S=null,views:z=[]}=i,$=(0,f.BoV)(E),M=$.id,D=(0,f.vsM)(M),R=E.type,L=(0,f.BoV)(v.params)||t0,P=(0,f.BoV)(v.payload),{templateName:A,templateParams:O}=(0,a.useMemo)(()=>(function(e,t){let n=t.panePayload||{},i=t.templateName;t.urlTemplate&&i&&i!==t.urlTemplate&&console.warn(`Conflicting templates: URL says "${t.urlTemplate}", structure node says "${i}". Using "${i}".`);let r=i||t.urlTemplate,s=e.filter(e=>e.schemaType===t.documentType),o={...t.templateParams,..."object"==typeof n&&n||{}},l=r;return r||1!==s.length||(l=s[0].id),{templateName:l,templateParams:o}})(u,{documentType:R,templateName:$.template,templateParams:$.templateParameters,panePayload:P,urlTemplate:L.template}),[R,$,L,P,u]),N=(0,f.t2O)({documentId:D,documentType:R,templateName:A,templateParams:O}),U=(0,f.BoV)(N),{patch:H}=(0,f.d9t)(D,R),B=(0,f.iav)(D,R),{validation:V}=(0,f.a3k)(D,R),q=(0,f.z1O)(D,R),F=d.get(R),G=B?.draft||B?.published||U.value,[W,K]=(0,a.useState)(!1),X=(0,a.useMemo)(()=>h({schemaType:R,documentId:D}),[h,D,R]),Y=(0,a.useMemo)(()=>x({schemaType:R,documentId:D}),[x,D,R]),Z=(0,a.useMemo)(()=>y({schemaType:R,documentId:D}),[D,R,y]),Q=(0,f.BoV)(V),J=(0,f.BoV)(z),[ee,et]=(0,a.useState)(()=>L.path?(0,k.mL)(L.path):f.LZ8),en=(0,a.useRef)([]),ei=L.view||J[0]&&J[0].id||null,[er,es]=(0,a.useState)("closed"),[eo,el]=(0,a.useState)(null),ec=(0,f.Dab)({documentId:D,documentType:R,onError:el,rev:L.rev,since:L.since}),ed=(0,f.P08)(ec,e=>e.onOlderRevision),eu=(0,f.P08)(ec,e=>e.revTime),ep=(0,f.P08)(ec,e=>e.sinceAttributes),em=(0,f.P08)(ec,e=>e.timelineDisplayed),eh=(0,f.P08)(ec,e=>e.timelineReady),ey=(0,f.P08)(ec,e=>e.isPristine),eb=(0,a.useMemo)(()=>!!eh&&!B?.draft&&!B?.published&&!ey,[B?.draft,B?.published,ey,eh]),ej=i0(G),[ev,ew]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=j.documentPresence(D).subscribe(e=>{ew(e)});return()=>{e.unsubscribe()}},[D,j]);let eC=(0,a.useMemo)(()=>b({documentId:D,documentType:R}),[D,R,b]),[e_,ek]=(0,a.useState)(()=>L.inspect||null),eI=(0,a.useRef)(L.inspect);(0,a.useEffect)(()=>{eI.current!==L.inspect&&(eI.current=L.inspect,ek(L.inspect||null))},[L.inspect]);let eE=eC?.find(e=>e.name===e_),eT=eC.find(e=>e.name===t8),eS=eE?.name===t8,{t:e$}=(0,f.$G7)(ez),eM="on"===L.inspect,eD=eS?ep:B?.published||null,eR=(0,a.useMemo)(()=>F?g({documentId:D,documentType:R,schemaType:F}):[],[D,R,g,F]),eL="connected"===q&&B.ready&&(!L.rev||eh||!!eo),eP=(0,a.useMemo)(()=>ed?em||{_id:G._id,_type:G._type}:G,[ed,em,G]),eA=(0,a.useCallback)((e,t)=>{w({...L,since:e,rev:t||void 0})},[L,w]),eO=(0,a.useCallback)(e=>{tf.current||(et(f.LZ8),en.current!==f.LZ8&&(en.current=f.LZ8,s?.(f.LZ8)))},[s,et]),eN=(0,a.useRef)(()=>{throw Error("Nope")});eN.current=e=>{B.draft||B.published||eX.log(i6),H.execute((0,f.GWp)(e.patches),U.value)};let eU=(0,a.useCallback)(e=>eN.current(e),[]),eH=(0,a.useCallback)(e=>{let t=e&&eC.find(t=>t.name===e);if(e&&!t){console.warn(`No inspector named "${e}"`);return}if(eE){if(t){let e=t.onClose?.({params:L})??{params:L};ek(null),eI.current=void 0,w({...e.params,inspect:void 0});return}if(eE){let e=eE.onClose?.({params:L})??{params:L};ek(null),eI.current=void 0,w({...e.params,inspect:void 0})}}},[eE,eC,L,w]),eB=(0,a.useCallback)((e,t)=>{let n=eC.find(t=>t.name===e);if(!n){console.warn(`No inspector named "${e}"`);return}if(eE?.name===n.name){w({...L,...t,inspect:n.name});return}let i=L;eE&&(i=(n.onClose?.({params:i})??{params:i}).params);let r=n.onOpen?.({params:i})??{params:i};ek(n.name),eI.current=n.name,w({...r.params,...t,inspect:n.name})},[eE,eC,L,w]),eV=(0,a.useCallback)(()=>{eT&&eH(eT.name)},[eH,eT]),eq=(0,a.useCallback)(()=>{_.reviewChanges&&eT&&eB(eT.name)},[_.reviewChanges,eB,eT]),eG=(0,a.useCallback)(()=>v.closeCurrent(),[v]),eW=(0,a.useCallback)(()=>v.duplicateCurrent(),[v]),eK=(0,a.useCallback)((e=!eM)=>{w(e?{...L,inspect:"on"}:C(L,"inspect"))},[eM,L,w]),eX=(0,ea.f1)(),eY=(0,a.useCallback)(e=>{if("production-preview"===e.action&&ej)return window.open(ej),!0;if("copy-document-url"===e.action&&navigator)return eX.log(i9),navigator.clipboard.writeText(window.location.toString()),I({id:"copy-document-url",status:"info",title:e$("panes.document-operation-results.operation-success_copy-url")}),!0;if("inspect"===e.action)return eK(!0),!0;if("reviewChanges"===e.action)return eq(),!0;if("string"==typeof e.action&&e.action.startsWith(t1)){let t=e.action.slice(t1.length),n=eC.find(e=>e.name===t);if(n)return n.name===e_?eH(n.name):eB(n.name),!0}return!1},[e$,eH,eq,e_,eC,eB,ej,eK,I,eX]),eZ=(0,a.useCallback)(()=>eK(!1),[eK]),[eQ,eJ]=(0,a.useState)([]),[e0,e1]=(0,a.useState)(),[e2,e8]=(0,a.useState)(),[e3,e4]=(0,a.useState)(),e5=(0,a.useCallback)((e,t)=>{e8(n=>(0,f.pt$)(n,e,t))},[]),e7=(0,a.useCallback)((e,t)=>{e4(n=>(0,f.pt$)(n,e,t))},[]),e9=(0,a.useCallback)((e,t)=>e1(n=>(0,f.pt$)(n,e,t)),[]),e6=G._createdAt?"update":"create",te=!!F?.liveEdit,tt=G._id?G._id:"dummy-id",tn=(0,a.useMemo)(()=>({...G,_id:te?(0,f.vsM)(tt):(0,f.qyu)(tt)}),[te,G,tt]),[ti,tr]=(0,f.vSY)({document:tn,permission:e6}),ts=(0,f.dqi)(G),to=!G?._id,tl=(0,a.useMemo)(()=>{let e=!tr&&!ti?.granted,t=!(0,ef.jA)(F,"update"),n=to&&!(0,ef.jA)(F,"create"),i="reconnecting"===q,r=B.transactionSyncLock?.enabled,s=!!(te&&B.draft);return!eL||null!==eu||e||t||n||i||r||W||eb||s||ts},[tr,ti?.granted,F,to,q,B.transactionSyncLock?.enabled,B.draft,te,eL,eu,W,eb,ts]),ta=(0,f.clL)({schemaType:F,documentValue:eP,readOnly:tl,comparisonValue:eD,focusPath:ee,openPath:eQ,collapsedPaths:e2,presence:ev,validation:Q,collapsedFieldSets:e3,fieldGroupState:e0,changesOpen:eS});(0,a.useEffect)(()=>{p({documentId:D,documentType:R,schemaType:F,onChange:eU})},[D,R,F,eU,p]);let tc=(0,a.useRef)(ta);tc.current=ta;let td=(0,a.useCallback)(e=>{(0,f.C8M)(tc.current,e).forEach(e=>{"expandPath"===e.type&&e8(t=>(0,f.pt$)(t,e.path,!1)),"expandFieldSet"===e.type&&e4(t=>(0,f.pt$)(t,e.path,!1)),"setSelectedGroup"===e.type&&e1(t=>(0,f.pt$)(t,e.path,e.groupName))}),eJ(e)},[tc]),tu=(0,a.useCallback)((e,t)=>{j.setLocation([{type:"document",documentId:D,path:e,lastActiveAt:new Date().toISOString(),selection:t?.selection}])},[D,j]),tp=(0,a.useMemo)(()=>ex(tu,1e3,{leading:!0,trailing:!0}),[tu]),tm=(0,a.useCallback)((e,t)=>{let n=(0,k.s6)(e);n!==en.current&&(et((0,k.s6)(n)),td((0,k.s6)(n.slice(0,-1))),en.current=n,s?.(n)),tp(n,t)},[s,td,tp]),th=(0,a.useMemo)(()=>({actions:X,activeViewId:ei,badges:Y,changesOpen:eS,closeInspector:eH,collapsedFieldSets:e3,collapsedPaths:e2,compareValue:eD,connectionState:q,displayed:eP,documentId:D,documentIdRaw:M,documentType:R,editState:B,fieldActions:eR,focusPath:ee,inspector:eE||null,inspectors:eC,__internal_tasks:m,onBlur:eO,onChange:eU,onFocus:tm,onPathOpen:td,onHistoryClose:eV,onHistoryOpen:eq,onInspectClose:eZ,onMenuAction:eY,onPaneClose:eG,onPaneSplit:eW,onSetActiveFieldGroup:e9,onSetCollapsedPath:e5,onSetCollapsedFieldSet:e7,openInspector:eB,openPath:eQ,index:n,inspectOpen:eM,validation:Q,menuItemGroups:T||[],paneKey:r,previewUrl:ej,ready:eL,schemaType:F,isPermissionsLoading:tr,permissions:ti,setTimelineMode:es,setTimelineRange:eA,setIsDeleting:K,isDeleting:W,isDeleted:eb,timelineError:eo,timelineMode:er,timelineStore:ec,title:S,value:G,views:J,formState:ta,unstable_languageFilter:Z}),[m,X,ei,Y,eS,eH,e3,e2,eD,q,eE,eP,D,M,R,B,eR,ee,ta,eO,eU,tm,eV,eq,eZ,eY,e7,e5,eG,eW,e9,n,eM,eC,eb,W,tr,Z,T,eB,eQ,r,ti,ej,eL,F,td,eA,eo,er,ec,S,Q,G,J]);(0,a.useEffect)(()=>{let e;return"reconnecting"===q&&(e=setTimeout(()=>{I({id:"sanity/structure/reconnecting",status:"warning",title:e$("panes.document-pane-provider.reconnecting.title")})},2e3)),()=>{e&&clearTimeout(e)}},[q,I,e$]);let tf=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{if(eL&&L.path){let{path:e,...t}=L,n=(0,k.vW)(tc.current?.value,(0,k.mL)(e));tf.current=!0,eg(en.current,n)||(et(n),td(n),en.current=n,s?.(n));let i=setTimeout(()=>{tf.current=!1},0);return v.setParams(t),()=>clearTimeout(i)}},[L,D,s,td,eL,v]),(0,o.jsx)(c.cO.Provider,{value:th,children:t})});re.displayName="Memo(DocumentPaneProvider)";let rt=(0,a.memo)(function(e){let{name:t}=(0,f.Lky)();return(0,o.jsx)(f.cWh,{name:e.pane.source||t,children:(0,o.jsx)(f.Or8,{children:(0,o.jsx)(rn,{...e})})})});function rn(e){let{pane:t,paneKey:n}=e,{resolveNewDocumentOptions:i}=(0,f.Lky)().document,r=eF(),s=function(e,t={}){let n=(0,f.zEW)();return(0,a.useMemo)(()=>{if(e.type&&"*"!==e.type)return e;let i=e.template||t.template,r=(i?n.find(e=>e.id===i):void 0)?.schemaType;return r?{...e,type:r}:e},[e,t.template,n])}(t.options,r.params),{documentType:c,isLoaded:d}=(0,f.Hdz)(s.id,s.type),u=(0,f.uwK)({pick:i7,defaultComponent:i4}),p=(0,a.useMemo)(()=>i({type:"document",documentId:s.id,schemaType:s.type}),[s.id,s.type,i]),[m,h]=(0,f.UMU)({templateItems:p}),x=d&&!h,g=(0,a.useMemo)(()=>x&&c&&s.type!==c?{...e,pane:{...e.pane,options:{...s,type:c}}}:e,[e,c,x,s]),{ReferenceChildLink:y,handleEditReference:b,groupIndex:j,routerPanesState:v}=r,w=v[j+1]?.[0].params||{},C=v.length,{parentRefPath:_}=w,I=(0,a.useMemo)(()=>_?{path:(0,k.mL)(_),state:j>=C-1?"none":j>=C-2?"selected":"pressed"}:{path:[],state:"none"},[_,j,C]),{t:E}=(0,f.$G7)(ez);return"*"!==s.type||x?c?(0,o.jsx)(re,{...g,children:(0,o.jsx)(f.euX,{EditReferenceLinkComponent:y,onEditReference:b,initialValueTemplateItems:m,activePath:I,children:(0,o.jsx)(tW,{documentId:s.id,documentType:s.type,children:(0,o.jsx)(u,{documentId:s.id,documentType:s.type})})})},`${c}-${s.id}`):(0,o.jsx)(tB,{flex:2.5,minWidth:320,paneKey:n,title:E("panes.document-pane.document-not-found.title"),children:(0,o.jsx)(l.Kq,{space:4,children:(0,o.jsx)(l.xv,{as:"p",children:(0,o.jsx)(f.vNl,{t:E,i18nKey:"panes.document-pane.document-not-found.text",values:{id:s.id},components:{Code:({children:e})=>(0,o.jsx)("code",{children:e})}})})})}):(0,o.jsx)(tF,{flex:2.5,minWidth:320,paneKey:n,title:E("panes.document-pane.document-not-found.loading")})}let ri={by:[{field:"_updatedAt",direction:"desc"}]},rr={},rs=(0,w.zo)(l.xu)`
  position: relative;
  opacity: ${e=>e.$opacity||1};
  transition: opacity 0.4s;
`,ro=(0,w.zo)(l.xu)`
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
`,rl=[...Array(30).keys()];function ra(e){let{layout:t}=e;return(0,o.jsx)(l.Kq,{paddingX:3,paddingY:2,paddingTop:0,space:1,children:rl.map(e=>(0,o.jsx)(f.ogX,{isPlaceholder:!0,layout:t},e))})}function rc(e){let{childItemId:t,error:n,filterIsSimpleTypeConstraint:i,hasMaxItems:r,hasSearchQuery:s,isActive:c,isLazyLoading:d,isLoading:u,items:p,layout:m,loadingVariant:h,onEndReached:x,onRetry:g,paneTitle:y,searchInputElement:b,showIcons:j}=e,v=(0,f.I_y)(),{collapsed:w}=eH(),{collapsed:C,index:_}=e9(),[k,I]=(0,a.useState)(!C),{t:E}=(0,f.$G7)(ez),T=(0,a.useCallback)(()=>{k&&x()},[x,k]);(0,a.useEffect)(()=>{if(C)return;let e=setTimeout(()=>{I(!0)},0);return()=>{clearTimeout(e)}},[C,p]);let S=(0,a.useCallback)((e,{activeIndex:n})=>{let i=(0,f.vsM)(e._id),s=t===i,a=!c&&s,u=c&&s,h=n===p.length-1,x=h&&d,g=h&&r;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tN,{icon:!1!==j&&void 0,id:i,layout:m,marginBottom:1,pressed:a,schemaType:v.get(e._type),selected:u,value:e}),x&&(0,o.jsx)(f.Bwn,{}),g&&(0,o.jsx)(l.xu,{marginY:1,paddingX:3,paddingY:4,children:(0,o.jsx)(l.xv,{align:"center",muted:!0,size:1,children:E("panes.document-list-pane.max-items.text",{limit:2e3})})})]})},[t,c,p.length,m,v,j,r,d,E]),z=(0,a.useMemo)(()=>s?(0,o.jsx)(l.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,o.jsx)(l.W2,{width:1,children:(0,o.jsx)(l.xu,{paddingX:4,paddingY:5,children:(0,o.jsx)(l.xv,{align:"center",muted:!0,children:E("panes.document-list-pane.no-documents.text")})})})}):(0,o.jsx)(l.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,o.jsx)(l.W2,{width:1,children:(0,o.jsx)(l.xu,{paddingX:4,paddingY:5,children:(0,o.jsx)(l.xv,{align:"center",muted:!0,children:E(i?"panes.document-list-pane.no-documents-of-type.text":"panes.document-list-pane.no-matching-documents.text")})})})}),[i,s,E]),$=(0,a.useMemo)(()=>{if(!k)return null;if(n)return(0,o.jsx)(l.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,o.jsx)(l.W2,{width:1,children:(0,o.jsxs)(l.Kq,{paddingX:4,paddingY:5,space:4,children:[(0,o.jsx)(l.X6,{as:"h3",children:E("panes.document-list-pane.error.title")}),(0,o.jsx)(l.xv,{as:"p",children:(0,o.jsx)(f.vNl,{t:E,i18nKey:"panes.document-list-pane.error.text",values:{error:n.message},components:{Code:({children:e})=>(0,o.jsx)("code",{children:e})}})}),(0,o.jsx)(f.fZm,{error:n,eventId:null,onRetry:g})]})})});if(!u&&0===p.length)return z;if("initial"===h&&u)return(0,o.jsx)(e2,{ms:300,children:(0,o.jsx)(ra,{layout:m})});if("spinner"===h&&u)return null;let e=`${_}-${C}`;return(0,o.jsx)(rs,{overflow:"hidden",height:"fill",$opacity:"subtle"===h?.8:1,children:(0,o.jsx)(ro,{children:(0,o.jsx)(f.e8h,{activeItemDataAttr:"data-hovered",ariaLabel:y,canReceiveFocus:!0,inputElement:b,itemHeight:51,items:p,onEndReached:T,onlyShowSelectionWhenActive:!0,overscan:10,paddingBottom:1,paddingX:3,renderItem:S,wrapAround:!1},e)})})},[C,n,T,_,u,p,m,h,g,S,b,k]);return(0,o.jsx)(e6,{"data-testid":"document-list-pane",overflow:w||"initial"===h?"hidden":"auto",children:$})}function rd(e,t={}){try{let n=function e(t){switch(t.type){case"OpCall":{let{left:e,right:n}=t;switch(t.op){case"==":return"AccessAttribute"!==e.type||"_type"!==e.name||e.base?"AccessAttribute"!==n.type||"_type"!==n.name||n.base?null:"Value"!==e.type||"string"!=typeof e.value?null:new Set([e.value]):"Value"!==n.type||"string"!=typeof n.value?null:new Set([n.value]);case"in":{if("AccessAttribute"!==e.type||"_type"!==e.name||e.base||"Array"!==n.type)return null;let t=new Set;for(let e of n.elements){if(e.isSplat||"Value"!==e.value.type||"string"!=typeof e.value.value)return null;t.add(e.value.value)}return t.size?t:null}default:return null}}case"Group":return e(t.base);case"Or":{let n=e(t.left);if(!n)return null;let i=e(t.right);return i?new Set([...n,...i]):null}case"And":{let n=e(t.left),i=e(t.right);return n||i?new Set([...n||[],...i||[]]):null}default:return null}}((0,ek.Qc)(e,{params:t}));return n?Array.from(n).sort():null}catch{return null}}let ru=["_id","_type","_createdAt","_updatedAt","_rev"];function rp(e,t,n=!1){return t.map(t=>(function e(t,n,i=!1){let[r,...s]=n;if(!("fields"in t))return"";let o=t.fields.find(e=>e.name===r);if(!o){if(!ru.includes(r)){let e=`The current ordering config targeted the nonexistent field "${r}" on schema type "${t.name}". It should be one of ${t.fields.map(e=>e.name).join(", ")}`;if(i)throw Error(e);console.warn(e)}return""}if("to"in o.type&&"reference"===o.type.name){let t=o.type.to;return`${r}->{${t.map(t=>e(t,s)).join(",")}}`}let l=s.length>0&&e(o.type,s),a=l?`{${l}}`:"";return s.length>0?`${r}${a}`:r})(e,t.field.split("."),n)).join(", ")}let rm=(0,f.h40)({maxSize:100});function rh(e){let{client:t,schema:n,sort:i,limit:r,params:s,filter:o,searchQuery:l,staticTypeNames:a,maxFieldDepth:c,enableLegacySearch:d}=e,u=i.by,p=i?.extendedProjection,m=(0,N.P)(()=>t.listen(`*[${o}]`,s,{events:["welcome","mutation","reconnect"],includeResult:!1,visibility:"query"})).pipe((0,U.z)((e,t)=>0===t&&"welcome"!==e.type?(0,H._)(()=>Error("reconnect"===e.type?"Could not establish EventSource connection":`Received unexpected type of first event "${e.type}"`)):(0,S.of)(e)),(0,B.B)()),[h,x]=(0,V.u)(m,e=>"welcome"===e.type),g=JSON.stringify({filter:o,limit:r,params:s,searchQuery:l,sort:i,staticTypeNames:a});return(0,z.T)(h.pipe((0,q.q)(1)),x.pipe((0,F.p)(1e3,G.z,{leading:!0,trailing:!0}))).pipe((0,eE.q)(e=>(a?(0,S.of)(a):t.observable.fetch(`array::unique(*[${o}][]._type)`,s)).pipe((0,U.z)(m=>{let h=(0,f.wBu)(n,a||[]).filter(e=>!!m.includes(e.name)&&(rp(e,i.by,!0),!0)),x=(0,f.mju)(h,t,{filter:o,params:s,enableLegacySearch:d,maxDepth:c}),g=()=>x({query:l||"",types:h},{__unstable_extendedProjection:p,comments:[`findability-source: ${l?"list-query":"list"}`],limit:r,skipSortByScore:!0,sort:u}).pipe((0,$.U)(e=>e.hits.map(({hit:e})=>e)));return"mutation"===e.type&&"query"!==e.visibility?(0,E.H)(1200).pipe((0,U.z)(g)):g()}))),rm(g),(0,$.U)(({fromCache:e,value:t})=>({fromCache:e,documents:t})))}let rf={error:null,isLoading:!0,isLoadingFullList:!1,fromCache:!1,items:[]},rx="[WARNING: This was thrown as a non-error. Only Error instances should be thrown]",rg=(0,w.F4)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,ry=(0,w.F4)`
  0% {
    opacity: 0;
  }
  50% {
    opacity: 0.1;
  }
  100% {
    opacity: 0.4;
  }
`,rb=(0,w.zo)(d.L4p)`
  animation: ${rg} 500ms linear infinite;
`,rj=(0,w.zo)(d.L4p)`
  animation: ${rg} 1500ms linear infinite;
  opacity: 0.4;
`,rv=(0,w.zo)(d.L4p)`
  animation:
    ${rg} 1500ms linear infinite,
    ${ry} 1000ms linear;
  opacity: 0.4;
`,rw=(0,a.memo)(function(e){let{childItemId:t,isActive:n,pane:i,paneKey:r,sortOrder:s,layout:c}=e,u=(0,f.I_y)(),{displayOptions:p,options:m}=i,{apiVersion:h,filter:g}=m,y=rQ(m.params||rr),b=(0,a.useMemo)(()=>{let e=rd(g,y);return e?.length===1?e[0]:null},[g,y]),j=p?.showIcons!==!1,{t:v}=(0,f.$G7)(ez),{title:w}=(0,f.v0Z)(i),[C,_]=(0,a.useState)(""),[T,M]=(0,a.useState)(""),[L,A]=(0,a.useState)(null),O=b&&s?function(e,t){let n=e.by.map(e=>{if(e.mapWith)return e;let n=function(e,t){let n=k.mL(t),i=e;for(let e of n){if(!i)return;if("string"==typeof e){i=function(e,t){if(!("fields"in e))return;let n=e.fields.find(e=>e.name===t);return n?n.type:void 0}(i,e);continue}if(!((0,x.Fd)(e)||(0,x.dw)(e))||"array"!==i.jsonType)return;let[t,n]=i.of||[];if(n||!t)return;if(!(0,x.dD)(t)){i=t;continue}let[r,s]=t.to||[];if(s||!r)return;i=r}return i}(t,e.field);return n?!function(e,t){let n=e.type;for(;n;){if(n.name===t||!n.type&&n.jsonType===t)return!0;n=n.type}return!1}(n,"datetime")?"string"===n.jsonType?{...e,mapWith:"lower"}:e:{...e,mapWith:"dateTime"}:e});return n.every((t,n)=>t===e.by[n])?e:{...e,by:n}}(s,u.get(b)):s,N=(0,f.BoV)(O),{error:H,isLoadingFullList:V,isLoading:F,items:G,fromCache:X,onLoadFullList:Y,onRetry:Q}=function(e){let{filter:t,params:n,sortOrder:i,searchQuery:r,apiVersion:s}=e,o=(0,f.m85)({...f.Dr7,apiVersion:s||f.Dr7.apiVersion}),{enableLegacySearch:l=!1}=(0,f.cFj)().search,c=(0,f.I_y)(),d=(0,f.NFh)(),u=(0,a.useMemo)(()=>rd(t,n),[t,n]),[p,m]=(0,a.useMemo)(()=>(0,eI.E)(),[]),[h,x]=(0,a.useMemo)(()=>(0,eI.E)(),[]),g=(0,a.useMemo)(()=>{let e={client:o,filter:t,limit:100,params:n,schema:c,searchQuery:r||"",sort:i||ri,staticTypeNames:u,maxFieldDepth:d,enableLegacySearch:l},s=rh(e).pipe((0,Z.d)({refCount:!0,bufferSize:1})),a=h.pipe((0,et.M)(s),(0,P.h)(([,e])=>e?.documents.length===100),(0,q.q)(1),(0,U.z)(()=>(0,R.z)((0,S.of)({type:"loadFullList"}),rh({...e,limit:2e3}).pipe((0,$.U)(e=>({type:"result",result:e}))))),(0,B.B)());return(0,z.T)(s.pipe((0,$.U)(e=>({type:"result",result:e})),(0,en.R)(a)),a).pipe((0,D.K)((e,t)=>(0,R.z)((0,S.of)({type:"error",error:e instanceof Error?e:"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message?Error(`${e.message} ${rx}`):Error(`${String(e)} ${rx}`)}),(0,z.T)((0,I.R)(window,"online"),p).pipe((0,q.q)(1),(0,U.z)(()=>t)))),(0,ei.R)((e,t)=>{if("error"===t.type)return{...e,error:t.error};if("result"===t.type){var n;return{...e,error:null,fromCache:t.result.fromCache,isLoading:!1,items:(n=t.result.documents,(0,f.RgL)(n).map(e=>({...e.draft||e.published,hasPublished:!!e.published,hasDraft:!!e.draft}))),isLoadingFullList:!1}}if("loadFullList"===t.type)return{...e,error:null,isLoadingFullList:!0};throw Error("Unexpected")},rf))},[o,t,n,c,r,i,u,d,l,h,p]),{error:y,items:b,isLoading:j,fromCache:v,isLoadingFullList:w}=(0,ec.m)(g,rf);return{error:y,onRetry:m,isLoading:j,items:b,fromCache:v,onLoadFullList:x,isLoadingFullList:w}}({apiVersion:h,filter:g,params:y,searchQuery:C?.trim(),sortOrder:N}),J=(0,ec.H)(e=>e.pipe((0,$.U)(e=>e.target.value),(0,W.b)(M),(0,K.D)(e=>""===e?(0,S.of)(""):(0,E.H)(300)),(0,W.b)(_))),ee=(0,a.useCallback)(()=>{_(""),M("")},[]),er=(0,a.useCallback)(e=>{"Escape"===e.key&&ee()},[ee]),[es,eo]=(0,a.useState)();(0,a.useEffect)(()=>{es||F||eo(r)},[es,F,r]),(0,a.useEffect)(()=>{ee(),eo()},[r,ee]);let el=(0,a.useMemo)(()=>F&&es===r?"spinner":X?"subtle":"initial",[es,X,F,r]),ea=(0,a.useMemo)(()=>"spinner"===el?rb:T&&"subtle"===el?rj:d.W1M,[el,T]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.xu,{paddingX:3,paddingBottom:3,children:(0,o.jsx)(l.oi,{"aria-label":v("panes.document-list-pane.search-input.aria-label"),autoComplete:"off",border:!1,clearButton:!!C,disabled:!!H,fontSize:[2,2,1],icon:ea,iconRight:"subtle"!==el||T?null:rv,onChange:J,onClear:ee,onKeyDown:er,padding:2,placeholder:v("panes.document-list-pane.search-input.placeholder"),radius:2,ref:A,spellCheck:!1,value:T})}),(0,o.jsx)(rc,{childItemId:t,error:H,filterIsSimpleTypeConstraint:!!b,hasMaxItems:2e3===G.length,hasSearchQuery:!!C,isActive:n,isLazyLoading:V,isLoading:F,items:G,layout:c,loadingVariant:el,onEndReached:Y,onRetry:Q,paneTitle:w,searchInputElement:L,showIcons:j},r)]})}),rC=(0,a.memo)(({contentAfter:e,index:t,initialValueTemplates:n=[],menuItemGroups:i=[],menuItems:r=[],setLayout:l,setSortOrder:c,title:u})=>{let{features:p}=tJ(),{collapsed:m,isLast:h}=e9(),f=(0,a.useMemo)(()=>({setLayout:({layout:e})=>{l(e)},setSortOrder:e=>{c(e)}}),[l,c]);return(0,o.jsx)(s.uE,{children:(0,o.jsx)(tg,{actions:(0,o.jsx)(tP,{initialValueTemplateItems:n,actionHandlers:f,menuItemGroups:i,menuItems:r}),backButton:p.backButton&&t>0&&(0,o.jsx)(s.zx,{as:eU,"data-as":"a",icon:d.Y4O,mode:"bleed",tooltipProps:{content:"Back"}}),contentAfter:e,tabIndex:h&&!m?-1:0,title:u})})});function r_(e){let{row:t,table:n}=e,{selectedAnchor:i,setSelectedAnchor:r}=n.options.meta||{},s=(0,a.useCallback)(e=>{if(e.shiftKey&&null!=i){let e=t.index,r=e<i?e:i,s=e<i?i:e,o=n.getRowModel().flatRows.slice(r,s+1).map(({id:e})=>e),l=n.getSelectedRowModel().rows.map(({id:e})=>e);n.setRowSelection(()=>[...o,...l].reduce((e,t)=>({...e,[t]:!0}),{}))}else r&&(r(t.getIsSelected()?null:t.index),t.toggleSelected())},[i,t,r,n]);return(0,o.jsx)(l.XZ,{style:{paddingLeft:4},checked:e.row.getIsSelected(),disabled:!e.row.getCanSelect(),onChange:()=>null,onClick:s})}rC.displayName="Memo(PaneHeader)";let rk=()=>{let e=(0,a.useContext)(c.Q2);if(void 0===e)throw Error("useDocumentSheetListContext must be used within an DocumentSheetListProvider");return e};function rI({children:e,table:t}){let[n,i]=(0,a.useState)(null),[r,s]=(0,a.useState)([]),l=(0,a.useCallback)((e=null)=>{n?.state==="focused"&&document.activeElement instanceof HTMLElement&&document.activeElement.blur(),i(e),s([])},[n]),d=(0,a.useCallback)(()=>l(),[l]),u=(0,a.useCallback)(e=>{if(!n)return;let i=t.getVisibleLeafColumns(),r=i.findIndex(e=>e.id===n.colId)+("left"===e?-1:1);r<0||r>=i.length||l({colId:i[r].id,rowIndex:n.rowIndex,state:"selected"})},[l,n,t]),p=(0,a.useCallback)(e=>{n&&s(t=>{let{rowIndex:i}=n,r=t=>t+("down"===e?1:-1);if(!t.length){let e=r(i);return e<0?[]:[e]}let s=r(t[t.length-1]);return s<0?t:s===i?[]:t.includes(s)?t.slice(0,-1):[...t,s]})},[n]),m=(0,a.useCallback)((e,t)=>{l({colId:e,rowIndex:t,state:"selected"})},[l]),h=(0,a.useCallback)(()=>{n&&(r.length?s([]):l("selected"===n.state?null:{...n,state:"selected"}))},[l,n,r.length]),f=(0,a.useCallback)((e,t)=>{if(!n)return;let i="ArrowDown"===t?"down":"up",r="down"===i?1:-1;if(e)p(i);else{let e=n.rowIndex+r;if(e<0)return;m(n.colId,e)}},[p,n,m]),x=(0,a.useCallback)(e=>{if(!n)return;let{key:t,shiftKey:i}=e;switch(t){case"Shift":break;case"Escape":h();break;case"ArrowDown":case"ArrowUp":e.preventDefault(),f(i,t);break;case"ArrowLeft":case"ArrowRight":"selected"===n.state&&(e.preventDefault(),u("ArrowLeft"===t?"left":"right"))}},[n,h,f,u]),g=(0,a.useCallback)(e=>{n&&(document.getElementById(`cell-${n.colId}-${n.rowIndex}`)?.contains(e.target)||d())},[d,n]);(0,a.useEffect)(()=>(n&&(document.addEventListener("keydown",x),document.addEventListener("click",g)),()=>{n&&(document.removeEventListener("keydown",x),document.removeEventListener("click",g))}),[g,x,n]);let y=(0,a.useCallback)(()=>i(e=>e?{...e,state:"focused"}:null),[]),b=(0,a.useCallback)((e,t)=>n?.colId!==e?null:n.rowIndex===t?"focused"===n.state?"focused":"selectedAnchor":r.includes(t)?"selectedRange":null,[n,r]),j=(0,a.useCallback)(()=>{n&&l({colId:n.colId,rowIndex:n.rowIndex+1,state:"selected"})},[l,n]),v=(0,a.useMemo)(()=>({focusAnchorCell:y,resetFocusSelection:d,setSelectedAnchorCell:m,getStateByCellId:b,submitFocusedCell:j}),[y,d,m,b,j]);return(0,o.jsx)(c.Q2.Provider,{value:v,children:e})}let rE=w.zo.td`
  display: flex;
  overflow: hidden;
  box-sizing: border-box;
  width: ${({width:e})=>e}px;
  border-top: 1px solid var(--card-border-color);
  background-color: var(--card-bg-color);
`,rT=(0,w.zo)(rE)`
  position: sticky;
  z-index: 2;
`;function rS(e){let{getValue:t,column:n,row:i,fieldType:r}=e,s=`cell-${n.id}-${i.index}`,[c,d]=(0,a.useState)(t()),[u,p]=(0,a.useState)(!1),m=(0,a.useRef)(null),{focusAnchorCell:h,resetFocusSelection:f,setSelectedAnchorCell:x,getStateByCellId:g,submitFocusedCell:y}=rk(),b=g(n.id,i.index),j=(0,a.useCallback)(()=>{x(n.id,i.index),h()},[n.id,h,i.index,x]),{patchDocument:v}=e.table.options.meta||{},w=()=>{m.current?.focus(),m.current instanceof HTMLInputElement&&m.current.select()},C=(0,a.useCallback)(e=>{let{key:t}=e;"Enter"===t&&("selectedAnchor"===b&&w(),"focused"===b&&y())},[b,y]),_=(0,a.useCallback)(e=>{let t=e.clipboardData?.getData("Text");("string"==typeof t||"number"==typeof t)&&(d(t),v?.(i.id,n.id,t))},[n.id,v,i.id]),k=(0,a.useCallback)(()=>{navigator.clipboard.writeText(c.toString())},[c]);(0,a.useEffect)(()=>(("selectedAnchor"===b||"focused"===b)&&document.addEventListener("keydown",C),("selectedAnchor"===b||"selectedRange"===b)&&document.addEventListener("paste",_),"selectedAnchor"===b&&document.addEventListener("copy",k),()=>{("selectedAnchor"===b||"focused"===b)&&document.removeEventListener("keydown",C),("selectedAnchor"===b||"selectedRange"===b)&&document.removeEventListener("paste",_),"selectedAnchor"===b&&document.removeEventListener("copy",k)}),[s,b,n.id,g,k,C,_,i.index]);let I=()=>"focused"===b?"2px solid blue":"selectedRange"===b?"1px solid green":"selectedAnchor"===b?"1px solid blue":"1px solid transparent",E={onFocus:j,onBlur:()=>{u&&(v?.(i.id,n.id,c),p(!1)),f()},onMouseDown:e=>{2===e.detail?w():(e.preventDefault(),x(n.id,i.index))},"aria-selected":!!b,"data-testid":s,id:s,ref:e=>m.current=e};return"boolean"===r.name?(0,o.jsxs)(l.Ph,{...E,onChange:()=>null,radius:0,style:{boxShadow:"none",border:I(),padding:0},value:JSON.stringify(c),children:[(0,o.jsx)("option",{value:"True",children:"True"}),(0,o.jsx)("option",{value:"False",children:"False"})]}):(0,o.jsx)(l.oi,{...E,size:0,radius:0,border:!1,style:{border:I(),padding:"22px 16px"},value:"string"==typeof c||"number"==typeof c?c:JSON.stringify(c),onChange:e=>{p(!0),d(e.target.value)}})}function rz(e){let t=e.column.getIsPinned(),n=t&&e.column.getIsLastColumn("left")?2:1;return(0,o.jsx)(t?rT:rE,{style:{left:e.column.getStart("left")??void 0,borderRight:`${n}px solid var(--card-border-color)`},width:e.column.getSize(),children:(0,eT.ie)(e.column.columnDef.cell,e.getContext?.())},e.row.original._id+e.id)}let r$=e=>{let{documentPreviewStore:t,row:n,schemaType:i}=e,r=(0,a.useMemo)(()=>(0,f.eLL)(t,i,n.original._id,"Document title"),[t,n.original._id,i]),{draft:s,published:c,isLoading:d}=(0,ec.m)(r,{draft:null,isLoading:!0,published:null});if(d)return(0,o.jsx)(l.xv,{size:1,muted:!0,children:"Loading..."});let u=s?.title??c?.title??"Untitled";return(0,o.jsxs)(l.kC,{align:"center",gap:3,children:[(0,o.jsx)(f.aAo,{draft:s,published:c}),(0,o.jsx)(l.xv,{size:1,children:u})]})},rM=(0,eS.Cl)(),rD=["string","number","boolean"],rR=(e,t)=>e.fields.reduce((e,n)=>{let{type:i,name:r}=n;return rD.includes(i.name)?[...e,rM.accessor(t?`${t}.${n.name}`:n.name,{id:t?`${t}_${n.name}`:n.name,header:n.type.title,enableHiding:!0,cell:e=>(0,o.jsx)(rS,{...e,fieldType:i})})]:"object"===i.name&&(0,x.m$)(i)&&!t?[...e,rM.group({header:r,columns:rR(i,n.name)})]:e},[]),rL=e=>e.flatMap(e=>"accessorKey"in e?e:"columns"in e&&e.columns?rL(e.columns):[]);function rP({table:e}){let{t}=(0,f.$G7)(),n=e.getVisibleLeafColumns().filter(e=>e.getCanHide()).length>=5,i=(0,a.useCallback)(()=>{e.resetColumnVisibility()},[e]),r=e=>()=>{e.toggleVisibility()},c=t=>{let i=t.getIsVisible(),r=1===e.getVisibleLeafColumns().filter(e=>e.getCanHide()).length;return n&&!i||r&&i};return(0,o.jsx)(s.j2,{button:(0,o.jsx)(s.zx,{mode:"bleed",text:t("sheet-list.edit-columns")}),id:"columns-control",menu:(0,o.jsx)(l.v2,{padding:3,paddingTop:4,style:{width:240},children:(0,o.jsxs)(l.kC,{direction:"column",height:"fill",gap:3,children:[(0,o.jsx)(l.xv,{weight:"semibold",size:1,children:t("sheet-list.select-fields")}),(0,o.jsx)(l.kC,{style:{flex:"1 1 auto",maxHeight:320,overflowY:"scroll"},children:(0,o.jsx)(l.Kq,{children:e.getAllLeafColumns().filter(e=>e.getCanHide()).map(e=>(0,o.jsxs)(l.kC,{marginY:2,align:"center",children:[(0,o.jsx)(l.XZ,{readOnly:c(e),checked:e.getIsVisible(),onChange:r(e),id:`col-visibility-${e.id}`,style:{display:"block"}}),(0,o.jsx)(l.xu,{flex:1,paddingLeft:3,children:(0,o.jsx)(l.xv,{size:1,children:(0,o.jsx)("label",{htmlFor:`col-visibility-${e.id}`,children:e.columnDef.header?.toString()})})})]},e.id))})}),(0,o.jsx)(s.zx,{width:"fill",mode:"ghost",text:t("sheet-list.reset-columns"),onClick:i})]})}),placement:"bottom",popover:{portal:!0}})}let rA=(0,w.zo)(l.kC)`
  flex-shrink: 0;
`;function rO(){let{state:{filtersVisible:e}}=(0,f.XNc)();return(0,o.jsxs)(rA,{children:[(0,o.jsx)(f.s8v,{}),e&&(0,o.jsx)(f.x$p,{showTypeFilter:!1})]})}let rN=w.zo.th`
  margin: 16px;
  z-index: 1;
  padding: 22px 0px;
  border-top: 1px solid var(--card-border-color);
  background-color: var(--card-badge-default-bg-color);
  box-sizing: border-box;
  text-align: left;
  width: ${({width:e})=>e}px;
  max-width: ${({width:e})=>e}px;
`,rU=(0,w.zo)(rN)`
  position: sticky;
  z-index: 2;
`,rH=w.zo.div`
  visibility: hidden;

  ${rN}:hover & {
    visibility: visible;
  }
`;function rB(e){let{header:t,headerGroup:n}=e,{t:i}=(0,f.$G7)(),r=t.column.getIsPinned(),a=n.depth>0&&!t.column.parent?null:(0,o.jsx)(l.xv,{size:1,weight:"semibold",textOverflow:"ellipsis",children:(0,eT.ie)(t.column.columnDef.header,t.getContext())}),c=t.column.getCanHide()&&(0===n.depth?!t.column.columns.length:t.column.parent),u=r&&t.column.getIsLastColumn("left")?2:1;return(0,o.jsx)(r?rU:rN,{style:{left:t.column.getStart("left")??void 0,borderRight:`${u}px solid var(--card-border-color)`},"data-testid":`header-${t.id}`,width:t.getSize(),children:(0,o.jsxs)(l.kC,{justify:"space-between",marginX:2,align:"baseline",children:[(0,o.jsx)(s.u,{delay:500,content:a,children:(0,o.jsx)(l.xu,{style:{boxSizing:"border-box"},marginLeft:3,marginRight:3,children:a})}),c&&(0,o.jsx)(rH,{children:(0,o.jsx)(s.j2,{button:(0,o.jsx)(s.zx,{tooltipProps:{content:"Open field menu"},mode:"bleed",icon:d.xXb,"data-testid":"field-menu-button"}),id:"field menu",popover:{placement:"bottom-end"},menu:(0,o.jsx)(l.v2,{children:(0,o.jsx)(s.sN,{text:i("sheet-list.hide-field"),icon:d.Two,onClick:()=>t.column.toggleVisibility()})})})})]})},t.id)}function rV({table:e}){return(0,o.jsx)(s.uE,{children:(0,o.jsxs)(l.kC,{gap:3,align:"center",children:[(0,o.jsx)(s.zx,{onClick:()=>e.setPageIndex(0),disabled:!e.getCanPreviousPage(),icon:d.TwJ,tooltipProps:{content:"Go to first page"}}),(0,o.jsx)(s.zx,{onClick:()=>e.previousPage(),disabled:!e.getCanPreviousPage(),icon:d.wyc,tooltipProps:{content:"Go to previous page"}}),(0,o.jsxs)(l.xv,{style:{whiteSpace:"nowrap"},children:[e.getState().pagination.pageIndex+1," of ",e.getPageCount()]}),(0,o.jsx)(s.zx,{onClick:()=>e.nextPage(),disabled:!e.getCanNextPage(),icon:d.XCv,tooltipProps:{content:"Go to next page"}}),(0,o.jsx)(s.zx,{onClick:()=>e.setPageIndex(e.getPageCount()-1),disabled:!e.getCanNextPage(),icon:d.hZl,tooltipProps:{content:"Go to last page"}}),(0,o.jsx)("select",{value:e.getState().pagination.pageSize,onChange:t=>{e.setPageSize(Number(t.target.value))},children:[25,50,100].map(e=>(0,o.jsx)("option",{value:e,children:e},e))})]})})}function rq(e,t){switch(t.type){case"DOCUMENTS_SET":{let n=t.documents.reduce((e,t)=>({...e,[t._id]:t}),{});return{...e,documents:n}}case"DOCUMENT_RECEIVED":{let n=t.payload;return{...e,documents:{...e.documents,[n._id]:n}}}case"DOCUMENT_DELETED":{let{[t.id]:n,...i}=e.documents;return{...e,documents:i}}case"DOCUMENT_UPDATED":{let n=t.payload,i=n._id,r={...e.documents[i],...n};return{...e,documents:{...e.documents,[i]:r}}}default:return e}}let rF={events:["welcome","mutation","reconnect"],includeResult:!0,visibility:"query"},rG=(0,w.zo)(l.kC)`
  height: 100%;
`,rW=w.zo.div`
  overflow: auto; //our scrollable table container
  position: relative; //needed for sticky header
`,rK=w.zo.table`
  border-collapse: separate;
  border-spacing: 0;
  font-family: arial, sans-serif;
  white-space: nowrap;
  width: 100%;
  border: 1px solid lightgray;

  thead {
    display: grid;
    position: sticky;
    top: 0;
    z-index: 10;
  }
  tr {
    padding: 0;
  }
  tr:last-child {
    border-bottom: none;
  }
`;function rX({documentSchemaType:e}){let{dispatch:t,state:n}=(0,f.XNc)(),{columns:i,initialColumnsVisibility:r}=function(e){let t=(0,f.rq_)(),n=(0,a.useMemo)(()=>e?[rM.display({id:"selected",enableHiding:!1,header:e=>(0,o.jsxs)(l.xu,{children:[(0,o.jsx)(l.XZ,{style:{paddingLeft:4},indeterminate:e.table.getIsSomeRowsSelected(),onChange:e.table.getToggleAllPageRowsSelectedHandler()}),e.table.getSelectedRowModel().rows.length," selected"]}),cell:r_}),rM.accessor("Preview",{enableHiding:!1,id:"Preview",cell:n=>(0,o.jsx)(r$,{...n,documentPreviewStore:t,schemaType:e})}),...rR(e)]:[],[t,e]),[i]=(0,a.useMemo)(()=>rL(n).reduce(([e,t],n)=>{if(!n.id)throw Error("Column must have an id");let i=n.id;return n.enableHiding?5===t?[{...e,[i]:!1},t]:[{...e,[i]:!0},t+1]:[{...e,[i]:!0},t]},[{},0]),[n]);return{columns:n,initialColumnsVisibility:i}}(e),{data:s}=function({typeName:e}){let{state:t}=(0,f.XNc)(),n=(0,a.useMemo)(()=>{let e=new Map;return t.result.hits.forEach(t=>e.set((0,f.vsM)(t.hit._id),t.hit)),e},[t.result.hits]),{data:i,isLoading:r}=function({filter:e,params:t,apiVersion:n}){let i=`*[${e}][0...2000]`,r=(0,f.m85)({...f.Dr7,apiVersion:n||f.Dr7.apiVersion}),[s,o]=(0,a.useReducer)(rq,{documents:{}}),[l,c]=(0,a.useState)(null!==r),[d,u]=(0,a.useState)(null),p=(0,a.useCallback)(async()=>{if(!r){c(!1);return}try{let e=await r.fetch(i,t);o({type:"DOCUMENTS_SET",documents:e}),c(!1)}catch(e){u(e)}},[r,t,i]),m=(0,a.useCallback)(async e=>{if("welcome"===e.type&&(c(!0),await p(),c(!1)),"reconnect"===e.type&&c(!0),"mutation"===e.type){if("appear"===e.transition){let t=e.result;t&&o({type:"DOCUMENT_RECEIVED",payload:t})}if("disappear"===e.transition&&o({type:"DOCUMENT_DELETED",id:e.documentId}),"update"===e.transition){let t=e.result;t&&o({type:"DOCUMENT_UPDATED",payload:t})}}},[p]),h=(0,a.useMemo)(()=>r?r.observable.listen(i,t,rF).pipe((0,D.K)(e=>(u(e),(0,S.of)(e)))):(0,S.of)(),[r,t,i]);return(0,a.useEffect)(()=>{let e=h.subscribe(m);return()=>{e?.unsubscribe()}},[m,h]),{data:(0,a.useMemo)(()=>Object.values(Object.keys(s.documents).reduce((e,t)=>{let n=s.documents[t],i=n._id===(0,f.qyu)(n._id),r=i?n._id:(0,f.qyu)(n._id);return e[r]&&!i||(e[r]=n),e},{})),[s.documents]),isLoading:l,error:d}}({filter:`_type == "${e}"`});return{data:(0,a.useMemo)(()=>i.filter(e=>n.has((0,f.vsM)(e._id))),[i,n]),isLoading:r}}({typeName:e.name}),[c,d]=(0,a.useState)(null),u=n.result.hits.length,p=(0,eT.b7)({data:s,columns:i,getCoreRowModel:(0,eS.sC)(),getFilteredRowModel:(0,eS.vL)(),getPaginationRowModel:(0,eS.G_)(),autoResetPageIndex:!1,initialState:{columnPinning:{left:["selected","Preview"]},pagination:{pageSize:25},columnVisibility:r},getRowId:e=>e._id,meta:{selectedAnchor:c,setSelectedAnchor:d,patchDocument:(e,t,n)=>null}}),{rows:m}=p.getRowModel();(0,a.useEffect)(()=>(t({type:"TERMS_TYPE_ADD",schemaType:e}),()=>{t({type:"TERMS_TYPE_REMOVE",schemaType:e})}),[e,t]);let h=(0,a.useCallback)(e=>(0,o.jsx)(l.xu,{as:"tr",paddingY:2,style:{display:"flex",width:"100%"},children:e.getVisibleCells().map(t=>(0,a.createElement)(rz,{...t,key:e.original._id+t.id}))},e.original._id+e.id),[]),x=`Total: ${u} rows, showing ${m.length} rows`;return(0,o.jsxs)(rG,{direction:"column",paddingX:3,"data-testid":"document-sheet-list-pane",children:[(0,o.jsxs)(l.kC,{direction:"row",align:"center",paddingY:3,paddingX:1,justify:"space-between",children:[(0,o.jsxs)(l.kC,{direction:"row",align:"center",children:[(0,o.jsx)(rO,{}),(0,o.jsx)(l.xv,{size:0,muted:!0,children:x})]}),(0,o.jsx)(rP,{table:p})]}),(0,o.jsx)(rW,{children:(0,o.jsx)(rI,{table:p,children:(0,o.jsxs)(rK,{children:[(0,o.jsx)("thead",{children:p.getHeaderGroups().map(e=>(0,o.jsx)(l.xu,{as:"tr",children:e.headers.map(t=>(0,o.jsx)(rB,{header:t,headerGroup:e},t.id))},e.id))}),(0,o.jsx)("tbody",{children:p.getRowModel().rows.map(h)})]})})}),(0,o.jsx)(l.kC,{justify:"flex-end",padding:3,gap:4,paddingY:5,children:(0,o.jsx)(rV,{table:p})})]})}function rY(e){let t=(0,f.I_y)(),n=e.pane.schemaTypeName,i=t.get(n);if(!i||!(0,x.em)(i))throw Error(`Schema type "${n}" not found or not a document schema`);return(0,o.jsx)(f.X$R,{children:(0,o.jsx)(rX,{...e,documentSchemaType:i})})}let rZ=e=>{let{menuItems:t,sortOrderRaw:n,layout:i}=e;return t?.map(e=>e.params?.layout?{...e,selected:i===e.params?.layout}:e?.params?.by?{...e,selected:ey(n?.by,e?.params?.by||f.LZ8)}:{...e,selected:!1})};function rQ(e){let t=(0,a.useRef)(e);return eb(t.current,e)||(t.current=e),t.current}let rJ=(0,a.memo)(function(e){let{index:t,isSelected:n,pane:i,paneKey:r}=e,{name:s}=(0,f.Lky)(),{defaultLayout:l="default",initialValueTemplates:c=f.LZ8,menuItemGroups:d,menuItems:u,options:p}=i,{defaultOrdering:m=f.LZ8,filter:h}=p,x=rQ(p.params||rr),g=i.source,y=(0,a.useMemo)(()=>{let e=rd(h,x);return e?.length===1?e[0]:null},[h,x]),[b,j]=no("layout",y??i.id,l),{title:v}=(0,f.v0Z)(i),w=(0,a.useMemo)(()=>m?.length>0?{by:m}:ri,[m]),[C,_]=no("sort-order",y??i.id,w),k=(0,a.useMemo)(()=>rZ({menuItems:u,sortOrderRaw:C,layout:b}),[b,u,C]),I="sheetList"===b,E=I?(0,a.createElement)(rY,{...e,key:e.pane.id}):(0,o.jsx)(rw,{...e,sortOrder:C,layout:b});return(0,o.jsx)(f.cWh,{name:g||s,children:(0,o.jsxs)(e5,{"data-ui":"DocumentListPane",id:r,minWidth:320,...I?{}:{currentMaxWidth:350,maxWidth:640},selected:n,children:[tX,(0,o.jsx)(rC,{index:t,initialValueTemplates:c,menuItemGroups:d,menuItems:k,setLayout:j,setSortOrder:_,title:v}),E]})})});class r0 extends Error{path;helpId;constructor(e,t,n,i){super(e),this.name="SerializeError";let r=typeof n>"u"?"<unknown>":`${n}`;this.path=(t||[]).concat(i?`${r} (${i})`:r)}withHelpUrl(e){return this.helpId=e,this}}var r1=((r=r1||{}).ID_REQUIRED="structure-node-id-required",r.TITLE_REQUIRED="structure-title-required",r.FILTER_REQUIRED="structure-filter-required",r.INVALID_LIST_ITEM="structure-invalid-list-item",r.COMPONENT_REQUIRED="structure-view-component-required",r.DOCUMENT_ID_REQUIRED="structure-document-id-required",r.DOCUMENT_TYPE_REQUIRED="structure-document-type-required",r.SCHEMA_TYPE_REQUIRED="structure-schema-type-required",r.SCHEMA_TYPE_NOT_FOUND="structure-schema-type-not-found",r.LIST_ITEMS_MUST_BE_ARRAY="structure-list-items-must-be-array",r.QUERY_PROVIDED_FOR_FILTER="structure-query-provided-for-filter",r.ACTION_OR_INTENT_REQUIRED="structure-action-or-intent-required",r.LIST_ITEM_IDS_MUST_BE_UNIQUE="structure-list-item-ids-must-be-unique",r.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE="structure-action-and-intent-mutually-exclusive",r.API_VERSION_REQUIRED_FOR_CUSTOM_FILTER="structure-api-version-required-for-custom-filter",r);let r2={title:"Last edited",i18n:{title:{key:"menu-items.sort-by.last-edited",ns:ez}},name:"lastEditedDesc",by:[{field:"_updatedAt",direction:"desc"}]},r8=[r2,{title:"Created",i18n:{title:{key:"menu-items.sort-by.created",ns:ez}},name:"lastCreatedDesc",by:[{field:"_createdAt",direction:"desc"}]}];function r3(e,t,n){return e instanceof r4?e.serialize({path:n,index:t}):e}class r4{constructor(e,t){this._context=e,this.spec=t||{}}spec;action(e){return this.clone({action:e})}getAction(){return this.spec.action}intent(e){return this.clone({intent:e})}getIntent(){return this.spec.intent}title(e){return this.clone({title:e})}getTitle(){return this.spec.title}i18n(e){return this.clone({i18n:e})}getI18n(){return this.spec.i18n}group(e){return this.clone({group:e})}getGroup(){return this.spec.group}icon(e){return this.clone({icon:e})}getIcon(){return this.spec.icon}params(e){return this.clone({params:e})}getParams(){return this.spec.params}showAsAction(e=!0){return this.clone({showAsAction:!!e})}getShowAsAction(){return this.spec.showAsAction}serialize(e={path:[]}){let{title:t,action:n,intent:i}=this.spec;if(!t){let t="string"==typeof n?`action: "${n}"`:void 0;throw new r0("`title` is required for menu item",e.path,e.index,t).withHelpUrl(r1.TITLE_REQUIRED)}if(!n&&!i)throw new r0(`\`action\` or \`intent\` required for menu item with title ${this.spec.title}`,e.path,e.index,`"${t}"`).withHelpUrl(r1.ACTION_OR_INTENT_REQUIRED);if(i&&n)throw new r0("cannot set both `action` AND `intent`",e.path,e.index,`"${t}"`).withHelpUrl(r1.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE);return{...this.spec,title:t}}clone(e){let t=new r4(this._context);return t.spec={...this.spec,...e||{}},t}}function r5(e,{by:t,title:n,i18n:i},r){let s=new r4(e).group("sorting").title(e.i18n.t("default-menu-item.fallback-title",{ns:"studio",replace:{title:n}})).icon(d.fzI).action("setSortOrder").params({by:t,extendedProjection:r});return i&&(s=s.i18n(i)),s}function r7(e,t){let{schema:n}=e,i="string"==typeof t?n.get(t):t;return i&&"orderings"in i?(i.orderings?i.orderings.concat(r8):r8).map(t=>r5(e,t,rp(i,t.by))):[]}function r9(e,t,n){return e instanceof r6?e.serialize({path:n,index:t}):e}class r6{constructor(e,t){this._context=e,this._id=t?t.id:"",this._title=t?t.title:"",this._i18n=t?t.i18n:void 0}_id;_title;_i18n;id(e){return new r6(this._context,{id:e,title:this._title,i18n:this._i18n})}getId(){return this._id}title(e){return new r6(this._context,{title:e,id:this._id,i18n:this._i18n})}getTitle(){return this._title}i18n(e){return new r6(this._context,{i18n:e,id:this._id,title:this._title})}getI18n(){return this._i18n}serialize(e={path:[]}){let{_id:t,_title:n,_i18n:i}=this;if(!t)throw new r0("`id` is required for a menu item group",e.path,e.index,n).withHelpUrl(r1.ID_REQUIRED);if(!n)throw new r0("`title` is required for a menu item group",e.path,t).withHelpUrl(r1.TITLE_REQUIRED);return{id:t,title:n,i18n:i}}}let se=/([^A-Za-z0-9-_.])/;function st(e,t,n){if("string"!=typeof e)throw new r0(`Structure node id must be of type string, got ${typeof e}`,t,n);let[i]=e.match(se)||[];if(i)throw new r0(`Structure node id cannot contain character "${i}"`,t,n);if(e.startsWith("__edit__"))throw new r0("Structure node id cannot start with __edit__",t,n);return e}function sn(e,t){if(t)return t;let n=u(e);return se.test(n)?u(p(e)):n}class si{spec;constructor(e){this.spec={options:{},...e||{}}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:sn(e,this.spec.id)})}getTitle(){return this.spec.title}i18n(e){return this.clone({i18n:e})}getI18n(){return this.spec.i18n}child(e){return this.clone({child:e})}getChild(){return this.spec.child}component(e){return this.clone({component:e})}getComponent(){return this.spec.component}options(e){return this.clone({options:e})}getOptions(){return this.spec.options||{}}menuItems(e){return this.clone({menuItems:e})}getMenuItems(){return this.spec.menuItems}menuItemGroups(e){return this.clone({menuItemGroups:e})}getMenuItemGroups(){return this.spec.menuItemGroups}canHandleIntent(e){return this.clone({canHandleIntent:e})}serialize(e={path:[]}){let{id:t,title:n,child:i,options:r,component:s}=this.spec;if(!t)throw new r0("`id` is required for `component` structure item",e.path,e.index).withHelpUrl(r1.ID_REQUIRED);if(!s)throw new r0("`component` is required for `component` structure item",e.path,e.index).withHelpUrl(r1.ID_REQUIRED);return{id:st(t,e.path,e.index),title:n,type:"component",child:i,component:s,canHandleIntent:this.spec.canHandleIntent,options:r||{},menuItems:(this.spec.menuItems||[]).map((t,n)=>r3(t,n,e.path)),menuItemGroups:(this.spec.menuItemGroups||[]).map((t,n)=>r9(t,n,e.path))}}clone(e){let t=new si;return t.spec={...this.spec,...e||{}},t}}async function sr(e,t){let n=(0,f.vsM)(t),i=(0,f.qyu)(t);return(await e(f.Dr7).fetch("*[_id in [$documentId, $draftId]]._type",{documentId:n,draftId:i},{tag:"structure.resolve-type"}))[0]}class ss{spec={};id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:this.spec.id||y(e)})}getTitle(){return this.spec.title}icon(e){return this.clone({icon:e})}getIcon(){return this.spec.icon}serialize(e={path:[]}){let{id:t,title:n,icon:i}=this.spec;if(!t)throw new r0("`id` is required for view item",e.path,e.index).withHelpUrl(r1.ID_REQUIRED);if(!n)throw new r0("`title` is required for view item",e.path,e.index).withHelpUrl(r1.TITLE_REQUIRED);return{id:st(t,e.path,e.index),title:n,icon:i}}}function so(e,t,n){return"function"==typeof e.serialize?e.serialize({path:n,index:t}):e}let sl=e=>(0,f.Uy$)(e)&&"component"===e.type;class sa extends ss{spec;constructor(e){let t=sl(e)?{...e}:{options:{}};super(),this.spec=t;let n="function"==typeof e?e:this.spec.component;n&&(this.spec=this.component(n).spec)}component(e){return this.clone({component:e})}getComponent(){return this.spec.component}options(e){return this.clone({options:e})}getOptions(){return this.spec.options||{}}serialize(e={path:[]}){let t=super.serialize(e),n=this.spec.component;if("function"!=typeof n)throw new r0("`component` is required and must be a function for `component()` view item",e.path,e.index).withHelpUrl(r1.COMPONENT_REQUIRED);return{...t,component:n,options:this.spec.options||{},type:"component"}}clone(e){let t=new sa;return t.spec={...this.spec,...e||{}},t}}class sc extends ss{spec;constructor(e){super(),this.spec={id:"editor",title:"Editor",...e||{}}}serialize(e={path:[]}){return{...super.serialize(e),type:"form"}}clone(e){let t=new sc;return t.spec={...this.spec,...e||{}},t}}let sd=e=>new sc(e),su=e=>new sa(e);var sp=Object.freeze({__proto__:null,ComponentViewBuilder:sa,FormViewBuilder:sc,GenericViewBuilder:ss,component:su,form:sd,maybeSerializeView:so});let sm=({resolveDocumentNode:e,getClient:t})=>async(n,{params:i,path:r})=>{let s=i.type,o=r.slice(0,r.length-1),l=r[r.length-1];if(s||(s=await sr(t,n)),!s)throw new r0("Failed to resolve document, and no type provided in parameters.",o,l);return e({documentId:n,schemaType:s})};class sh{constructor(e,t){this._context=e,this.spec=t||{}}spec;id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:sn(e,this.spec.id)})}getTitle(){return this.spec.title}i18n(e){return this.clone({i18n:e})}getI18n(){return this.spec.i18n}child(e){return this.clone({child:e})}getChild(){return this.spec.child}documentId(e){let t=this.spec.id||e;return this.clone({id:t,options:{...this.spec.options||{},id:e}})}getDocumentId(){return this.spec.options?.id}schemaType(e){return this.clone({options:{...this.spec.options||{},type:"string"==typeof e?e:e.name}})}getSchemaType(){return this.spec.options?.type}initialValueTemplate(e,t){return this.clone({options:{...this.spec.options||{},template:e,templateParameters:t}})}getInitialValueTemplate(){return this.spec.options?.template}getInitialValueTemplateParameters(){return this.spec.options?.templateParameters}views(e){return this.clone({views:e})}getViews(){return this.spec.views||[]}serialize({path:e=[],index:t,hint:n}={path:[]}){let i=e[t||e.length-1],r=this.spec.id||i&&`${i}`||"",s={id:r,type:void 0,template:void 0,templateParameters:void 0,...this.spec.options};if("string"!=typeof r||!r)throw new r0("`id` is required for document nodes",e,t,n).withHelpUrl(r1.ID_REQUIRED);if(!s||!s.id)throw new r0("document id (`id`) is required for document nodes",e,r,n).withHelpUrl(r1.DOCUMENT_ID_REQUIRED);if(!s||!s.type)throw new r0("document type (`schemaType`) is required for document nodes",e,r,n);let o=(this.spec.views&&this.spec.views.length>0?this.spec.views:[sd()]).map((t,n)=>so(t,n,e)),l=o.map(e=>e.id),a=g(l.filter((e,t)=>l.includes(e,t+1)));if(a.length>0)throw new r0(`document node has views with duplicate IDs: ${a.join(",  ")}`,e,r,n);return{...this.spec,child:this.spec.child||sm(this._context),id:st(r,e,t),type:"document",options:function(e){let t={id:e.id||"",type:e.type||"*"};return e.template&&(t.template=e.template),e.templateParameters&&(t.templateParameters=e.templateParameters),t}(s),views:o}}clone(e={}){let t=new sh(this._context),n={...this.spec.options||{},...e.options||{}};return t.spec={...this.spec,...e,options:n},t}}function sf(e,t){let n=t?.type?e.resolveDocumentNode({schemaType:t.type}):new sh(e);if(!t)return n;let{id:i,type:r,template:s,templateParameters:o}=t.options;return n=n.id(t.id).documentId(i),r&&(n=n.schemaType(r)),s&&(n=n.initialValueTemplate(s,o)),t.child&&(n=n.child(t.child)),n}function sx({resolveDocumentNode:e,templates:t},n,i){let r=t.find(e=>e.id===n);if(!r)throw Error(`Template with ID "${n}" not defined`);return e({schemaType:r.schemaType}).initialValueTemplate(n,i)}class sg{constructor(e,t){this._context=e,this.spec=t||{}}spec;id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e})}getTitle(){return this.spec.title}description(e){return this.clone({description:e})}getDescription(){return this.spec.description}templateId(e){let t=this.spec.id||e;return this.clone({id:t,templateId:e})}getTemplateId(){return this.spec.templateId}parameters(e){return this.clone({parameters:e})}getParameters(){return this.spec.parameters}serialize({path:e=[],index:t,hint:n}={path:[]}){let{spec:i,_context:r}=this,{templates:s}=r;if("string"!=typeof i.id||!i.id)throw new r0("`id` is required for initial value template item nodes",e,t,n).withHelpUrl(r1.ID_REQUIRED);if(!i.templateId)throw new r0("template id (`templateId`) is required for initial value template item nodes",e,i.id,n).withHelpUrl(r1.ID_REQUIRED);let o=s.find(e=>e.id===i.templateId);if(!o)throw new r0("template id (`templateId`) is required for initial value template item nodes",e,i.id,n).withHelpUrl(r1.ID_REQUIRED);return{id:i.id,templateId:i.id,schemaType:o.schemaType,type:"initialValueTemplateItem",description:i.description||o.description,title:i.title||o.title,subtitle:i.subtitle,icon:i.icon||o.icon,initialDocumentId:i.initialDocumentId,parameters:i.parameters}}clone(e={}){let t=new sg(this._context);return t.spec={...this.spec,...e},t}}function sy(e){let{schema:t,getStructureBuilder:n,templates:i}=e,r=t.getTypeNames();return i.filter(e=>!e.parameters?.length).sort((e,t)=>r.indexOf(e.schemaType)-r.indexOf(t.schemaType)).map(e=>n().initialValueTemplateItem(e.id))}function sb(e,t,n){return e instanceof sg?e.serialize({path:n,index:t}):e}function sj(e,t){let{schema:n,templates:i}=e;return t.map(t=>{let r=i.find(e=>e.id===t.templateId),s=t.title||r?.title||"Create",o={};r&&r.schemaType&&(o.type=r.schemaType),t.templateId&&(o.template=t.templateId);let l=t.parameters?[o,t.parameters]:o,a=r&&n.get(r.schemaType),c=t.i18n||r?.i18n,u=new r4(e).title(s).icon(r&&r.icon||a?.icon||d.dtP).intent({type:"create",params:l});return c&&(u=u.i18n(c)),u.serialize()})}let sv=Symbol("Document type list canHandleIntent"),sw=(e,t,{pane:n})=>{let i="create"===e,r=n.options?.filter||"",s=n.options?.params||{},o=n.schemaTypeName?[n.schemaTypeName]:sz(r,s),l=n.initialValueTemplates||[];return i&&t.template?l.some(e=>e.templateId===t.template):"edit"===e&&t.id&&o.includes(t.type)||i&&o.includes(t.type)};sw.identity=sv;let sC=["default","card","media","detail","block"];function s_(){}let sk=(e,t,{pane:n,index:i})=>i<=1&&sw(e,t,{pane:n,index:i});class sI{initialValueTemplatesSpecified=!1;spec={};id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:sn(e,this.spec.id)})}getTitle(){return this.spec.title}i18n(e){return this.clone({i18n:e})}getI18n(){return this.spec.i18n}defaultLayout(e){return this.clone({defaultLayout:e})}getDefaultLayout(){return this.spec.defaultLayout}menuItems(e){return this.clone({menuItems:e})}getMenuItems(){return this.spec.menuItems}menuItemGroups(e){return this.clone({menuItemGroups:e})}getMenuItemGroups(){return this.spec.menuItemGroups}child(e){return this.clone({child:e})}getChild(){return this.spec.child}canHandleIntent(e){return this.clone({canHandleIntent:e})}getCanHandleIntent(){return this.spec.canHandleIntent}showIcons(e=!0){return this.clone({displayOptions:{...this.spec.displayOptions||{},showIcons:e}})}getShowIcons(){return this.spec.displayOptions?this.spec.displayOptions.showIcons:void 0}initialValueTemplates(e){return this.initialValueTemplatesSpecified=!0,this.clone({initialValueTemplates:Array.isArray(e)?e:[e]})}getInitialValueTemplates(){return this.spec.initialValueTemplates}serialize(e={path:[]}){let t=this.spec.id||"",n=e.path,i=this.spec.defaultLayout;if(i&&!sC.includes(i))throw new r0(`\`layout\` must be one of ${sC.map(e=>`"${e}"`).join(", ")}`,n,t||e.index,this.spec.title);let r=(this.spec.initialValueTemplates||[]).map((e,t)=>sb(e,t,n));return{id:st(t,e.path,t||e.index),title:this.spec.title,i18n:this.spec.i18n,type:"genericList",defaultLayout:i,child:this.spec.child||s_,canHandleIntent:this.spec.canHandleIntent||sk,displayOptions:this.spec.displayOptions,initialValueTemplates:r,menuItems:(this.spec.menuItems||[]).map((e,t)=>r3(e,t,n)),menuItemGroups:(this.spec.menuItemGroups||[]).map((e,t)=>r9(e,t,n))}}}let sE=(e,t)=>{let n=e.options?.filter.trim()||"";if(["*","{"].includes(n[0]))throw new r0(`\`filter\` cannot start with \`${n[0]}\` - looks like you are providing a query, not a filter`,t.path,e.id,e.title).withHelpUrl(r1.QUERY_PROVIDED_FOR_FILTER);return n},sT=e=>(t,n)=>{let i=n.parent,r=n.params?.template?e.templates.find(e=>e.id===n.params.template):void 0;return Promise.resolve(r?r.schemaType:i.schemaTypeName||sr(e.getClient,t)).then(n=>n?e.resolveDocumentNode({schemaType:n,documentId:t}):new sh(e).id("editor").documentId(t).schemaType(""))};class sS extends sI{constructor(e,t){super(),this._context=e,this.spec=t||{},this.initialValueTemplatesSpecified=!!t?.initialValueTemplates}spec;apiVersion(e){return this.clone({options:{...this.spec.options||{filter:""},apiVersion:e}})}getApiVersion(){return this.spec.options?.apiVersion}filter(e){return this.clone({options:{...this.spec.options||{},filter:e}})}getFilter(){return this.spec.options?.filter}schemaType(e){let t="string"==typeof e?e:e.name;return this.clone({schemaTypeName:t})}getSchemaType(){return this.spec.schemaTypeName}params(e){return this.clone({options:{...this.spec.options||{filter:""},params:e}})}getParams(){return this.spec.options?.params}defaultOrdering(e){if(!Array.isArray(e))throw Error("`defaultOrdering` must be an array of order clauses");return this.clone({options:{...this.spec.options||{filter:""},defaultOrdering:e}})}getDefaultOrdering(){return this.spec.options?.defaultOrdering}serialize(e={path:[]}){if("string"!=typeof this.spec.id||!this.spec.id)throw new r0("`id` is required for document lists",e.path,e.index,this.spec.title).withHelpUrl(r1.ID_REQUIRED);if(!this.spec.options||!this.spec.options.filter)throw new r0("`filter` is required for document lists",e.path,this.spec.id,this.spec.title).withHelpUrl(r1.FILTER_REQUIRED);return this.spec.options?.filter!=="_type == $type"&&this.spec.options.filter&&!this.spec.options.apiVersion&&console.warn(`No apiVersion specified for document type list with custom filter: \`${this.spec.options.filter}\`. This will be required in the future. See %s for more info.`,(0,s.h0)(r1.API_VERSION_REQUIRED_FOR_CUSTOM_FILTER)),{...super.serialize(e),type:"documentList",schemaTypeName:this.spec.schemaTypeName,child:this.spec.child||sT(this._context),options:{...this.spec.options,apiVersion:this.spec.options.apiVersion||f.Dr7.apiVersion,filter:sE(this.spec,e)}}}clone(e){let t=new sS(this._context);return t.spec={...this.spec,...e||{}},this.initialValueTemplatesSpecified||(t.spec.initialValueTemplates=function(e,t){let{document:n}=e,{schemaTypeName:i,options:r}=t,{filter:s,params:o}=r||{filter:"",params:{}},l=i?[i]:Array.from(new Set(sz(s,o)));if(0!==l.length)return l.flatMap(e=>n.resolveNewDocumentOptions({type:"structure",schemaType:e})).map(e=>({...e,icon:d.dtP}))}(this._context,t.spec)),t.spec.schemaTypeName||(t.spec.schemaTypeName=function(e){let{options:t}=e,{filter:n,params:i}=t||{filter:"",params:{}},r=sz(n,i);return 1===r.length?r[0]:void 0}(t.spec)),t}getSpec(){return this.spec}}function sz(e,t={}){let n=function(e,t={}){let n;let i=/\b_type\s*==\s*(['"].*?['"]|\$.*?(?:\s|$))|\B(['"].*?['"]|\$.*?(?:\s|$))\s*==\s*_type/g,r=[];for(;null!==(n=i.exec(e));)r.push(n[1]||n[2]);return r.map(e=>(("$"===e[0]?t[e.slice(1)]:e)||"").trim().replace(/^["']|["']$/g,"")).filter(Boolean)}(e,t);return 0===n.length&&(n=function(e,t={}){let n=e.match(/\b_type\s+in\s+\[(.*?)\]/);return n?n[1].split(/,\s*/).map(e=>e.trim().replace(/^["']+|["']+$/g,"")).map(e=>"$"===e[0]?t[e.slice(1)]:e).filter(Boolean):[]}(e,t)),n}let s$=e=>e instanceof sL?"ListBuilder":(0,f.Uy$)(e)&&"function"==typeof e.then?"Promise":Array.isArray(e)?"array":typeof e,sM=e=>"listItem"===e.type,sD=(e,t,n)=>(n.pane.items||[]).filter(sN).some(e=>e.schemaType.name===t.type&&e._id===t.id)||sk(e,t,n),sR=(e,t)=>{let n=(t.parent.items.filter(sM).find(t=>t.id===e)||{child:void 0}).child;return n&&"function"==typeof n&&"function"==typeof n?n(e,t):n};class sL extends sI{constructor(e,t){super(),this._context=e,this.spec=t||{},this.initialValueTemplatesSpecified=!!(t&&t.initialValueTemplates)}spec;items(e){return this.clone({items:e})}getItems(){return this.spec.items}serialize(e={path:[]}){let t=this.spec.id;if("string"!=typeof t||!t)throw new r0("`id` is required for lists",e.path,e.index).withHelpUrl(r1.ID_REQUIRED);let n=typeof this.spec.items>"u"?[]:this.spec.items;if(!Array.isArray(n))throw new r0("`items` must be an array of items",e.path,e.index).withHelpUrl(r1.LIST_ITEMS_MUST_BE_ARRAY);let i=(e.path||[]).concat(t),r=n.map((e,t)=>(function(e,t,n){if(e instanceof sP)return e.serialize({path:n,index:t});if(e&&"divider"===e.type)return e;if(!e||"listItem"!==e.type){let i=e&&e.type||s$(e);throw new r0(`List items must be of type "listItem", got "${i}"${"array"===i?" - did you forget to spread (...moreItems)?":""}`,n,t).withHelpUrl(r1.INVALID_LIST_ITEM)}return e})(e,t,i)),s=r.filter((e,t)=>b(r,{id:e.id},t+1));if(s.length>0){let t=s.map(e=>e.id).slice(0,5),n=s.length>5?`${t.join(", ")}...`:t.join(", ");throw new r0(`List items with same ID found (${n})`,e.path,e.index).withHelpUrl(r1.LIST_ITEM_IDS_MUST_BE_UNIQUE)}return{...super.serialize(e),type:"list",canHandleIntent:this.spec.canHandleIntent||sD,child:this.spec.child||sR,items:r}}clone(e){let t=new sL(this._context);return t.spec={...this.spec,...e||{}},t}}class sP{constructor(e,t){this._context=e,this.spec=t||{}}spec;id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:sn(e,this.spec.id)})}getTitle(){return this.spec.title}i18n(e){return this.clone({i18n:e})}getI18n(){return this.spec.i18n}icon(e){return this.clone({icon:e})}showIcon(e=!0){return this.clone({displayOptions:{...this.spec.displayOptions||{},showIcon:e}})}getShowIcon(){return this.spec.displayOptions?this.spec.displayOptions.showIcon:void 0}getIcon(){return this.spec.icon}child(e){return this.clone({child:e})}getChild(){return this.spec.child}schemaType(e){return this.clone({schemaType:e})}getSchemaType(){let e=this.spec.schemaType;return"string"==typeof e?this._context.schema.get(e):this.spec.schemaType}serialize(e={path:[]}){let{id:t,title:n,child:i}=this.spec;if("string"!=typeof t||!t)throw new r0("`id` is required for list items",e.path,e.index).withHelpUrl(r1.ID_REQUIRED);if(!e.titleIsOptional&&("string"!=typeof n||!n))throw new r0("`title` is required for list items",e.path,t).withHelpUrl(r1.TITLE_REQUIRED);let r=this.spec.schemaType;if("string"==typeof r){let n=this._context.schema.get(r);if(!n)throw new r0(`Could not find type "${r}" in schema`,e.path,t).withHelpUrl(r1.SCHEMA_TYPE_NOT_FOUND);r=n}let s={path:e.path.concat(t),hint:"child"},o=i instanceof si||i instanceof sS||i instanceof sh||i instanceof sL?i.serialize(s):i;if("function"==typeof o){let e=o;o=(t,n)=>e(t,{...n,serializeOptions:s})}return{...this.spec,id:st(t,e.path,e.index),schemaType:r,child:o,title:n,type:"listItem"}}clone(e){let t=new sP(this._context);return t.spec={...this.spec,...e||{}},t}}let sA=(e,t)=>n=>{let i=t.schemaType&&("string"==typeof t.schemaType?t.schemaType:t.schemaType.name);return i?e.resolveDocumentNode({schemaType:i,documentId:n}):new sh(e).id("documentEditor").documentId(n)};class sO extends sP{constructor(e,t){super(e,t),this._context=e,this.spec=t||{}}spec;serialize(e={path:[]}){let t=super.serialize({...e,titleIsOptional:!0});if(!t.schemaType)throw new r0("`schemaType` is required for document list items",e.path,e.index).withHelpUrl(r1.SCHEMA_TYPE_REQUIRED);let n=t.child||sA(this._context,t);return{...t,child:n,schemaType:t.schemaType,_id:t.id}}clone(e){let t=new sO(this._context);return t.spec={...this.spec,...e||{}},t}}function sN(e){return(0,f.Uy$)(e)&&"u">typeof e.schemaType&&"string"==typeof e._id}class sU extends sS{constructor(e,t){super(e),this._context=e,this.spec=t||{}}spec;child(e){return this.cloneWithoutDefaultIntentHandler({child:e})}clone(e){let t=super.clone(e),n=new sU(this._context);return n.spec={...this.spec,...t.getSpec(),...e||{}},n}cloneWithoutDefaultIntentHandler(e){let t=super.clone(e),n=new sU(this._context),i=this.spec.canHandleIntent,r=i&&i.identity===sv?{canHandleIntent:void 0}:{};return n.spec={...t.getSpec(),...this.spec,...e||{},...r},n}}let sH=["sanity.imageAsset","sanity.fileAsset"];function sB(e){return(function({schema:e}){return e.getTypeNames().filter(t=>{let n=e.get(t);return n&&n.type?.name==="document"}).filter(e=>!sH.includes(e))})(e).map(t=>sV(e,t))}function sV(e,t){let{schema:n}=e,i=n.get(t);if(!i)throw Error(`Schema type with name "${t}" not found`);let r=i.title||j(t);return new sP(e).id(t).title(r).schemaType(i).child((n,i)=>{let r=i.parent,s="list"===r.type?r.items.find(e=>e.id===n):null,o=sq(e,t);return s&&s.title&&(o=o.title(s.title)),o})}function sq(e,t){let{schema:n,resolveDocumentNode:i}=e,r="string"==typeof t?t:t.schemaType,s="string"==typeof r?r:r.name,o="string"==typeof t?{schemaType:r}:t,l=n.get(s);if(!l)throw Error(`Schema type with name "${s}" not found`);let a=l.title||j(s);return new sU(e).id(o.id||s).title(o.title||a).filter("_type == $type").params({type:s}).schemaType(l).defaultOrdering(r2.by).menuItemGroups(o.menuItemGroups||[{id:"sorting",title:"Sort",i18n:{title:{key:"menu-item-groups.actions-group",ns:ez}}},{id:"layout",title:"Layout",i18n:{title:{key:"menu-item-groups.layout-group",ns:ez}}},{id:"actions",title:"Actions",i18n:{title:{key:"menu-item-groups.sorting-group",ns:ez}}}]).child(o.child||(e=>i({schemaType:s,documentId:e}))).canHandleIntent(o.canHandleIntent||sw).menuItems(o.menuItems||[...r7(e,l),new r4(e).group("layout").i18n({title:{key:"menu-items.layout.compact-view",ns:ez}}).title("Compact view").icon(d.reJ).action("setLayout").params({layout:"default"}),new r4(e).group("layout").i18n({title:{key:"menu-items.layout.detailed-view",ns:ez}}).title("Detailed view").icon(d.cMY).action("setLayout").params({layout:"detail"})])}function sF({defaultDocumentNode:e,source:t}){let n=(0,f.nqf)(t),i={...t,getStructureBuilder:()=>r,resolveDocumentNode:t=>{let s=e?.(r,{...t,...n})||new sh(i);return s.getId()||(s=s.id("documentEditor")),t.documentId&&(s=s.documentId((0,f.vsM)(t.documentId))),s.schemaType(t.schemaType)}},r={defaults:()=>(function(e){let t=sB(e);return new sL(e).id("__root__").title("Content").i18n({title:{key:"default-definition.content-title",ns:ez}}).items(t).showIcons(t.some(e=>{var t;return!!(t=e.getSchemaType())&&"string"!=typeof t&&!!t.icon}))})(i),documentTypeList:(...e)=>sq(i,...e),documentTypeListItem:(...e)=>sV(i,...e),documentTypeListItems:(...e)=>sB(i,...e),document:(...e)=>new sh(i,...e),documentWithInitialValueTemplate:(...e)=>sx(i,...e),defaultDocument:i.resolveDocumentNode,list:(...e)=>new sL(i,...e),listItem:(...e)=>new sP(i,...e),menuItem:(...e)=>new r4(i,...e),menuItemGroup:(...e)=>new r6(i,...e),menuItemsFromInitialValueTemplateItems:(...e)=>sj(i,...e),documentList:(...e)=>new sS(i,...e),documentListItem:(...e)=>new sO(i,...e),orderingMenuItem:(...e)=>r5(i,...e),orderingMenuItemsForType:(...e)=>r7(i,...e),editor:(...e)=>sf(i,...e),defaultInitialValueTemplateItems:(...e)=>sy(i,...e),initialValueTemplateItem:(e,t)=>new sg(i,{id:e,parameters:t,templateId:e}),component:e=>(0,h.isValidElementType)(e)?new si().component(e):new si(e),divider:()=>({id:m("__divider__"),type:"divider"}),view:sp,context:i};return r}let sG=e=>{let{liveEdit:t}=e;return t?{label:"Live",color:"danger"}:null};sG.displayName="LiveEditBadge";let sW={activePanes:[]};function sK(e){sW.activePanes=e}function sX(e,t,n,i){let r=n?.panes||[],s=sW.activePanes||[],o=t.id||(0,v.Z)(),l="create"===e&&t.template;for(let n=s.length-1;n>=0;n--){let a=s[n];if("object"==typeof a&&(a.canHandleIntent?.(e,t,{pane:a,index:n})||"documentList"===a.type&&a.schemaTypeName===t.type&&"_type == $type"===a.options.filter)){let e=l?{template:t.template}:tY;return{panes:r.slice(0,n).concat([[{id:o,params:e,payload:i}]])}}}return{intent:e,params:t,payload:i}}let sY=(0,w.zo)(f.l$t)`
  height: 100%;
  overflow: auto;
  position: relative;
  scroll-behavior: smooth;
`;function sZ({error:e,diff:t,documentContext:n,loading:i,schemaType:r}){return e?(0,o.jsx)(f.kwM,{}):i?(0,o.jsx)(f.Bwn,{showText:!0}):t?(0,o.jsx)(c.H7.Provider,{value:n,children:(0,o.jsx)(f.EyJ,{diff:t,schemaType:r})}):(0,o.jsx)(f.kwM,{})}let sQ={error:d.uIy,warning:d.foC,info:d.hQ6},sJ={error:"critical",warning:"caution",info:"primary"};function s0(e){let{marker:t,onOpen:n,schemaType:i,value:r}=e,c=(0,a.useCallback)(()=>n(t.path),[t,n]),[d,u]=(0,a.useState)(null);return(0,o.jsxs)(s.SV,{onCatch:u,children:[d&&(0,o.jsx)(l.Zb,{padding:3,radius:2,tone:"critical",children:(0,o.jsx)(l.xv,{size:1,children:d.error.message})}),!d&&(0,o.jsx)(l.Zb,{__unstable_focusRing:!0,as:"button",onClick:c,padding:3,radius:2,tone:sJ[t.level],children:(0,o.jsxs)(l.kC,{align:"flex-start",gap:3,children:[(0,o.jsx)(l.xu,{flex:"none",children:(0,o.jsx)(l.xv,{size:1,children:(0,a.createElement)(sQ[t.level])})}),(0,o.jsxs)(l.Kq,{flex:1,space:2,children:[(0,o.jsx)(s1,{path:t.path,schemaType:i,value:r}),(0,o.jsx)(l.xv,{muted:!0,size:1,children:t.message})]})]})})]})}function s1(e){let{path:t,schemaType:n,value:i}=e,r=(0,a.useMemo)(()=>{try{return function(e){let{path:t,schemaType:n,value:i}=e,r=[],s=n,o=i;for(let e of t){if("string"==typeof e){if(!(0,f.Uy$)(o)&&void 0!==o)throw Error(`Parent value is not an object, cannot get path segment: .${e}`);if("object"!==s.jsonType)throw Error(`Parent type is not an object schema type, cannot get path segment: .${e}`);o=o?.[e];let t=s.fields.find(t=>t.name===e);if(!t)return r.push({name:e}),r;s=t.type,r.push(s);continue}if("number"==typeof e){if(!(0,f.kJL)(o)&&void 0!==o)throw Error(`Parent value is not an array, cannot get path segment: [${e}]`);if("array"!==s.jsonType)throw Error(`Parent type is not an array schema type, cannot get path segment: [${e}]`);o=o?.[e];let t=s.of.find(e=>"string"==typeof o?"string"===e.jsonType:"number"==typeof o?"number"===e.jsonType:"boolean"==typeof o?"boolean"===e.jsonType:!!(0,f.Uy$)(o)&&e.name===o?._type);if(!t)throw Error(`Item type not found: [${e}]`);s=t,r.push(s);continue}if((0,f.Uy$)(e)&&e._key){if(!(0,f.kJL)(o))throw Error(`Parent value is not an array, cannot get path segment: [_key == ${e}]`);if("array"!==s.jsonType)throw Error(`Parent type is not an array schema type, cannot get path segment: .${e}`);if(o=(o??[]).find(t=>(0,f.Uy$)(t)&&t._key===e._key),!(0,f.Uy$)(o))throw Error(`Array item not found: [_key == ${e._key}]`);let t=s.of.find(e=>(0,f.Uy$)(o)&&e.name===o?._type);if(!t)throw Error(`Array item type not found: .${o?._type}`);s=t,r.push(s);continue}throw Error(`Invalid path segment: ${JSON.stringify(e)}`)}return r}({path:t,schemaType:n,value:i})}catch(e){console.error(e)}return null},[t,n,i]);return r?.length?(0,o.jsx)(l.xv,{size:1,children:r.map((e,t)=>(0,o.jsxs)(a.Fragment,{children:[t>0&&(0,o.jsx)("span",{style:{color:"var(--card-muted-fg-color)",opacity:.5},children:" / "}),(0,o.jsx)("span",{style:{fontWeight:500},children:e.title||e.name})]},t))}):null}let s2={},s8=_.BC.create("/",[_.BC.intents("/intent"),_.BC.create("/edit/:type/:editDocumentId",[_.BC.create({path:"/:params",transform:{params:{toState:function(e){try{return JSON.parse(decodeURIComponent(e))}catch{return console.warn("Failed to parse JSON parameters"),{}}},toPath:function(e){return JSON.stringify(e)}}}})]),_.BC.create({path:"/:panes",children:[_.BC.create("/:action",_.BC.create("/:legacyEditDocumentId"))],transform:{panes:{toState:function(e){var t;return -1!==(t=decodeURIComponent(e)).indexOf(",{")?function(e){let t=[],n=e;for(;n.length;){let[e,i,r]=n.match(s3)||[];if(!e){n=n.slice(1);continue}let s=r&&function(e){try{return JSON.parse(e)}catch(e){console.warn(`Failed to parse parameters: ${e.message}`);return}}(r);t.push({id:i,payload:s}),n=n.slice(e.length)}return[t]}(t):t.split(";").map(e=>{let[t,...n]=e.split("|").map(e=>{let[t,...n]=e.split(",");return function(e,t){let n={...t,params:s2,payload:void 0};return e.reduce((e,t)=>{if(s4(t)){let n=t.slice(0,t.indexOf("=")),i=t.slice(n.length+1);e.params={...e.params,[decodeURIComponent(n)]:decodeURIComponent(i)}}else s5(t)?e.payload=function(e){try{return e?(0,_.ZB)(e):void 0}catch(e){console.warn(`Failed to parse parameters: ${e.message}`);return}}(t):console.warn("Unknown pane segment: %s - skipping",t);return e},n)}(n,{id:t})});return[t,...n.map(e=>({...t,...e,id:e.id||t.id,params:{...C(t.params,s7),...e.params},payload:e.payload||t.payload}))]}).filter(e=>e.length>0)},toPath:function(e){return(e||[]).map(e=>e.map(s6).join("|")).map(encodeURIComponent).join(";")}}}})]),s3=/^([.a-z0-9_-]+),?({.*?})?(?:(;|$))/i,s4=e=>/^[a-z0-9]+=[^=]+/i.test(e),s5=e=>/^[A-Za-z0-9\-_]+(?:={0,2})$/.test(e),s7=["view","since","rev","inspect","comment"],s9=Boolean;function s6(e,t,n){let{payload:i,params:r={},id:s}=e,[o]=n,l=e===o,a=0!==t&&s===o.id,c=typeof i>"u"?void 0:(0,_.B8)(i),d=Object.entries(r).filter(e=>{let[t,n]=e;return!!n&&(!!l||!(n===o.params?.[t]&&!s7.includes(t)))}).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`);return[a?"":s].concat([d.length>0&&d,c].filter(s9).flat()).join(",")||","}let oe=[ie,ii,n8,n4,n1,n5],ot=[sG],on=[{name:"sanity/structure/validation",component:function(e){let{onClose:t}=e,{onFocus:n,onPathOpen:i,schemaType:r,validation:s,value:c}=tG(),{t:d}=(0,f.$G7)("validation"),u=(0,a.useCallback)(e=>{i(e),n(e)},[n,i]);return(0,o.jsxs)(l.kC,{direction:"column",height:"fill",overflow:"hidden",children:[(0,o.jsx)(ne,{as:"header",closeButtonLabel:d("panel.close-button-aria-label"),flex:"none",onClose:t,title:d("panel.title")}),(0,o.jsxs)(l.Zb,{flex:1,overflow:"auto",padding:3,children:[0===s.length&&(0,o.jsx)(l.xu,{padding:2,children:(0,o.jsx)(l.xv,{muted:!0,size:1,children:d("panel.no-errors-message")})}),s.length>0&&(0,o.jsx)(l.Kq,{space:2,children:s.map((e,t)=>(0,o.jsx)(s0,{marker:e,onOpen:u,schemaType:r,value:c},t))})]})]})},useMenuItem:function(e){let{documentId:t,documentType:n}=e,{t:i}=(0,f.$G7)("validation"),{validation:r}=(0,f.a3k)(t,n),s=(0,a.useMemo)(()=>r.map(e=>({level:e.level,message:e.message,path:e.path})),[r]),o=s.some(x.z1),l=s.some(x.AY),c=(0,a.useMemo)(()=>o?d.uIy:l?d.foC:d.nSX,[o,l]),u=(0,a.useMemo)(()=>o?"critical":l?"caution":"positive",[o,l]);return{hidden:0===s.length,icon:c,title:i("panel.title"),tone:u,showAsAction:!0}}},{name:t8,useMenuItem:()=>{let{features:e}=tJ(),{t}=(0,f.$G7)();return{hidden:!e.reviewChanges,icon:d.vaD,title:t("changes.title")}},component:function(e){let{onClose:t}=e,{documentId:n,schemaType:i,timelineError:r,timelineStore:s,value:c}=tG(),d=(0,a.useRef)(null),u=(0,f.P08)(s,e=>e.diff),p=(0,f.P08)(s,e=>e.onOlderRevision),m=(0,f.P08)(s,e=>e.selectionState),h=(0,f.P08)(s,e=>e.sinceTime),x=!p,{t:g}=(0,f.$G7)("studio"),y=(0,a.useMemo)(()=>({documentId:n,schemaType:i,FieldWrapper:f.MUX,rootDiff:u,isComparingCurrent:x,value:c,showFromValue:!0}),[n,u,x,i,c]),b=(0,a.useMemo)(()=>u?function(e){let t=new Map;return(0,f.Z7x)(e,e=>{if("unchanged"===e.action||!("annotation"in e)||!e.annotation)return!0;let{author:n,timestamp:i}=e.annotation,r=t.get(n);return(!r||r.timestamp<i)&&t.set(n,e.annotation),!0}),Array.from(t.values()).sort((e,t)=>e.timestamp<t.timestamp?1:-1)}(u):[],[u]);return(0,o.jsxs)(l.kC,{"data-testid":"review-changes-pane",direction:"column",height:"fill",overflow:"hidden",children:[(0,o.jsx)(ne,{as:"header",closeButtonLabel:g("changes.action.close-label"),flex:"none",onClose:t,title:g("changes.title"),children:(0,o.jsxs)(l.kC,{gap:1,padding:3,paddingTop:0,paddingBottom:2,children:[(0,o.jsx)(l.xu,{flex:1,children:(0,o.jsx)(i_,{mode:"since",chunk:h,placement:"bottom-start"})}),(0,o.jsx)(l.xu,{flex:"none",children:(0,o.jsx)(f.IIC,{annotations:b,description:g("changes.changes-by-author"),portal:!0,children:(0,o.jsx)(l.Jh,{maxLength:4,"aria-label":g("changes.changes-by-author"),children:b.map(({author:e})=>(0,o.jsx)(f.YtX,{user:e},e))})})})]})}),(0,o.jsx)(l.Zb,{flex:1,children:(0,o.jsx)(l.NM,{element:d.current,children:(0,o.jsx)(sY,{"data-ui":"Scroller",ref:d,children:(0,o.jsx)(l.xu,{flex:1,padding:4,children:(0,o.jsx)(sZ,{diff:u,documentContext:y,error:r,loading:"loading"===m,schemaType:i})})})})})]})},onClose:({params:e})=>({params:{...e,since:void 0}}),onOpen:({params:e})=>({params:{...e,since:"@lastPublished"}})}],oi=(0,f.Cw0)(e=>{let t=e?.icon||d.kLv;return{name:"sanity/structure",document:{actions:e=>Array.from(new Set([...e,...oe])),badges:e=>Array.from(new Set([...e,...ot])),inspectors:e=>Array.from(new Set([...e,...on]))},tools:[{name:e?.name||"structure",title:e?.title||"Structure",icon:t,component:(0,a.lazy)(()=>n.e(8831).then(n.bind(n,98831))),canHandleIntent:(e,t)=>{var n;return"create"===e?"type"in t&&(!("template"in t)||{template:!0}):"edit"===e&&"id"in(n=t)&&(!("mode"in n)||{mode:"structure"===n.mode})},getIntentState:sX,controlsDocumentTitle:!0,options:e,router:s8}],i18n:{bundles:[e$]}}});function or({defaultDocumentNode:e,structure:t,children:n}){let[i,r]=(0,a.useState)(!1),s=(0,f.Lky)(),l=(0,f.Q3k)(s),d=(0,f.H__)(),u=(0,a.useMemo)(()=>sF({defaultDocumentNode:e,source:s}),[e,s]),p=(0,a.useMemo)(()=>t?t(u,{...l,documentStore:d}):u.defaults(),[u,t,l,d]),m=(0,a.useMemo)(()=>({backButton:i,resizablePanes:!i,reviewChanges:!i,splitPanes:!i,splitViews:!i}),[i]),h=(0,a.useMemo)(()=>({features:m,layoutCollapsed:i,setLayoutCollapsed:r,rootPaneNode:p,structureContext:u.context}),[m,i,p,u.context]);return(0,o.jsx)(c.r1.Provider,{value:h,children:n})}var os=Object.freeze({__proto__:null,default:rt}),oo=Object.freeze({__proto__:null,default:rJ})}}]);